(self.webpackChunk=self.webpackChunk||[]).push([[858],{40822:function(D,T,o){"use strict";o.r(T),o.d(T,{default:function(){return Tt}});var K=o(21140),S=o.n(K),G=o(63466),I=o.n(G),V=o(58853),O=o.n(V),F=o(38888),R=o.n(F),j=o(93236),J=o(57213),N=o.n(J),H=o(93525),Q=o.n(H),$=o(68608),y=o.n($),q=o(52510),p=o.n(q),W=o(79530),_=o(46291),E=o(62841),z=o(79458),U=o(67230),tt=o(1682),et=o(16196),it=o(92931),at=o(22312),st=o(17712),n=o(62086),rt=it.Z.Dragger,nt=function(s){O()(h,s);var t=R()(h);function h(){var r;S()(this,h);for(var i=arguments.length,e=new Array(i),a=0;a<i;a++)e[a]=arguments[a];return r=t.call.apply(t,[this].concat(e)),p()(y()(r),"state",{show:!1,promise:null,title:"",accept:""}),r}return I()(h,[{key:"onCancel",value:function(){this.setState({show:!1})}},{key:"onUpload",value:function(i){var e=this.state.promise;e.resolve(i),this.setState({show:!1})}},{key:"upload",value:function(i,e){var a=this;return new Promise(function(l,d){a.setState({show:!0,promise:{resolve:l,reject:d},title:i,accept:e})})}},{key:"render",value:function(){var i=this;return(0,n.jsx)("div",{children:(0,n.jsxs)(W.Z,{title:this.state.title,open:this.state.show,onCancel:function(){return i.onCancel()},footer:null,destroyOnClose:!0,children:[(0,n.jsx)(at.Z,{}),(0,n.jsxs)(rt,{showUploadList:!1,beforeUpload:function(a){return i.onUpload(a)},accept:this.state.accept,children:[(0,n.jsx)("p",{className:"ant-upload-drag-icon",children:(0,n.jsx)(st.Z,{})}),(0,n.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})]})})}}]),h}(j.Component),lt=nt,A=o(22139),ht=o(71819),ot=o(18048),ct=o(83823),dt=o(80681),C=o(138),M=document.createElement("a"),v={yellow:"rgb(255, 238, 70)",green:"rgb(168, 255, 45)",orange:"rgb(255, 163, 8)",purple:"rgb(240, 41, 246)",pink:"rgb(255, 100, 142)",cyan:"rgb(69, 255, 242)",white:"#fff",black:"#000",blue:"rgb(47, 168, 223)",red:"rgb(255, 69, 70)"};function ut(s,t){var h=JSON.stringify(s);M.href="data:,".concat(h),M.download=t,M.click()}function ft(s){var t=null;return window.createObjcectURL!==void 0?t=window.createOjcectURL(s):window.URL!==void 0?t=window.URL.createObjectURL(s):window.webkitURL!==void 0&&(t=window.webkitURL.createObjectURL(s)),t}var vt=C.fabric.util.createClass(C.fabric.Rect,{type:"UiRect",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(t){t||(t={}),t.color||(t.color="main"),this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.groupName,this.ratio=t.ratio,this._color=t.color,this.team=t.team,t.lockRotation=!0,t.lockScalingFlip=!0,t.hasRotatingPoint=!1,t.width||(t.width=50/this.ratio),t.height||(t.height=50/this.ratio),t.left||(t.left=50/this.ratio),t.top||(t.top=50/this.ratio),t.strokeWidth||(t.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?t.stroke=v[this._color]:(t.stroke=v[t.team],this._color="main"),t.fill=null,this.callSuper("initialize",t),this.moveTo(t.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){this.set("width",Math.round(this.width*this.scaleX*this.ratio)/this.ratio),this.set("height",Math.round(this.height*this.scaleY*this.ratio)/this.ratio),this.set("left",Math.round(this.left*this.ratio)/this.ratio),this.set("top",Math.round(this.top*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,width:this.width*this.ratio,height:this.height*this.ratio,x:this.left*this.ratio,y:this.top*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(t){this._color=t.color,this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.group,this.set("width",t.width/this.ratio),this.set("height",t.height/this.ratio),this.set("left",t.x/this.ratio),this.set("top",t.y/this.ratio),this.set("strokeWidth",t.lineWidth/this.ratio),this._color==="main"?this.set("stroke",v[this.team]):this.set("stroke",v[this._color]),this.moveTo(t.layer)},setRatio:function(t){this.set("width",this.width*this.ratio/t),this.set("height",this.height*this.ratio/t),this.set("left",this.left*this.ratio/t),this.set("top",this.top*this.ratio/t),this.set("strokeWidth",this.strokeWidth*this.ratio/t),this.ratio=t},setTeam:function(t){this.team=t,this._color==="main"&&this.set("stroke",v[this.team])}}),gt=C.fabric.util.createClass(C.fabric.Line,{type:"UiLine",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(t){t||(t={}),t.color||(t.color="main"),this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.groupName,this.ratio=t.ratio,this._color=t.color,this.team=t.team,t.lockRotation=!0,t.lockScalingFlip=!0,t.hasRotatingPoint=!1,t.x1||(t.x1=50/this.ratio),t.y1||(t.y1=50/this.ratio),t.x2||(t.x2=100/this.ratio),t.y2||(t.y2=100/this.ratio),t.strokeWidth||(t.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?t.stroke=v[this._color]:(t.stroke=v[t.team],this._color="main"),t.fill=null,this.callSuper("initialize",[t.x1,t.y1,t.x2,t.y2],t),this.moveTo(t.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){var t=this.left,h=this.top,r=Math.round((this.x2-this.x1)*this.scaleX),i=Math.round((this.y2-this.y1)*this.scaleY);this.set("x1",Math.round(t*this.ratio)/this.ratio),this.set("y1",Math.round(h*this.ratio)/this.ratio),this.set("x2",Math.round((t+r)*this.ratio)/this.ratio),this.set("y2",Math.round((h+i)*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,x:this.x1*this.ratio,y:this.y1*this.ratio,x2:this.x2*this.ratio,y2:this.y2*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(t){this._color=t.color,this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.group,this.set("x2",t.x2/this.ratio),this.set("y2",t.y2/this.ratio),this.set("x1",t.x/this.ratio),this.set("y1",t.y/this.ratio),this.set("strokeWidth",t.lineWidth/this.ratio),this._color==="main"?this.set("stroke",v[this.team]):this.set("stroke",v[this._color]),this.moveTo(t.layer)},setRatio:function(t){this.set("x1",this.x1*this.ratio/t),this.set("y1",this.y1*this.ratio/t),this.set("x2",this.x2*this.ratio/t),this.set("y2",this.y2*this.ratio/t),this.set("strokeWidth",this.strokeWidth*this.ratio/t),this.ratio=t},setTeam:function(t){this.team=t,this._color==="main"&&this.set("stroke",v[this.team])}}),L=C.fabric.util.createClass(C.fabric.Ellipse,{type:"UiEllipse",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(t){t||(t={}),t.color||(t.color="main"),this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.groupName,this.ratio=t.ratio,this._color=t.color,this.team=t.team,t.lockRotation=!0,t.lockScalingFlip=!0,t.hasRotatingPoint=!1,t.rx||(t.rx=50/this.ratio),t.ry||(t.ry=50/this.ratio),t.left||(t.left=50/this.ratio),t.top||(t.top=50/this.ratio),t.strokeWidth||(t.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?t.stroke=v[this._color]:(t.stroke=v[t.team],this._color="main"),t.fill=null,this.callSuper("initialize",t),this.moveTo(t.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){this.set("rx",Math.round(this.rx*this.scaleX*this.ratio)/this.ratio),this.set("ry",Math.round(this.ry*this.scaleY*this.ratio)/this.ratio),this.set("left",Math.round(this.left*this.ratio)/this.ratio),this.set("top",Math.round(this.top*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,rx:this.rx*this.ratio,ry:this.ry*this.ratio,x:this.left*this.ratio,y:this.top*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(t){this._color=t.color,this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.group,this.set("rx",t.rx/this.ratio),this.set("ry",t.ry/this.ratio),this.set("left",t.x/this.ratio),this.set("top",t.y/this.ratio),this.set("strokeWidth",t.lineWidth/this.ratio),this._color==="main"?this.set("stroke",v[this.team]):this.set("stroke",v[this._color]),this.moveTo(t.layer)},setRatio:function(t){this.set("rx",this.rx*this.ratio/t),this.set("ry",this.ry*this.ratio/t),this.set("left",this.left*this.ratio/t),this.set("top",this.top*this.ratio/t),this.set("strokeWidth",this.strokeWidth*this.ratio/t),this.ratio=t},setTeam:function(t){this.team=t,this._color==="main"&&this.set("stroke",v[this.team])}}),mt=C.fabric.util.createClass(L,{type:"UiRound",r:50,initialize:function(t){t||(t={}),t.r||(t.r=50/this.ratio),t.rx=t.r,t.ry=t.r,this.callSuper("initialize",t),this.setControlVisible("ml",!1),this.setControlVisible("mb",!1),this.setControlVisible("mr",!1),this.setControlVisible("mt",!1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,r:this.rx*this.ratio,x:this.left*this.ratio,y:this.top*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(t){t.rx=t.r,t.ry=t.r,this.callSuper("fromObject",t)}}),P={Rect:vt,Line:gt,Round:mt,Ellipse:L};function yt(s){var t={id:s.id,name:s.name,layer:s.layer,groupName:s.group,ratio:s.ratio,team:s.team};return new P[s.type.slice(2)](t)}function pt(){for(var s=[],t=0,h=Object.keys(P);t<h.length;t++){var r=h[t];s.push({key:"D1-add-".concat(r),label:r})}return s}var xt=o(419),kt=function(s){O()(h,s);var t=R()(h);function h(){var r;S()(this,h);for(var i=arguments.length,e=new Array(i),a=0;a<i;a++)e[a]=arguments[a];return r=t.call.apply(t,[this].concat(e)),p()(y()(r),"state",{show:!1}),p()(y()(r),"data",{}),r}return I()(h,[{key:"gen",value:function(i){this.data=i,this.setState({show:!0})}},{key:"onClose",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var i=this;return(0,n.jsx)("div",{children:(0,n.jsxs)(xt.Z,{title:"C Code Generator",placement:"right",onClose:function(){return i.onClose()},open:this.state.show,size:"large",children:[(0,n.jsx)("h1",{children:"Not yet completed"}),(0,n.jsx)("p",{children:JSON.stringify(this.data)})]})})}}]),h}(j.Component),bt=kt;function Z(s){return s===-1?[]:s===-2?["uiWindow"]:["E-".concat(s)]}function Y(s){return s[0]==="E"?s.slice(2):s==="window"?-2:-1}var jt=function(s){O()(h,s);var t=R()(h);function h(){var r;S()(this,h);for(var i=arguments.length,e=new Array(i),a=0;a<i;a++)e[a]=arguments[a];return r=t.call.apply(t,[this].concat(e)),p()(y()(r),"state",{treeData:[],rightClickMenuOpen:!1,groupKey:"layer"}),p()(y()(r),"generatorRef",(0,j.createRef)()),r}return I()(h,[{key:"onElementMenuContainerClick",value:function(i){i.target.localName==="div"&&(this.setState({rightClickMenuOpen:!1}),this.props.onSelect(-1))}},{key:"onElementMenuClick",value:function(i){if(this.setState({rightClickMenuOpen:!1}),i.key==="D2-copy"){var e=N()({},this.props.data[this.props.selectedId]);e.id=-1,this.props.onObjectEvent("_update",e)}else i.key==="D2-delete"&&this.props.onObjectEvent("remove",{id:this.props.selectedId})}},{key:"onElementRightClick",value:function(i){this.props.onSelect(Y(i.node.key))}},{key:"onSelect",value:function(i){i.length!==0&&this.props.onSelect(Y(i[0]))}},{key:"onMenuOpenChange",value:function(i){if(i){var e=this;setTimeout(function(){e.props.selectedId!==-1?e.setState({rightClickMenuOpen:!0}):e.setState({rightClickMenuOpen:!1})},100)}else this.setState({rightClickMenuOpen:!1})}},{key:"elementsMenuOnClick",value:function(i){var e=this,a=i.keyPath[i.keyPath.length-1];if(a==="D1-add"){var l=i.key.slice(7),d={id:-1,name:"New".concat(l),layer:0,group:"Ungroup",type:"Ui".concat(l)};this.props.onObjectEvent("_add",d)}else a==="D1-group"?this.setState({groupKey:i.key.slice(9)},function(){return e.updateTree()}):a==="D1-reset"?this.props.onReset():a==="D1-save"?ut(this.data,"ui.rmui"):a==="D1-open"?this.uploadRef.current.upload("Upload Your .rmui File",".rmui").then(function(c){var u=new FileReader;u.onload=function(k){var b=k.target.result,f=JSON.parse(b);e.reset();for(var g=0,m=Object.keys(f);g<m.length;g++){var w=m[g];e.props.onObjectEvent("_update",f[w])}},u.readAsText(c)}):a==="D1-generate"&&this.generatorRef.current.gen(this.data)}},{key:"updateTree",value:function(){for(var i=this.state.groupKey,e=[],a=Object.keys(this.props.data),l=0;l<a.length;l++){for(var d=this.props.data[a[l]],c=-1,u=0;u<e.length;u++)if(e[u].key==="".concat(i,"-").concat(d[i])){c=u;break}c===-1&&(e.push({title:"".concat(i," ").concat(d[i]),key:"".concat(i,"-").concat(d[i]),children:[],isLeaf:!1}),c=e.length-1),e[c].children.push({title:d.name,key:"E-".concat(a[l])})}return e=e.sort(function(k,b){return k.key.toString().localeCompare(b.key.toString())}),e.unshift({title:"UI Window",key:"window"}),e}},{key:"render",value:function(){var i=this,e=0,a=[{key:"D1-group",label:"Group by",children:[{key:"D1-group-layer",label:"layer"},{key:"D1-group-group",label:"group"}]},{key:"D1-reset",label:"Reset Designer"}];this.props.editable&&(a.unshift({key:"D1-add",label:"Add Element",children:pt()}),a.push({type:"divider"},{key:"D1-open",label:"Open .rmui"},{key:"D1-save",label:"Save as .rmui"},{type:"divider"},{key:"D1-generate",label:"Generate Code",icon:(0,n.jsx)(ot.Z,{})}),e++);for(var l=0;l<a[e].children.length;l++)a[e].children[l].label===this.state.groupKey&&(a[e].children[l].icon=(0,n.jsx)(ct.Z,{}));return console.log(Z(this.props.selectedId)),console.log(this.props.selectedId),(0,n.jsxs)(z.Z,{size:"small",title:"Elements",style:{height:"100%"},extra:(0,n.jsx)(A.Z,{menu:{items:a,onClick:function(c){return i.elementsMenuOnClick(c)}},children:(0,n.jsx)(dt.Z,{})}),children:[(0,n.jsx)("div",{className:"card-body",onMouseUp:function(c){return i.onElementMenuContainerClick(c)},children:(0,n.jsx)(A.Z,{menu:{items:[{key:"D2-copy",label:"Copy"},{key:"D2-delete",label:"Delete",danger:!0}],onClick:function(c){i.onElementMenuClick(c)}},trigger:["contextMenu"],open:this.state.rightClickMenuOpen,onOpenChange:function(c){i.onMenuOpenChange(c)},children:(0,n.jsx)(ht.Z,{className:"full",treeData:this.updateTree(),onSelect:function(c){return i.onSelect(c)},selectedKeys:Z(this.props.selectedId),onRightClick:function(c){return i.onElementRightClick(c)},defaultExpandParent:!0})})}),(0,n.jsx)(bt,{ref:this.generatorRef})]})}}]),h}(j.Component),Ct=jt,wt=function(s){O()(h,s);var t=R()(h);function h(){return S()(this,h),t.apply(this,arguments)}return I()(h,[{key:"render",value:function(){return this.props.color==="Main"?(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{border:"1px solid #aaa",height:16,width:16,borderRadius:"20%",display:"inline-flex"},children:[(0,n.jsx)("div",{style:{backgroundColor:"red",height:12,width:6,margin:"1px 0 1px 1px",borderTopLeftRadius:"20%",borderBottomLeftRadius:"20%",display:"inline-flex"}}),(0,n.jsx)("div",{style:{backgroundColor:"blue",height:12,width:6,margin:"1px 1px 1px 0",borderTopRightRadius:"20%",borderBottomRightRadius:"20%",display:"inline-flex"}})]}),"\xA0 Main"]}):(0,n.jsx)("div",{children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{border:"1px solid #aaa",height:16,width:16,borderRadius:"20%",display:"inline-flex"},children:(0,n.jsx)("div",{style:{backgroundColor:v[this.props.color.toLowerCase()],height:12,width:12,margin:1,borderRadius:"20%",display:"inline-flex"}})}),"\xA0 ",this.props.color]})})}}]),h}(j.Component),x=wt,B={id:{title:"Id",key:"id",dataIndex:"id",valueType:"digit",editable:!1},name:{title:"Name",key:"name",dataIndex:"name"},group:{title:"Group",key:"group",dataIndex:"group"},kind:{title:"Kind",key:"kind",dataIndex:"kind",editable:!1},lineWidth:{title:"Line Width",key:"lineWidth",dataIndex:"lineWidth",valueType:"digit"},layer:{title:"Layer",key:"layer",dataIndex:"layer",valueType:"digit"},x:{title:"X",key:"x",dataIndex:"x",valueType:"digit"},y:{title:"Y",key:"y",dataIndex:"y",valueType:"digit"},x2:{title:"X2",key:"x2",dataIndex:"x2",valueType:"digit"},y2:{title:"Y2",key:"y2",dataIndex:"y2",valueType:"digit"},width:{title:"Width",key:"width",dataIndex:"width",valueType:"digit"},height:{title:"Height",key:"height",dataIndex:"height",valueType:"digit"},rx:{title:"Rx",key:"rx",dataIndex:"rx",valueType:"digit"},ry:{title:"Ry",key:"ry",dataIndex:"ry",valueType:"digit"},r:{title:"R",key:"r",dataIndex:"r",valueType:"digit"},startAngle:{title:"Start Angle",key:"startAngle",dataIndex:"startAngle",valueType:"digit"},endAngle:{title:"End Angle",key:"endAngle",dataIndex:"endAngle",valueType:"digit"},fontSize:{title:"Font Size",key:"fontSize",dataIndex:"fontSize",valueType:"digit"},decimalPlaces:{title:"Decimal Places",key:"decimalPlaces",dataIndex:"decimalPlaces",valueType:"digit"},number:{title:"Number",key:"number",dataIndex:"number",valueType:"digit"},text:{title:"Text",key:"text",dataIndex:"text"},color:{title:"Color",key:"color",dataIndex:"color",valueType:"select",valueEnum:{main:(0,n.jsx)(x,{color:"Main"}),yellow:(0,n.jsx)(x,{color:"Yellow"}),green:(0,n.jsx)(x,{color:"Green"}),orange:(0,n.jsx)(x,{color:"Orange"}),purple:(0,n.jsx)(x,{color:"Purple"}),pink:(0,n.jsx)(x,{color:"Pink"}),cyan:(0,n.jsx)(x,{color:"Cyan"}),black:(0,n.jsx)(x,{color:"Black"}),white:(0,n.jsx)(x,{color:"White"})}},team:{title:"Team",key:"team",dataIndex:"team",valueType:"select",valueEnum:{red:(0,n.jsx)(x,{color:"Red"}),blue:(0,n.jsx)(x,{color:"Blue"})}},backgroundImage:{title:"Background Image",key:"backgroundImage",dataIndex:"backgroundImage",valueType:"switch"}};function St(s){for(var t=Object.keys(s),h=[],r=0;r<t.length;r++)B[t[r]]&&h.push(B[t[r]]);return h}var It=function(s){O()(h,s);var t=R()(h);function h(){var r;S()(this,h);for(var i=arguments.length,e=new Array(i),a=0;a<i;a++)e[a]=arguments[a];return r=t.call.apply(t,[this].concat(e)),p()(y()(r),"objects",{}),p()(y()(r),"state",{properties:null,selectedId:-1,uiWindow:{height:1080,width:1920,ratio:1,team:"red",backgroundImage:!0},infoModalShow:!1,data:{}}),p()(y()(r),"canvas",null),p()(y()(r),"canvasRef",(0,j.createRef)()),p()(y()(r),"uploadRef",(0,j.createRef)()),p()(y()(r),"background",null),r}return I()(h,[{key:"getNewDataId",value:function(){return Object.keys(this.state.data).length===0?0:Math.max.apply(Math,Q()(Object.keys(this.state.data)))+1}},{key:"select",value:function(i){typeof i=="undefined"||i===-1||i===-2?(this.setState({properties:null,selectedId:-1}),this.canvas.discardActiveObject(),this.canvas.renderAll()):(this.setState({properties:this.state.data[i],selectedId:i}),this.canvas.setActiveObject(this.objects[i]),this.canvas.renderAll())}},{key:"reset",value:function(){this.canvas.clear(),this.canvas.backgroundColor="#fff",this.state.uiWindow.backgroundImage&&this.canvas.setBackgroundImage(this.background),this.objects={},this.select(-1),this.resetCanvasSize(),this.setState({data:{}}),localStorage.setItem("data","{}")}},{key:"resetCanvasSize",value:function(){var i,e=this.canvasRef.current.clientWidth-12,a=this.canvasRef.current.clientHeight,l=N()({},this.state.uiWindow);e/a<l.width/l.height?(a=e*l.height/l.width,l.ratio=l.width/e):(e=a*l.width/l.height,l.ratio=l.height/a),this.setState({uiWindow:l}),this.canvas.setHeight(a),this.canvas.setWidth(e);for(var d=0,c=Object.keys(this.objects);d<c.length;d++){var u=c[d];this.objects[u].setRatio(l.ratio)}(i=this.background)===null||i===void 0||i.set({scaleX:1/l.ratio,scaleY:1/l.ratio}),this.canvas.renderAll(),this.objectsToData(),this.setState({infoModalShow:!1})}},{key:"onReSize",value:function(){var i=this;this.state.infoModalShow||(this.canvas.setHeight(10),this.canvas.setWidth(10),this.canvas.renderAll(),this.setState({infoModalShow:!0},function(){W.Z.info({title:"Reset UI Window Size",content:"Must reset UI window size after resize browser window.",onOk:function(){return i.resetCanvasSize()},okText:"Reset"})}))}},{key:"onPropertiesChange",value:function(i,e){var a=this;if(this.state.selectedKey[0]==="window"){if(e.team!==this.state.uiWindow.team){for(var l=0,d=Object.keys(this.objects);l<d.length;l++){var c=d[l];this.objects[c].setTeam(e.team)}this.canvas.renderAll(),this.objectsToData()}if(this.setState({uiWindow:e,properties:e},function(){a.resetCanvasSize()}),e.backgroundImage!==this.state.uiWindow.backgroundImage)if(e.backgroundImage){var u,k=this.state.uiWindow.ratio;(u=this.background)===null||u===void 0||u.set({scaleX:1/k,scaleY:1/k}),this.canvas.setBackgroundImage(this.background),this.canvas.renderAll()}else this.canvas.setBackgroundImage(null),this.canvas.renderAll();(e.width!==this.state.uiWindow.width||e.height!==this.state.uiWindow.height)&&W.Z.warning({title:"Warning",content:"Modify UI window width and height may cause unknown error."})}else this.state.selectedId!==-1&&(this.objects[this.state.selectedId].fromObject(e),this.canvas.renderAll(),this.objectsToData())}},{key:"componentDidMount",value:function(){var i=this,e=this;this.canvas=new C.fabric.Canvas("ui"),C.fabric.Image.fromURL(o(56133),function(f,g){var m;e.background=f;var w=e.state.uiWindow.ratio;(m=e.background)===null||m===void 0||m.set({scaleX:1/w,scaleY:1/w}),e.state.uiWindow.backgroundImage&&(e.canvas.setBackgroundImage(e.background),e.canvas.renderAll())}),this.canvas.backgroundColor="#fff",window.addEventListener("resize",function(){i.onReSize()},!1),window.addEventListener("copy",function(f){f.preventDefault();var g=null;f.target.localName==="input"?g=f.target.ariaValueNow:e.state.selectedId!==-1&&(g=JSON.stringify(e.data[e.state.selectedId])),f.clipboardData.setData("text",g)}),window.addEventListener("paste",function(f){if(f.preventDefault(),f.target.localName==="input")f.target.value=f.clipboardData.getData("text");else try{var g=f.clipboardData.getData("text"),m=JSON.parse(g);m.id=e.getNewDataId(),e.onObjectEvent("_update",m),e.select(m.id)}catch(w){}}),window.addEventListener("keyup",function(f){f.key==="Delete"&&e.state.selectedId!==-1&&e.onObjectEvent("remove",{id:i.state.selectedId})}),this.canvas.on({"mouse:up":function(){for(var g=0,m=Object.keys(e.objects);g<m.length;g++){var w=m[g];e.objects[w].resizeScale()}e.canvas.renderAll(),e.objectsToData();var X=e.canvas.getActiveObject();X?e.select(X.id):e.select(-1)}}),this.canvas.selection=!1;var a=localStorage.getItem("data");if(a){a=JSON.parse(a);for(var l=0,d=Object.keys(a);l<d.length;l++){var c=d[l];this.onObjectEvent("_update",a[c])}}if(this.resetCanvasSize(),this.canvas.renderAll(),a){for(var u=0,k=Object.keys(a);u<k.length;u++){var b=k[u];this.select(b)}this.select(-1)}}},{key:"objectsToData",value:function(){for(var i={},e=0,a=Object.keys(this.objects);e<a.length;e++){var l=a[e],d=this.objects[l].toObject();i[d.id]=d}this.state.selectedId!==-1&&this.setState({properties:i[this.state.selectedId]}),this.setState({data:i}),Object.keys(i).length!==0&&localStorage.setItem("data",JSON.stringify(i))}},{key:"onObjectEvent",value:function(i,e){var a=this;function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,k={id:c.id,name:c.name,layer:c.layer,groupName:c.group,type:c.type,ratio:a.state.uiWindow.ratio,team:a.state.uiWindow.team},b=yt(k);a.objects[c.id]=b,u&&b.fromObject(c),b.setRatio(a.state.uiWindow.ratio),a.canvas.add(b)}if(i==="add")(!e.id||this.objects[e.id])&&(e.id=this.getNewDataId(),l(e));else if(i==="_add")e.id=this.getNewDataId(),e.ratio=this.state.uiWindow.ratio,e.team=this.state.uiWindow.team,l(e,!1);else if(i==="update")this.objects[e.id]&&this.objects[e.id].fromObject(e);else if(i==="_update")e.id>=0&&this.objects[e.id]?this.objects[e.id].fromObject(e):l(e);else if(i==="remove"){var d=e.id;this.objects[d]&&(this.select(-1),this.canvas.remove(this.objects[d]),this.canvas.renderAll(),delete this.objects[d],this.objectsToData())}this.objectsToData()}},{key:"render",value:function(){var i=this;return(0,n.jsxs)("div",{className:"full",children:[(0,n.jsxs)(_.Z,{warp:!1,className:"container",gutter:12,children:[(0,n.jsxs)(E.Z,{flex:"300px",children:[(0,n.jsx)("div",{style:{height:"50%",paddingBottom:12},children:(0,n.jsx)(Ct,{onSelect:function(a){return i.select(a)},onObjectEvent:function(a,l){return i.onObjectEvent(a,l)},onReset:function(){return i.reset()},data:this.state.data,editable:this.props.editable,selectedId:this.state.selectedId})}),(0,n.jsx)(z.Z,{size:"small",title:"Properties",style:{height:"50%"},children:(0,n.jsxs)("div",{className:"card-body",children:[this.state.properties?(0,n.jsx)(et.vY,{dataSource:this.state.properties,columns:St(this.state.properties),editable:this.props.editable?{onSave:function(a,l){return i.onPropertiesChange(a,l)}}:null,column:1,style:{marginTop:4}}):(0,n.jsx)(U.Z,{image:U.Z.PRESENTED_IMAGE_SIMPLE}),this.state.selectedId[0]===-2?(0,n.jsx)(tt.ZP,{onClick:function(){return i.uploadRef.current.upload("Upload Your Background Image","image/*").then(function(a){i.setState({imageUploadShow:!1}),i.background.setSrc(ft(a),function(){i.canvas.renderAll()})})},children:"Upload Background"}):(0,n.jsx)("div",{})]})})]}),(0,n.jsx)(E.Z,{flex:"auto",ref:this.canvasRef,children:(0,n.jsx)("canvas",{className:"full",id:"ui"})})]}),(0,n.jsx)(lt,{ref:this.uploadRef})]})}}]),h}(j.Component),Ot=It,Rt=function(s){O()(h,s);var t=R()(h);function h(){return S()(this,h),t.apply(this,arguments)}return I()(h,[{key:"render",value:function(){return(0,n.jsx)("div",{className:"container",children:(0,n.jsx)(Ot,{className:"full",editable:!0})})}}]),h}(j.Component),Tt=Rt},56133:function(D,T,o){"use strict";D.exports=o.p+"static/background.d741a18b.png"},41001:function(){},35287:function(){},7396:function(){}}]);
