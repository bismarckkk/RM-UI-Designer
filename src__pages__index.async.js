(self.webpackChunk=self.webpackChunk||[]).push([[858],{9553:function(N,M,h){"use strict";h.r(M),h.d(M,{default:function(){return kt}});var B=h(21140),S=h.n(B),G=h(63466),I=h.n(G),J=h(58853),O=h.n(J),V=h(38888),T=h.n(V),j=h(93236),H=h(57213),D=h.n(H),Q=h(93525),$=h.n(Q),q=h(68608),v=h.n(q),_=h(52510),y=h.n(_),tt=h(71323),R=h(32491),et=h(62851),U=h(88021),z=h(98557),A=h(75506),it=h(63450),E=h(81771),at=h(26283),L=h(22341),st=h(18048),rt=h(83823),lt=h(80681),P=h(17712),ht=h(84859),nt=h(38523),a=h(62086),ot=function(l){O()(o,l);var t=T()(o);function o(){var s;S()(this,o);for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return s=t.call.apply(t,[this].concat(i)),y()(v()(s),"state",{show:!1}),y()(v()(s),"data",{}),s}return I()(o,[{key:"gen",value:function(e){this.data=e,this.setState({show:!0})}},{key:"onClose",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var e=this;return(0,a.jsx)("div",{children:(0,a.jsxs)(nt.Z,{title:"C Code Generator",placement:"right",onClose:function(){return e.onClose()},open:this.state.show,size:"large",children:[(0,a.jsx)("h1",{children:"Not yet completed"}),(0,a.jsx)("p",{children:JSON.stringify(this.data)})]})})}}]),o}(j.Component),dt=ot,x=h(138),W=document.createElement("a"),f={yellow:"rgb(255, 238, 70)",green:"rgb(168, 255, 45)",orange:"rgb(255, 163, 8)",purple:"rgb(240, 41, 246)",pink:"rgb(255, 100, 142)",cyan:"rgb(69, 255, 242)",white:"#fff",black:"#000",blue:"rgb(47, 168, 223)",red:"rgb(255, 69, 70)"};function ct(l,t){var o=JSON.stringify(l);W.href="data:,".concat(o),W.download=t,W.click()}function ut(l){var t=null;return window.createObjcectURL!==void 0?t=window.createOjcectURL(l):window.URL!==void 0?t=window.URL.createObjectURL(l):window.webkitURL!==void 0&&(t=window.webkitURL.createObjectURL(l)),t}var ft=function(l){O()(o,l);var t=T()(o);function o(){return S()(this,o),t.apply(this,arguments)}return I()(o,[{key:"render",value:function(){return this.props.color==="Main"?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{style:{border:"1px solid #aaa",height:16,width:16,borderRadius:"20%",display:"inline-flex"},children:[(0,a.jsx)("div",{style:{backgroundColor:"red",height:12,width:6,margin:"1px 0 1px 1px",borderTopLeftRadius:"20%",borderBottomLeftRadius:"20%",display:"inline-flex"}}),(0,a.jsx)("div",{style:{backgroundColor:"blue",height:12,width:6,margin:"1px 1px 1px 0",borderTopRightRadius:"20%",borderBottomRightRadius:"20%",display:"inline-flex"}})]}),"\xA0 Main"]}):(0,a.jsx)("div",{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{border:"1px solid #aaa",height:16,width:16,borderRadius:"20%",display:"inline-flex"},children:(0,a.jsx)("div",{style:{backgroundColor:f[this.props.color.toLowerCase()],height:12,width:12,margin:1,borderRadius:"20%",display:"inline-flex"}})}),"\xA0 ",this.props.color]})})}}]),o}(j.Component),m=ft,Z={id:{title:"Id",key:"id",dataIndex:"id",valueType:"digit",editable:!1},name:{title:"Name",key:"name",dataIndex:"name"},group:{title:"Group",key:"group",dataIndex:"group"},kind:{title:"Kind",key:"kind",dataIndex:"kind",editable:!1},lineWidth:{title:"Line Width",key:"lineWidth",dataIndex:"lineWidth",valueType:"digit"},layer:{title:"Layer",key:"layer",dataIndex:"layer",valueType:"digit"},x:{title:"X",key:"x",dataIndex:"x",valueType:"digit"},y:{title:"Y",key:"y",dataIndex:"y",valueType:"digit"},x2:{title:"X2",key:"x2",dataIndex:"x2",valueType:"digit"},y2:{title:"Y2",key:"y2",dataIndex:"y2",valueType:"digit"},width:{title:"Width",key:"width",dataIndex:"width",valueType:"digit"},height:{title:"Height",key:"height",dataIndex:"height",valueType:"digit"},rx:{title:"Rx",key:"rx",dataIndex:"rx",valueType:"digit"},ry:{title:"Ry",key:"ry",dataIndex:"ry",valueType:"digit"},r:{title:"R",key:"r",dataIndex:"r",valueType:"digit"},startAngle:{title:"Start Angle",key:"startAngle",dataIndex:"startAngle",valueType:"digit"},endAngle:{title:"End Angle",key:"endAngle",dataIndex:"endAngle",valueType:"digit"},fontSize:{title:"Font Size",key:"fontSize",dataIndex:"fontSize",valueType:"digit"},decimalPlaces:{title:"Decimal Places",key:"decimalPlaces",dataIndex:"decimalPlaces",valueType:"digit"},number:{title:"Number",key:"number",dataIndex:"number",valueType:"digit"},text:{title:"Text",key:"text",dataIndex:"text"},color:{title:"Color",key:"color",dataIndex:"color",valueType:"select",valueEnum:{main:(0,a.jsx)(m,{color:"Main"}),yellow:(0,a.jsx)(m,{color:"Yellow"}),green:(0,a.jsx)(m,{color:"Green"}),orange:(0,a.jsx)(m,{color:"Orange"}),purple:(0,a.jsx)(m,{color:"Purple"}),pink:(0,a.jsx)(m,{color:"Pink"}),cyan:(0,a.jsx)(m,{color:"Cyan"}),black:(0,a.jsx)(m,{color:"Black"}),white:(0,a.jsx)(m,{color:"White"})}},team:{title:"Team",key:"team",dataIndex:"team",valueType:"select",valueEnum:{red:(0,a.jsx)(m,{color:"Red"}),blue:(0,a.jsx)(m,{color:"Blue"})}},backgroundImage:{title:"Background Image",key:"backgroundImage",dataIndex:"backgroundImage",valueType:"switch"}};function gt(l){for(var t=Object.keys(l),o=[],s=0;s<t.length;s++)Z[t[s]]&&o.push(Z[t[s]]);return o}var Y={Rect:x.fabric.util.createClass(x.fabric.Rect,{type:"UiRect",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(t){t||(t={}),t.color||(t.color="main"),this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.groupName,this.ratio=t.ratio,this._color=t.color,this.team=t.team,t.lockRotation=!0,t.lockScalingFlip=!0,t.hasRotatingPoint=!1,t.width||(t.width=50/this.ratio),t.height||(t.height=50/this.ratio),t.left||(t.left=50/this.ratio),t.top||(t.top=50/this.ratio),t.strokeWidth||(t.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?t.stroke=f[this._color]:(t.stroke=f[t.team],this._color="main"),t.fill=null,this.callSuper("initialize",t),this.moveTo(t.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){this.set("width",Math.round(this.width*this.scaleX*this.ratio)/this.ratio),this.set("height",Math.round(this.height*this.scaleY*this.ratio)/this.ratio),this.set("left",Math.round(this.left*this.ratio)/this.ratio),this.set("top",Math.round(this.top*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,width:this.width*this.ratio,height:this.height*this.ratio,x:this.left*this.ratio,y:this.top*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(t){this._color=t.color,this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.group,this.set("width",t.width/this.ratio),this.set("height",t.height/this.ratio),this.set("left",t.x/this.ratio),this.set("top",t.y/this.ratio),this.set("strokeWidth",t.lineWidth/this.ratio),this._color==="main"?this.set("stroke",f[this.team]):this.set("stroke",f[this._color]),this.moveTo(t.layer)},setRatio:function(t){this.set("width",this.width*this.ratio/t),this.set("height",this.height*this.ratio/t),this.set("left",this.left*this.ratio/t),this.set("top",this.top*this.ratio/t),this.set("strokeWidth",this.strokeWidth*this.ratio/t),this.ratio=t},setTeam:function(t){this.team=t,this._color==="main"&&this.set("stroke",f[this.team])}}),Line:x.fabric.util.createClass(x.fabric.Line,{type:"UiLine",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(t){t||(t={}),t.color||(t.color="main"),this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.groupName,this.ratio=t.ratio,this._color=t.color,this.team=t.team,t.lockRotation=!0,t.lockScalingFlip=!0,t.hasRotatingPoint=!1,t.x1||(t.x1=50/this.ratio),t.y1||(t.y1=50/this.ratio),t.x2||(t.x2=100/this.ratio),t.y2||(t.y2=100/this.ratio),t.strokeWidth||(t.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?t.stroke=f[this._color]:(t.stroke=f[t.team],this._color="main"),t.fill=null,this.callSuper("initialize",[t.x1,t.y1,t.x2,t.y2],t),this.moveTo(t.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){var t=this.left,o=this.top,s=Math.round((this.x2-this.x1)*this.scaleX),e=Math.round((this.y2-this.y1)*this.scaleY);this.set("x1",Math.round(t*this.ratio)/this.ratio),this.set("y1",Math.round(o*this.ratio)/this.ratio),this.set("x2",Math.round((t+s)*this.ratio)/this.ratio),this.set("y2",Math.round((o+e)*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,x:this.x1*this.ratio,y:this.y1*this.ratio,x2:this.x2*this.ratio,y2:this.y2*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(t){this._color=t.color,this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.group,this.set("x2",t.x2/this.ratio),this.set("y2",t.y2/this.ratio),this.set("x1",t.x/this.ratio),this.set("y1",t.y/this.ratio),this.set("strokeWidth",t.lineWidth/this.ratio),this._color==="main"?this.set("stroke",f[this.team]):this.set("stroke",f[this._color]),this.moveTo(t.layer)},setRatio:function(t){this.set("x1",this.x1*this.ratio/t),this.set("y1",this.y1*this.ratio/t),this.set("x2",this.x2*this.ratio/t),this.set("y2",this.y2*this.ratio/t),this.set("strokeWidth",this.strokeWidth*this.ratio/t),this.ratio=t},setTeam:function(t){this.team=t,this._color==="main"&&this.set("stroke",f[this.team])}}),Round:x.fabric.util.createClass(x.fabric.Ellipse,{type:"UiRound",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(t){t||(t={}),t.color||(t.color="main"),this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.groupName,this.ratio=t.ratio,this._color=t.color,this.team=t.team,t.lockRotation=!0,t.lockScalingFlip=!0,t.hasRotatingPoint=!1,t.rx||(t.rx=50/this.ratio),t.ry||(t.ry=50/this.ratio),t.left||(t.left=50/this.ratio),t.top||(t.top=50/this.ratio),t.strokeWidth||(t.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?t.stroke=f[this._color]:(t.stroke=f[t.team],this._color="main"),t.fill=null,this.callSuper("initialize",t),this.moveTo(t.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){this.set("rx",Math.round(this.rx*this.scaleX*this.ratio)/this.ratio),this.set("ry",Math.round(this.ry*this.scaleY*this.ratio)/this.ratio),this.set("left",Math.round(this.left*this.ratio)/this.ratio),this.set("top",Math.round(this.top*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,rx:this.rx*this.ratio,ry:this.ry*this.ratio,x:this.left*this.ratio,y:this.top*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(t){this._color=t.color,this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.group,this.set("rx",t.rx/this.ratio),this.set("ry",t.ry/this.ratio),this.set("left",t.x/this.ratio),this.set("top",t.y/this.ratio),this.set("strokeWidth",t.lineWidth/this.ratio),this._color==="main"?this.set("stroke",f[this.team]):this.set("stroke",f[this._color]),this.moveTo(t.layer)},setRatio:function(t){this.set("rx",this.rx*this.ratio/t),this.set("ry",this.ry*this.ratio/t),this.set("left",this.left*this.ratio/t),this.set("top",this.top*this.ratio/t),this.set("strokeWidth",this.strokeWidth*this.ratio/t),this.ratio=t},setTeam:function(t){this.team=t,this._color==="main"&&this.set("stroke",f[this.team])}}),Text:x.fabric.util.createClass(x.fabric.IText,{type:"UiText",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(t){t||(t={}),t.color||(t.color="main"),this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.groupName,this.ratio=t.ratio,this._color=t.color,this.team=t.team,t.lockRotation=!0,t.lockScalingFlip=!0,t.hasRotatingPoint=!1,t.editable=!1,t.rx||(t.rx=50/this.ratio),t.ry||(t.ry=50/this.ratio),t.left||(t.left=50/this.ratio),t.top||(t.top=50/this.ratio),t.strokeWidth||(t.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?t.stroke=f[this._color]:(t.stroke=f[t.team],this._color="main"),t.fill=null,this.callSuper("initialize",t),this.moveTo(t.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){this.set("rx",Math.round(this.rx*this.scaleX*this.ratio)/this.ratio),this.set("ry",Math.round(this.ry*this.scaleY*this.ratio)/this.ratio),this.set("left",Math.round(this.left*this.ratio)/this.ratio),this.set("top",Math.round(this.top*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,rx:this.rx*this.ratio,ry:this.ry*this.ratio,x:this.left*this.ratio,y:this.top*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(t){this._color=t.color,this.id=t.id,this.name=t.name,this.layer=t.layer,this.groupName=t.group,this.set("rx",t.rx/this.ratio),this.set("ry",t.ry/this.ratio),this.set("left",t.x/this.ratio),this.set("top",t.y/this.ratio),this.set("strokeWidth",t.lineWidth/this.ratio),this._color==="main"?this.set("stroke",f[this.team]):this.set("stroke",f[this._color]),this.moveTo(t.layer)},setRatio:function(t){this.set("rx",this.rx*this.ratio/t),this.set("ry",this.ry*this.ratio/t),this.set("left",this.left*this.ratio/t),this.set("top",this.top*this.ratio/t),this.set("strokeWidth",this.strokeWidth*this.ratio/t),this.ratio=t},setTeam:function(t){this.team=t,this._color==="main"&&this.set("stroke",f[this.team])}})};function F(l){var t={id:l.id,name:l.name,layer:l.layer,groupName:l.group,ratio:l.ratio,team:l.team};return new Y[l.type.slice(2)](t)}function mt(){for(var l=[],t=0,o=Object.keys(Y);t<o.length;t++){var s=o[t];l.push({key:"D1-add-".concat(s),label:s})}return l}var K=tt.Z.Dragger,vt=function(l){O()(o,l);var t=T()(o);function o(){var s;S()(this,o);for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return s=t.call.apply(t,[this].concat(i)),y()(v()(s),"data",{}),y()(v()(s),"objects",{}),y()(v()(s),"state",{treeData:[],properties:null,groupKey:"layer",selectedId:-1,selectedKey:[],uiWindow:{height:1080,width:1920,ratio:1,team:"red",backgroundImage:!0},rightClickMenuOpen:!1,infoModalShow:!1,uploadModalShow:!1,imageUploadShow:!1}),y()(v()(s),"editable",!1),y()(v()(s),"canvas",null),y()(v()(s),"canvasRef",(0,j.createRef)()),y()(v()(s),"generatorRef",(0,j.createRef)()),y()(v()(s),"background",null),s}return I()(o,[{key:"getNewDataId",value:function(){return Object.keys(this.data).length===0?0:Math.max.apply(Math,$()(Object.keys(this.data)))+1}},{key:"updateTree",value:function(){for(var e=this.state.groupKey,i=[],r=Object.keys(this.data),n=0;n<r.length;n++){for(var c=this.data[r[n]],d=-1,u=0;u<i.length;u++)if(i[u].key==="".concat(e,"-").concat(c[e])){d=u;break}d===-1&&(i.push({title:"".concat(e," ").concat(c[e]),key:"".concat(e,"-").concat(c[e]),children:[],isLeaf:!1}),d=i.length-1),i[d].children.push({title:c.name,key:"E-".concat(r[n])})}i=i.sort(function(k,C){return k.key.toString().localeCompare(C.key.toString())}),i.unshift({title:"UI Window",key:"window"}),this.setState({treeData:i})}},{key:"getNodeFromId",value:function(e){return e[0]==="E"?e.slice(2):-1}},{key:"onSelect",value:function(e){if(e.length!==0){if(e[0]==="window"){this.setState({properties:this.state.uiWindow,selectedId:-1,selectedKey:e}),this.canvas.discardActiveObject(),this.canvas.renderAll();return}var i=this.getNodeFromId(e[0]);this.select(i)}}},{key:"select",value:function(e){typeof e=="undefined"||e===-1?(this.setState({properties:null,selectedId:-1,selectedKey:[]}),this.canvas.discardActiveObject(),this.canvas.renderAll()):(this.setState({properties:this.data[e],selectedId:e,selectedKey:["E-".concat(e)]}),this.canvas.setActiveObject(this.objects[e]),this.canvas.renderAll())}},{key:"elementsMenuOnClick",value:function(e){var i=this,r=e.keyPath[e.keyPath.length-1];if(r==="D1-add"){var n=e.key.slice(7),c=this.getNewDataId(),d={id:c,name:"New".concat(n),layer:0,group:"Ungroup",ratio:this.state.uiWindow.ratio,team:this.state.uiWindow.team,type:"Ui".concat(n)},u=F(d);this.objects[c]=u,this.canvas.add(u),this.objectsToData(),this.updateTree()}else r==="D1-group"?this.setState({groupKey:e.key.slice(9)},function(){return i.updateTree()}):r==="D1-reset"?this.reset():r==="D1-save"?(this.objectsToData(),ct(this.data,"ui.rmui")):r==="D1-open"?this.setState({uploadModalShow:!0}):r==="D1-generate"&&this.generatorRef.current.gen(this.data)}},{key:"reset",value:function(){this.canvas.clear(),this.canvas.backgroundColor="#fff",this.state.uiWindow.backgroundImage&&this.canvas.setBackgroundImage(this.background),this.objects={},this.data={},this.select(-1),this.updateTree(),this.resetCanvasSize(),localStorage.setItem("data","{}")}},{key:"resetCanvasSize",value:function(){var e,i=this.canvasRef.current.clientWidth-12,r=this.canvasRef.current.clientHeight,n=D()({},this.state.uiWindow);i/r<n.width/n.height?(r=i*n.height/n.width,n.ratio=n.width/i):(i=r*n.width/n.height,n.ratio=n.height/r),this.setState({uiWindow:n}),this.canvas.setHeight(r),this.canvas.setWidth(i);for(var c=0,d=Object.keys(this.objects);c<d.length;c++){var u=d[c];this.objects[u].setRatio(n.ratio)}(e=this.background)===null||e===void 0||e.set({scaleX:1/n.ratio,scaleY:1/n.ratio}),this.canvas.renderAll(),this.objectsToData(),this.setState({infoModalShow:!1})}},{key:"onReSize",value:function(){var e=this;this.state.infoModalShow||(this.canvas.setHeight(10),this.canvas.setWidth(10),this.canvas.renderAll(),this.setState({infoModalShow:!0},function(){R.Z.info({title:"Reset UI Window Size",content:"Must reset UI window size after resize browser window.",onOk:function(){return e.resetCanvasSize()},okText:"Reset"})}))}},{key:"onPropertiesChange",value:function(e,i){var r=this;if(this.state.selectedKey[0]==="window"){if(i.team!==this.state.uiWindow.team){for(var n=0,c=Object.keys(this.objects);n<c.length;n++){var d=c[n];this.objects[d].setTeam(i.team)}this.canvas.renderAll(),this.objectsToData()}if(this.setState({uiWindow:i,properties:i},function(){r.resetCanvasSize()}),i.backgroundImage!==this.state.uiWindow.backgroundImage)if(i.backgroundImage){var u,k=this.state.uiWindow.ratio;(u=this.background)===null||u===void 0||u.set({scaleX:1/k,scaleY:1/k}),this.canvas.setBackgroundImage(this.background),this.canvas.renderAll()}else this.canvas.setBackgroundImage(null),this.canvas.renderAll();(i.width!==this.state.uiWindow.width||i.height!==this.state.uiWindow.height)&&R.Z.warning({title:"Warning",content:"Modify UI window width and height may cause unknown error."})}else this.state.selectedId!==-1&&(this.objects[this.state.selectedId].fromObject(i),this.canvas.renderAll(),this.objectsToData(),this.updateTree())}},{key:"componentDidMount",value:function(){var e=this,i=this;this.canvas=new x.fabric.Canvas("ui"),x.fabric.Image.fromURL(h(56133),function(g,b){var p;i.background=g;var w=i.state.uiWindow.ratio;(p=i.background)===null||p===void 0||p.set({scaleX:1/w,scaleY:1/w}),i.state.uiWindow.backgroundImage&&(i.canvas.setBackgroundImage(i.background),i.canvas.renderAll())}),this.canvas.backgroundColor="#fff",this.updateTree(),window.addEventListener("resize",function(){e.onReSize()},!1),window.addEventListener("copy",function(g){g.preventDefault();var b=null;g.target.localName==="input"?b=g.target.ariaValueNow:i.state.selectedId!==-1&&(b=JSON.stringify(i.data[i.state.selectedId])),g.clipboardData.setData("text",b)}),window.addEventListener("paste",function(g){if(g.preventDefault(),g.target.localName==="input")g.target.value=g.clipboardData.getData("text");else try{var b=g.clipboardData.getData("text"),p=JSON.parse(b);p.id=i.getNewDataId(),i.updateObject(p),i.select(p.id)}catch(w){}}),window.addEventListener("keyup",function(g){g.key==="Delete"&&i.state.selectedId!==-1&&i.removeObject(i.state.selectedId)}),this.canvas.on({"mouse:up":function(){for(var b=0,p=Object.keys(i.objects);b<p.length;b++){var w=p[b];i.objects[w].resizeScale()}i.canvas.renderAll(),i.objectsToData();var X=i.canvas.getActiveObject();X?i.select(X.id):i.select(-1)}}),this.canvas.selection=!1;var r=localStorage.getItem("data");if(r){r=JSON.parse(r);for(var n=0,c=Object.keys(r);n<c.length;n++){var d=c[n];this.updateObject(r[d])}}if(this.resetCanvasSize(),this.canvas.renderAll(),r){for(var u=0,k=Object.keys(r);u<k.length;u++){var C=k[u];this.select(C)}this.select(-1)}}},{key:"objectsToData",value:function(){this.data={};for(var e=0,i=Object.keys(this.objects);e<i.length;e++){var r=i[e],n=this.objects[r].toObject();this.data[n.id]=n}this.state.selectedId!==-1&&this.setState({properties:this.data[this.state.selectedId]}),Object.keys(this.data).length!==0&&localStorage.setItem("data",JSON.stringify(this.data))}},{key:"updateObject",value:function(e){if(this.objects[e.id])this.objects[e.id].fromObject(e);else{var i={id:e.id,name:e.name,layer:e.layer,groupName:e.group,type:e.type,ratio:this.state.uiWindow.ratio,team:this.state.uiWindow.team},r=F(i);this.objects[e.id]=r,r.fromObject(e),r.setRatio(this.state.uiWindow.ratio),this.canvas.add(r)}this.objectsToData(),this.updateTree()}},{key:"removeObject",value:function(e){this.objects[e]&&(this.select(-1),this.canvas.remove(this.objects[e]),this.canvas.renderAll(),delete this.objects[e],this.objectsToData(),this.updateTree())}},{key:"onElementRightClick",value:function(e){e.node.key[0]==="E"?this.select(e.node.key.slice(2)):this.select(-1)}},{key:"onElementMenuClick",value:function(e){if(this.setState({rightClickMenuOpen:!1}),e.key==="D2-copy"){var i=D()({},this.data[this.state.selectedId]);i.id=this.getNewDataId(),this.updateObject(i)}else e.key==="D2-delete"&&this.removeObject(this.state.selectedId)}},{key:"onMenuOpenChange",value:function(e){if(e){var i=this;setTimeout(function(){i.state.selectedId!==-1?i.setState({rightClickMenuOpen:!0}):i.setState({rightClickMenuOpen:!1})},100)}else this.setState({rightClickMenuOpen:!1})}},{key:"onElementMenuContainerClick",value:function(e){e.target.localName==="div"&&(this.setState({rightClickMenuOpen:!1,properties:null,selectedId:-1,selectedKey:[]}),this.select(-1))}},{key:"onUploadModalCancel",value:function(){this.setState({uploadModalShow:!1})}},{key:"onImageUploadModalCancel",value:function(){this.setState({imageUploadShow:!1})}},{key:"onUploadFile",value:function(e){var i=this,r=new FileReader;return r.onload=function(n){var c=n.target.result,d=JSON.parse(c);i.reset(),i.setState({uploadModalShow:!1});for(var u=0,k=Object.keys(d);u<k.length;u++){var C=k[u];i.updateObject(d[C])}},r.readAsText(e),!0}},{key:"onUploadImage",value:function(e){var i=this;this.setState({imageUploadShow:!1}),this.background.setSrc(ut(e),function(){i.canvas.renderAll()})}},{key:"render",value:function(){var e=this,i=0,r=[{key:"D1-group",label:"Group by",children:[{key:"D1-group-layer",label:"layer"},{key:"D1-group-group",label:"group"}]},{key:"D1-reset",label:"Reset Designer"}];this.props.editable&&(r.unshift({key:"D1-add",label:"Add Element",children:mt()}),r.push({type:"divider"},{key:"D1-open",label:"Open .rmui"},{key:"D1-save",label:"Save as .rmui"},{type:"divider"},{key:"D1-generate",label:"Generate Code",icon:(0,a.jsx)(st.Z,{})}),i++);for(var n=0;n<r[i].children.length;n++)r[i].children[n].label===this.state.groupKey&&(r[i].children[n].icon=(0,a.jsx)(rt.Z,{}));return(0,a.jsxs)("div",{className:"full",children:[(0,a.jsxs)(et.Z,{warp:!1,className:"container",gutter:12,children:[(0,a.jsxs)(U.Z,{flex:"300px",children:[(0,a.jsx)("div",{style:{height:"50%",paddingBottom:12},children:(0,a.jsx)(z.Z,{size:"small",title:"Elements",style:{height:"100%"},extra:(0,a.jsx)(A.Z,{menu:{items:r,onClick:function(d){return e.elementsMenuOnClick(d)}},children:(0,a.jsx)(lt.Z,{})}),children:(0,a.jsx)("div",{className:"card-body",onMouseUp:function(d){return e.onElementMenuContainerClick(d)},children:(0,a.jsx)(A.Z,{menu:{items:[{key:"D2-copy",label:"Copy"},{key:"D2-delete",label:"Delete",danger:!0}],onClick:function(d){e.onElementMenuClick(d)}},trigger:["contextMenu"],open:this.state.rightClickMenuOpen,onOpenChange:function(d){e.onMenuOpenChange(d)},children:(0,a.jsx)(it.Z,{className:"full",treeData:this.state.treeData,onSelect:function(d){return e.onSelect(d)},selectedKeys:this.state.selectedKey,onRightClick:function(d){return e.onElementRightClick(d)},defaultExpandParent:!0})})})})}),(0,a.jsx)(z.Z,{size:"small",title:"Properties",style:{height:"50%"},children:(0,a.jsxs)("div",{className:"card-body",children:[this.state.properties?(0,a.jsx)(ht.vY,{dataSource:this.state.properties,columns:gt(this.state.properties),editable:this.props.editable?{onSave:function(d,u){return e.onPropertiesChange(d,u)}}:null,column:1,style:{marginTop:4}}):(0,a.jsx)(E.Z,{image:E.Z.PRESENTED_IMAGE_SIMPLE}),this.state.selectedKey[0]==="window"?(0,a.jsx)(at.ZP,{onClick:function(){return e.setState({imageUploadShow:!0})},children:"Upload Background"}):(0,a.jsx)("div",{})]})})]}),(0,a.jsx)(U.Z,{flex:"auto",ref:this.canvasRef,children:(0,a.jsx)("canvas",{className:"full",id:"ui"})})]}),(0,a.jsxs)(R.Z,{title:"Upload Your .rmui File",open:this.state.uploadModalShow,onCancel:function(){return e.onUploadModalCancel()},footer:null,destroyOnClose:!0,children:[(0,a.jsx)(L.Z,{}),(0,a.jsxs)(K,{showUploadList:!1,beforeUpload:function(d){return e.onUploadFile(d)},accept:".rmui",children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(P.Z,{})}),(0,a.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})]}),(0,a.jsxs)(R.Z,{title:"Upload Your Background Image",open:this.state.imageUploadShow,onCancel:function(){return e.onImageUploadModalCancel()},footer:null,destroyOnClose:!0,children:[(0,a.jsx)(L.Z,{}),(0,a.jsxs)(K,{showUploadList:!1,beforeUpload:function(d){return e.onUploadImage(d)},accept:"image/*",children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(P.Z,{})}),(0,a.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})]}),(0,a.jsx)(dt,{ref:this.generatorRef})]})}}]),o}(j.Component),yt=vt,xt=function(l){O()(o,l);var t=T()(o);function o(){return S()(this,o),t.apply(this,arguments)}return I()(o,[{key:"render",value:function(){return(0,a.jsx)("div",{className:"container",children:(0,a.jsx)(yt,{className:"full",editable:!0})})}}]),o}(j.Component),kt=xt},56133:function(N,M,h){"use strict";N.exports=h.p+"static/background.d741a18b.png"},41001:function(){},35287:function(){},7396:function(){}}]);
