"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[858],{7215:function(ui,Be,y){y.r(Be),y.d(Be,{default:function(){return li}});var Ct=y(12444),A=y.n(Ct),It=y(72004),T=y.n(It),At=y(25098),w=y.n(At),Tt=y(31996),P=y.n(Tt),Dt=y(26037),B=y.n(Dt),Et=y(9783),b=y.n(Et),I=y(67294),We=y(9361),Ot=y(31282),Ye=y(62338),Nt=y(65848),Ft=y(97857),W=y.n(Ft),Rt=y(15009),x=y.n(Rt),Lt=y(64599),O=y.n(Lt),Ut=y(99289),j=y.n(Ut),Zt=y(19632),N=y.n(Zt),$e=y(327),he=y(32983),G=y(42075),z=y(28036),U,Ht,Se,K=1,Pt=function(){var n=Ye.Z.useApp();return U=n.message,Se=n.modal,Ht=n.notification,null};function Bt(n){K=parseInt(n)}var _=y(3909),Ge=y(66227),de=y(86250),te=y(83159),Wt=y(98668),Yt=y(63237),$t=y(99569),Gt=y(36810),Qt=y(19893),Vt=y(42922),u=y(85893),Jt=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{status:i.props.defaultStatus||!1}),i}return T()(s,[{key:"render",value:function(){var t=this;return(0,u.jsx)(z.ZP,{size:"small",type:"text",onClick:function(){t.props.onChange&&t.props.onChange(!t.state.status),t.setState({status:!t.state.status})},children:this.state.status?this.props.onNode||"ON":this.props.offNode||"OFF"})}}]),s}(I.Component),Qe=Jt;function Kt(n){return n.map(function(e){return e===-2?"window":"E-".concat(e)})}var Xt=[{key:"D1-group-layer",label:"layer"},{key:"D1-group-group",label:"group"}],qt=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{treeData:[],rightClickMenuOpen:!1,groupKey:"layer"}),b()(w()(i),"treeData",[]),i}return T()(s,[{key:"selectKey2id",value:function(t){var r=this,a=[],l=O()(t),o;try{var c=function(){var v=o.value;if(v==="window")a.push(-2);else if(v.startsWith("E-"))a.push(parseInt(v.slice(2)));else{var p=r.treeData.find(function(M){return M.key===v}).children.map(function(M){return parseInt(M.key.slice(2))}),d=O()(p),m;try{for(d.s();!(m=d.n()).done;){var g=m.value;a.includes(g)||a.push(g)}}catch(M){d.e(M)}finally{d.f()}}};for(l.s();!(o=l.n()).done;)c()}catch(h){l.e(h)}finally{l.f()}return a}},{key:"onElementMenuContainerClick",value:function(t){t.target.classList.value.includes("ant-dropdown-menu")||(console.log(t.target.className),this.setState({rightClickMenuOpen:!1}),(t.target.classList.contains("ant-tree")||!t.ctrlKey&&!t.shiftKey)&&this.props.onSelect([]))}},{key:"onElementMenuClick",value:function(t){var r=this;if(this.setState({rightClickMenuOpen:!1}),t.key==="D2-copy"){var a=null;t.target.localName!=="input"&&this.props.selectedId.length!==0&&this.props.selectedId[0]!==-2&&(t.preventDefault(),a=JSON.stringify(this.props.selectedId.map(function(h){return r.props.data[h]})),t.clipboardData.setData("text",a))}else if(t.key==="D2-delete"){var l=O()(this.props.selectedId),o;try{for(l.s();!(o=l.n()).done;){var c=o.value;console.log(c),console.log(this.props.onObjectEvent("remove",{id:c}))}}catch(h){l.e(h)}finally{l.f()}}}},{key:"onElementRightClick",value:function(t){var r=this.selectKey2id([t.node.key]);r[0]in this.props.selectedId||this.props.onSelect(r)}},{key:"onSelect",value:function(t){if(t.length!==0){var r=this.selectKey2id(t);r.includes(-2)&&(r=[r[r.length-1]]),this.props.onSelect(r)}}},{key:"onMenuOpenChange",value:function(t){if(t){var r=this;setTimeout(function(){r.props.selectedId.length!==0&&r.props.selectedId[0]!==-2?r.setState({rightClickMenuOpen:!0}):r.setState({rightClickMenuOpen:!1})},100)}else this.setState({rightClickMenuOpen:!1})}},{key:"elementsMenuOnClick",value:function(t){var r=this;this.setState({groupKey:t.key.slice(9)},function(){return r.updateTree()})}},{key:"updateTree",value:function(){for(var t=this,r=this.state.groupKey,a=[],l=Object.keys(this.props.data),o=function(){for(var v=t.props.data[l[c]],p=-1,d=0;d<a.length;d++)if(a[d].key==="".concat(r,"-").concat(v[r])){p=d;break}p===-1&&(a.push({title:"".concat(r," ").concat(v[r]),key:"".concat(r,"-").concat(v[r]),children:[],isLeaf:!1}),p=a.length-1),a[p].children.push({title:(0,u.jsxs)(de.Z,{justify:"space-between",style:{width:"100%"},children:[v.name,(0,u.jsxs)(G.Z,{children:[(0,u.jsx)(Qe,{onChange:function(g){return t.props.onObjectEvent("setAttr",{id:v.id,payload:{visible:g}})},defaultStatus:!0,offNode:(0,u.jsx)(Yt.Z,{}),onNode:(0,u.jsx)($t.Z,{})}),(0,u.jsx)(Qe,{onChange:function(g){return t.props.onObjectEvent("setAttr",{id:v.id,payload:{selectable:g}})},defaultStatus:!0,offNode:(0,u.jsx)(Gt.Z,{}),onNode:(0,u.jsx)(Qt.Z,{style:{transform:"scaleX(-1)"}})})]})]}),key:"E-".concat(l[c])})},c=0;c<l.length;c++)o();return a=a.sort(function(h,v){return h.key.toString().localeCompare(v.key.toString())}),a.unshift({title:"UI Window",key:"window"}),this.treeData=a,a}},{key:"render",value:function(){var t=this;return(0,u.jsx)($e.Z,{size:"small",title:"Elements",style:{height:"100%"},extra:(0,u.jsx)(te.Z,{menu:{items:Xt,onClick:function(a){return t.elementsMenuOnClick(a)},selectable:!0,selectedKeys:["D1-group-".concat(this.state.groupKey)]},children:(0,u.jsxs)(G.Z,{style:{fontSize:11},children:["Group by",(0,u.jsx)(Vt.Z,{size:"small"})]})}),children:(0,u.jsx)("div",{className:"card-body",onMouseUp:function(a){return t.onElementMenuContainerClick(a)},children:(0,u.jsx)(te.Z,{menu:{items:[{key:"D2-copy",label:"Copy"},{key:"D2-delete",label:"Delete",danger:!0}],onClick:function(a){t.onElementMenuClick(a)}},trigger:["contextMenu"],open:this.state.rightClickMenuOpen,onOpenChange:function(a){t.onMenuOpenChange(a)},children:(0,u.jsx)(Wt.Z,{className:"full",treeData:this.updateTree(),onSelect:function(a){return t.onSelect(a)},selectedKeys:Kt(this.props.selectedId),onRightClick:function(a){return t.onElementRightClick(a)},treeDefaultExpandAll:!0,showLine:!0,blockNode:!0,multiple:!0,selectable:this.props.editable})})})})}}]),s}(I.Component),_t=qt,Z=y(32777),k=y(30789),er=function(n){P()(s,n);var e=B()(s);function s(){return A()(this,s),e.apply(this,arguments)}return T()(s,[{key:"render",value:function(){return this.props.color==="Main"?(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{border:"1px solid #aaa",height:16,width:16,borderRadius:"20%",display:"inline-flex"},children:[(0,u.jsx)("div",{style:{backgroundColor:"red",height:12,width:6,margin:"1px 0 1px 1px",borderTopLeftRadius:"20%",borderBottomLeftRadius:"20%",display:"inline-flex"}}),(0,u.jsx)("div",{style:{backgroundColor:"blue",height:12,width:6,margin:"1px 1px 1px 0",borderTopRightRadius:"20%",borderBottomRightRadius:"20%",display:"inline-flex"}})]}),"\xA0 Main"]}):(0,u.jsx)("div",{children:(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{border:"1px solid #aaa",height:16,width:16,borderRadius:"20%",display:"inline-flex"},children:(0,u.jsx)("div",{style:{backgroundColor:k.E[this.props.color.toLowerCase()],height:12,width:12,margin:1,borderRadius:"20%",display:"inline-flex"}})}),"\xA0 ",this.props.color]})})}}]),s}(I.Component),V=er,Ve=function(e){var s=e,i="Robot";e>256&&(i="Client",e-=256);var t;e>100?t="Blue":t="Red",e%=100;var r={1:"Hero",2:"Engineer",3:"No3. Infantry",4:"No4. Infantry",5:"No5. Infantry",6:"Drone"};return"".concat(t," ").concat(r[e]," ").concat(i," (").concat(s,")")},Je={id:{title:"Id",key:"id",dataIndex:"id",valueType:"digit",editable:!1},name:{title:"Name",key:"name",dataIndex:"name"},group:{title:"Group",key:"group",dataIndex:"group"},kind:{title:"Kind",key:"kind",dataIndex:"kind",editable:!1},lineWidth:{title:"Line Width",key:"lineWidth",dataIndex:"lineWidth",valueType:"digit"},layer:{title:"Layer",key:"layer",dataIndex:"layer",valueType:"digit"},x:{title:"X",key:"x",dataIndex:"x",valueType:"digit"},y:{title:"Y",key:"y",dataIndex:"y",valueType:"digit"},x2:{title:"X2",key:"x2",dataIndex:"x2",valueType:"digit"},y2:{title:"Y2",key:"y2",dataIndex:"y2",valueType:"digit"},width:{title:"Width",key:"width",dataIndex:"width",valueType:"digit"},height:{title:"Height",key:"height",dataIndex:"height",valueType:"digit"},rx:{title:"Rx",key:"rx",dataIndex:"rx",valueType:"digit"},ry:{title:"Ry",key:"ry",dataIndex:"ry",valueType:"digit"},r:{title:"R",key:"r",dataIndex:"r",valueType:"digit"},startAngle:{title:"Start Angle",key:"startAngle",dataIndex:"startAngle",valueType:"digit"},endAngle:{title:"End Angle",key:"endAngle",dataIndex:"endAngle",valueType:"digit"},fontSize:{title:"Font Size",key:"fontSize",dataIndex:"fontSize",valueType:"digit"},float:{title:"Number",key:"float",dataIndex:"float",valueType:"digit"},number:{title:"Number",key:"number",dataIndex:"number",valueType:"digit"},text:{title:"Text",key:"text",dataIndex:"text",formItemProps:{rules:[{max:30},{type:"string"}]}},color:{title:"Color",key:"color",dataIndex:"color",valueType:"select",valueEnum:{main:(0,u.jsx)(V,{color:"Main"}),yellow:(0,u.jsx)(V,{color:"Yellow"}),green:(0,u.jsx)(V,{color:"Green"}),orange:(0,u.jsx)(V,{color:"Orange"}),purple:(0,u.jsx)(V,{color:"Purple"}),pink:(0,u.jsx)(V,{color:"Pink"}),cyan:(0,u.jsx)(V,{color:"Cyan"}),black:(0,u.jsx)(V,{color:"Black"}),white:(0,u.jsx)(V,{color:"White"})}},team:{title:"Team",key:"team",dataIndex:"team",valueType:"select",valueEnum:{red:(0,u.jsx)(V,{color:"Red"}),blue:(0,u.jsx)(V,{color:"Blue"})}},role:{title:"Role",key:"role",dataIndex:"role",valueType:"select",valueEnum:{1:"Hero",2:"Engineer",3:"No3. Infantry",4:"No4. Infantry",5:"No5. Infantry",6:"Drone"}},backgroundImage:{title:"Background Image",key:"backgroundImage",dataIndex:"backgroundImage",valueType:"switch"},length:{title:"DataLength",key:"length",dataIndex:"length",valueType:"digit"},seq:{title:"Seq",key:"seq",dataIndex:"seq",valueType:"digit"},cmd_id:{title:"Cmd Id",key:"cmd_id",dataIndex:"cmd_id",valueType:"text",renderText:function(e){return"0x".concat(e.toString(16).padStart(4,"0"))}},sub_id:{title:"Sub Id",key:"sub_id",dataIndex:"sub_id",valueType:"text",renderText:function(e){return"0x".concat(e.toString(16).padStart(4,"0"))}},sender:{title:"Sender",key:"sender",dataIndex:"sender",valueType:"select",renderText:Ve},receiver:{title:"Receiver",key:"receiver",dataIndex:"receiver",valueType:"select",renderText:Ve},error:{title:"Error",key:"error",dataIndex:"error",valueType:"text"},operation:{title:"Operation",key:"operation",dataIndex:"operation",valueType:"text"}};function Ke(n){for(var e=Object.keys(n),s=[],i=0;i<e.length;i++)Je[e[i]]&&s.push(Je[e[i]]);return s}var tr=Z.fabric.util.createClass(Z.fabric.Rect,{type:"UiRect",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(e){e||(e={}),e.color||(e.color="main"),this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.groupName,this.ratio=e.ratio,this._color=e.color,this.team=e.team,e.lockRotation=!0,e.lockScalingFlip=!0,e.hasRotatingPoint=!1,e.width||(e.width=50/this.ratio),e.height||(e.height=50/this.ratio),e.left||(e.left=50/this.ratio),e.top||(e.top=50/this.ratio),e.strokeWidth||(e.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?e.stroke=k.E[this._color]:(e.stroke=k.E[e.team],this._color="main"),e.fill=null,this.callSuper("initialize",e),this.moveTo(e.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){this.set("width",Math.round(this.width*this.scaleX*this.ratio)/this.ratio),this.set("height",Math.round(this.height*this.scaleY*this.ratio)/this.ratio),this.set("left",Math.round(this.left*this.ratio)/this.ratio),this.set("top",Math.round(this.top*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,width:this.width*this.ratio,height:this.height*this.ratio,x:this.left*this.ratio,y:this.top*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(e){this._color=e.color,this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.group,this.set("width",e.width/this.ratio),this.set("height",e.height/this.ratio),this.set("left",e.x/this.ratio),this.set("top",e.y/this.ratio),this.set("strokeWidth",e.lineWidth/this.ratio),this._color==="main"?this.set("stroke",k.E[this.team]):this.set("stroke",k.E[this._color]),this.moveTo(e.layer)},setRatio:function(e){this.set("width",this.width*this.ratio/e),this.set("height",this.height*this.ratio/e),this.set("left",this.left*this.ratio/e),this.set("top",this.top*this.ratio/e),this.set("strokeWidth",this.strokeWidth*this.ratio/e),this.ratio=e},setTeam:function(e){this.team=e,this._color==="main"&&this.set("stroke",k.E[this.team])}}),rr=Z.fabric.util.createClass(Z.fabric.Line,{type:"UiLine",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(e){e||(e={}),e.color||(e.color="main"),this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.groupName,this.ratio=e.ratio,this._color=e.color,this.team=e.team,e.lockRotation=!0,e.lockScalingFlip=!0,e.hasRotatingPoint=!1,e.x1||(e.x1=50/this.ratio),e.y1||(e.y1=50/this.ratio),e.x2||(e.x2=100/this.ratio),e.y2||(e.y2=100/this.ratio),e.strokeWidth||(e.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?e.stroke=k.E[this._color]:(e.stroke=k.E[e.team],this._color="main"),e.fill=null,this.callSuper("initialize",[e.x1,e.y1,e.x2,e.y2],e),this.moveTo(e.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){var e=Math.min(this.x1,this.x2),s=Math.min(this.y1,this.y2),i=this.left-e,t=this.top-s;if(this.x1<this.x2){var r=Math.round((this.x2-this.x1)*this.scaleX);this.set("x1",Math.round((this.x1+i)*this.ratio)/this.ratio),this.set("x2",Math.round((this.x1+r)*this.ratio)/this.ratio)}else{var a=Math.round((this.x1-this.x2)*this.scaleX);this.set("x2",Math.round((this.x2+i)*this.ratio)/this.ratio),this.set("x1",Math.round((this.x2+a)*this.ratio)/this.ratio)}if(this.y1<this.y2){var l=Math.round((this.y2-this.y1)*this.scaleY);this.set("y1",Math.round((this.y1+t)*this.ratio)/this.ratio),this.set("y2",Math.round((this.y1+l)*this.ratio)/this.ratio)}else{var o=Math.round((this.y1-this.y2)*this.scaleY);this.set("y2",Math.round((this.y2+t)*this.ratio)/this.ratio),this.set("y1",Math.round((this.y2+o)*this.ratio)/this.ratio)}this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,x:this.x1*this.ratio,y:this.y1*this.ratio,x2:this.x2*this.ratio,y2:this.y2*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(e){this._color=e.color,this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.group,this.set("x2",e.x2/this.ratio),this.set("y2",e.y2/this.ratio),this.set("x1",e.x/this.ratio),this.set("y1",e.y/this.ratio),this.set("strokeWidth",e.lineWidth/this.ratio),this._color==="main"?this.set("stroke",k.E[this.team]):this.set("stroke",k.E[this._color]),this.moveTo(e.layer)},setRatio:function(e){this.set("x1",this.x1*this.ratio/e),this.set("y1",this.y1*this.ratio/e),this.set("x2",this.x2*this.ratio/e),this.set("y2",this.y2*this.ratio/e),this.set("strokeWidth",this.strokeWidth*this.ratio/e),this.ratio=e},setTeam:function(e){this.team=e,this._color==="main"&&this.set("stroke",k.E[this.team])}}),je=Z.fabric.util.createClass(Z.fabric.Ellipse,{type:"UiEllipse",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(e){e||(e={}),e.color||(e.color="main"),this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.groupName,this.ratio=e.ratio,this._color=e.color,this.team=e.team,e.lockRotation=!0,e.lockScalingFlip=!0,e.hasRotatingPoint=!1,e.rx||(e.rx=50/this.ratio),e.ry||(e.ry=50/this.ratio),e.left||(e.left=50/this.ratio),e.top||(e.top=50/this.ratio),e.strokeWidth||(e.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?e.stroke=k.E[this._color]:(e.stroke=k.E[e.team],this._color="main"),e.fill=null,this.callSuper("initialize",e),this.moveTo(e.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){this.set("rx",Math.round(this.rx*this.scaleX*this.ratio)/this.ratio),this.set("ry",Math.round(this.ry*this.scaleY*this.ratio)/this.ratio),this.set("left",Math.round(this.left*this.ratio)/this.ratio),this.set("top",Math.round(this.top*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,rx:this.rx*this.ratio,ry:this.ry*this.ratio,x:(this.left+this.rx)*this.ratio,y:(this.top+this.ry)*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(e){this._color=e.color,this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.group,this.set("rx",e.rx/this.ratio),this.set("ry",e.ry/this.ratio),this.set("left",(e.x-e.rx)/this.ratio),this.set("top",(e.y-e.ry)/this.ratio),this.set("strokeWidth",e.lineWidth/this.ratio),this._color==="main"?this.set("stroke",k.E[this.team]):this.set("stroke",k.E[this._color]),this.moveTo(e.layer)},setRatio:function(e){this.set("rx",this.rx*this.ratio/e),this.set("ry",this.ry*this.ratio/e),this.set("left",this.left*this.ratio/e),this.set("top",this.top*this.ratio/e),this.set("strokeWidth",this.strokeWidth*this.ratio/e),this.ratio=e},setTeam:function(e){this.team=e,this._color==="main"&&this.set("stroke",k.E[this.team])}}),ar=Z.fabric.util.createClass(je,{type:"UiRound",r:50,initialize:function(e){e||(e={}),e.r||(e.r=50/this.ratio),e.rx=e.r,e.ry=e.r,this.callSuper("initialize",e),this.setControlVisible("ml",!1),this.setControlVisible("mb",!1),this.setControlVisible("mr",!1),this.setControlVisible("mt",!1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,r:this.rx*this.ratio,x:(this.left+this.rx)*this.ratio,y:(this.top+this.ry)*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(e){e.rx=e.r,e.ry=e.r,this.callSuper("fromObject",e)}}),ir=Z.fabric.util.createClass(je,{type:"UiArc",startAngle:0,endAngle:90,initialize:function(e){e||(e={}),e.startAngle||(e.startAngle=0),e.endAngle||(e.endAngle=90),this.callSuper("initialize",e),this.startAngle=e.startAngle,this.endAngle=e.endAngle,this.set("dirty",!0)},toObject:function(){return Z.fabric.util.object.extend(this.callSuper("toObject"),{startAngle:this.startAngle,endAngle:this.endAngle})},_render:function(e){var s=(this.startAngle-90)*(Math.PI/180),i=(this.endAngle-90)*(Math.PI/180);e.beginPath(),e.ellipse(0,0,this.rx,this.ry,0,s,i,!1),e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke()},fromObject:function(e){this.set("startAngle",e.startAngle),this.set("endAngle",e.endAngle),this.set("ry",1),this.callSuper("fromObject",e)}}),fe=1.25;function re(n,e){var s=re.canvas||(re.canvas=document.createElement("canvas")),i=s.getContext("2d");i.font=e;var t=i.measureText(n);return t.width*fe}var ze=Z.fabric.util.createClass(Z.fabric.Text,{type:"UiText",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",rawFontSize:0,initialize:function(e){var s=this;e||(e={}),e.color||(e.color="main"),this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.groupName,this.ratio=e.ratio,this._color=e.color,this.team=e.team,e.flipY=!0,e.fontSize||(e.fontSize=20/this.ratio),e.fontSize*=fe,e.fontFamily||(e.fontFamily="ds-digitalnormal"),e.text||(e.text="Text"),e.left||(e.left=50/this.ratio),e.top||(e.top=50/this.ratio),e.top-=e.fontSize/this.ratio*2,e.width||(e.width=re(e.text,e.fontSize+"px "+e.fontFamily)*this.ratio),this.rawFontSize=e.fontSize,this._color&&this._color!=="main"?e.fill=k.E[this._color]:(e.fill=k.E[e.team],this._color="main"),this.callSuper("initialize",e.text,e),this.moveTo(e.layer),this.setControlsVisibility({tl:!1,tr:!1,bl:!1,br:!1,ml:!1,mt:!1,mr:!1,mb:!1,mtr:!1}),setTimeout(function(){s.set("width",re(e.text,e.fontSize+"px "+e.fontFamily)/s.ratio)},100)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,fontSize:this.fontSize*this.ratio/fe,x:this.left*this.ratio,y:this.top*this.ratio+this.fontSize*2,text:this.text,color:this._color}},fromObject:function(e){var s=this;this._color=e.color,this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.group,this.set("fontSize",e.fontSize/this.ratio*fe),this.set("left",e.x/this.ratio),this.set("top",e.y/this.ratio-this.fontSize/this.ratio*2),this.text=e.text,this.set("width",re(e.text,e.fontSize+"px "+this.fontFamily)/this.ratio),this.rawFontSize=e.fontSize,setTimeout(function(){s.set("width",re(e.text,e.fontSize+"px "+s.fontFamily)/s.ratio)},100),this._color==="main"?this.set("fill",k.E[this.team]):this.set("fill",k.E[this._color]),this.moveTo(e.layer),this.set("fontFamily","ds-digitalnormal")},setRatio:function(e){this.set("width",this.width*this.ratio/e),this.set("left",this.left*this.ratio/e),this.set("top",this.top*this.ratio/e),this.set("fontSize",this.fontSize*this.ratio/e),this.set("width",re(this.text,this.rawFontSize+"px "+this.fontFamily)/e),this.ratio=e},resizeScale:function(){},setTeam:function(e){this.team=e,this._color==="main"&&this.set("fill",k.E[this.team])}}),sr=Z.fabric.util.createClass(ze,{type:"UiNumber",number:12345,initialize:function(e){e||(e={}),this.number=e.number||12345,e.text=this.number.toString(),this.callSuper("initialize",e)},toObject:function(){var e=this.callSuper("toObject");return e.number=this.number,delete e.text,e},fromObject:function(e){this.number=parseInt(e.number),e.text=this.number.toString(),this.callSuper("fromObject",e)}}),nr=Z.fabric.util.createClass(ze,{type:"UiFloat",float:12.345,initialize:function(e){e||(e={}),this.float=e.float||12.345,e.text=this.float.toString(),this.callSuper("initialize",e)},toObject:function(){var e=this.callSuper("toObject");return e.float=this.float,delete e.text,e},fromObject:function(e){this.float=parseFloat(e.float),e.text=this.float.toString(),this.callSuper("fromObject",e)}}),Xe={Rect:tr,Line:rr,Round:ar,Ellipse:je,Arc:ir,Text:ze,Number:sr,Float:nr};function lr(n){var e={id:n.id,name:n.name,layer:n.layer,groupName:n.group,ratio:n.ratio,team:n.team},s=n.type.slice(2);return new Xe[s](e)}function or(){for(var n=[],e=0,s=Object.keys(Xe);e<s.length;e++){var i=s[e];n.push({key:"Insert-".concat(i),label:i})}return n}function ve(n,e,s,i){return Ce.apply(this,arguments)}function Ce(){return Ce=j()(x()().mark(function n(e,s,i,t){var r,a,l,o,c,h,v,p,d,m;return x()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(e){M.next=2;break}return M.abrupt("return");case 2:if(r=1,e.version&&(r=e.version),r!==1){M.next=10;break}return M.next=7,i("default");case 7:for(a=0,l=Object.keys(e);a<l.length;a++)o=l[a],s("_update",e[o]);M.next=22;break;case 10:if(r!==2){M.next=22;break}c=0,h=Object.keys(e.data);case 12:if(!(c<h.length)){M.next=20;break}return v=h[c],M.next=16,i(v);case 16:for(p=0,d=Object.keys(e.data[v]);p<d.length;p++)m=d[p],s("_update",e.data[v][m]);case 17:c++,M.next=12;break;case 20:return M.next=22,i(e.selected);case 22:t();case 23:case"end":return M.stop()}},n)})),Ce.apply(this,arguments)}var ur=y(96486),qe=y.n(ur);function _e(n){return n.head>0?W()({},n.data[n.head-1]):null}function et(n){return n.head<n.data.length-1?W()({},n.data[n.head+1]):null}var cr=function(){function n(){A()(this,n),b()(this,"cacheTimer",null),b()(this,"updateTimer",null),b()(this,"now",null),b()(this,"_previous",null),b()(this,"_next",null),b()(this,"his",null),b()(this,"catchUpdate",!0);var e=localStorage.getItem("history"),s={data:[{}],head:0,version:1};e?s=JSON.parse(e):(e=localStorage.getItem("data"),e?s.data[0]=JSON.parse(e):s.data[0]={version:2,data:{default:{}},selected:"default"},localStorage.setItem("history",JSON.stringify(s))),this.now=s.data[s.head],this._previous=_e(s),this._next=et(s)}return T()(n,[{key:"save",value:function(){var s=this;this.cacheTimer&&clearTimeout(this.cacheTimer),this.cacheTimer=setTimeout(function(){s.his.head>50&&(s.his.data=s.his.data.slice(s.his.head-50),s.his.head=50),s.his.head<s.his.data.length-20&&(s.his.data=s.his.data.slice(0,s.his.head+20)),localStorage.setItem("history",JSON.stringify(s.his)),s.his=null},2e3)}},{key:"read",value:function(){this.his||(this.his=JSON.parse(localStorage.getItem("history")))}},{key:"get",value:function(){return this.catchUpdate?{now:this.now,couldNext:this._next!==null,couldPrevious:this._previous!==null}:{now:this.now,couldNext:!1,couldPrevious:!1}}},{key:"reset",value:function(s){return this._previous=null,this._next=null,this.his={data:[s],head:0,version:1},this.save(),this.get()}},{key:"next",value:function(){return this._next&&(this._previous=this.now,this.now=this._next,this.read(),this.his.head++,this._next=et(this.his),this.save()),this.get()}},{key:"previous",value:function(){return this._previous&&(this._next=this.now,this.now=this._previous,this.read(),this.his.head--,this._previous=_e(this.his),this.save()),this.get()}},{key:"cancelUpdate",value:function(){this.updateTimer&&clearTimeout(this.updateTimer)}},{key:"update",value:function(s){var i=this;this.catchUpdate&&(this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(function(){qe().isEqual(s,i.now)||(i._previous=i.now,i.now=s,i.read(),i.his.data=i.his.data.slice(0,i.his.head+1),i.his.data.push(s),i.his.head++,i._next=null,i.save())},500))}}]),n}(),hr=cr,dr=y(30819),fr=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"objects",{default:{}}),b()(w()(i),"data",{}),b()(w()(i),"state",{properties:null,selectedId:[],frame:"default",uiWindow:{height:1080,width:1920,ratio:1,team:"red",role:1,backgroundImage:!0},infoModalShow:!1,data:{},editable:!0}),b()(w()(i),"canvas",null),b()(w()(i),"canvasRef",(0,I.createRef)()),b()(w()(i),"propertiesRef",(0,I.createRef)()),b()(w()(i),"background",null),b()(w()(i),"his",new hr),b()(w()(i),"moveTimer",null),b()(w()(i),"moveTimeout",null),i}return T()(s,[{key:"getNewDataId",value:function(){return Object.keys(this.state.data).length===0?0:Math.max.apply(Math,N()(Object.keys(this.state.data)))+1}},{key:"setEditable",value:function(){var i=j()(x()().mark(function r(a){var l,o,c,h,v;return x()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.setState({editable:a}),this.his.catchUpdate=a,this.canvas.selection=a,Z.fabric.Object.prototype.selectable=a,!a){d.next=9;break}return d.next=7,this.onHistoryEvent("refresh");case 7:d.next=15;break;case 9:return l=this.state.uiWindow.role,d.next=12,this.reset(!0);case 12:this.cancelHistoryUpdate(),this.props.setCouldDo({couldNext:!1,couldPrevious:!1}),this.setRobotId(l);case 15:o=this.canvas.getObjects(),c=O()(o);try{for(c.s();!(h=c.n()).done;)v=h.value,v.set("selectable",a)}catch(m){c.e(m)}finally{c.f()}this.select([]);case 19:case"end":return d.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"setRobotId",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;t===0&&(t=this.state.uiWindow.role),typeof t=="string"&&(t=parseInt(t)),this.state.uiWindow.team==="blue"&&(t+=100),Bt(t)}},{key:"cancelHistoryUpdate",value:function(){var t=this;this.his.cancelUpdate(),setTimeout(function(){t.his.cancelUpdate(),t.props.setCouldDo(t.his.get())},200)}},{key:"save",value:function(){(0,k.q7)(this.data,"ui.rmui",this.state.frame)}},{key:"updateHistory",value:function(){var t=this;setTimeout(function(){var r={version:2,data:t.data,selected:t.state.frame};qe().isEqual(r,t.his.now)||(t.his.update(r),t.props.setCouldDo({couldNext:!1,couldPrevious:!0}))},100)}},{key:"getData",value:function(){return this.data}},{key:"select",value:function(t,r){var a=this;if(t.length===0)this.setState({properties:null,selectedId:[]}),this.canvas.discardActiveObject(),this.canvas.renderAll();else if(t[0]===-2)this.setState({properties:this.state.uiWindow,selectedId:[-2]}),this.canvas.discardActiveObject(),this.canvas.renderAll();else if(t.length===1)this.setState({properties:this.state.data[t[0]],selectedId:[t[0]]}),this.canvas.setActiveObject(this.objects[this.state.frame][t[0]]),this.canvas.renderAll();else if(this.setState({properties:null,selectedId:t}),!r){var l=t.map(function(c){return a.objects[a.state.frame][c]}),o=new Z.fabric.ActiveSelection(l,{canvas:this.canvas});this.canvas.setActiveObject(o),this.canvas.renderAll()}}},{key:"reset",value:function(){var i=j()(x()().mark(function r(){var a,l,o,c=arguments;return x()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(a=c.length>0&&c[0]!==void 0?c[0]:!1,a){l=this.canvas.getObjects();for(o in l)this.canvas.remove(l[o]);this.canvas.renderAll()}else this.canvas.clear(),this.setBackground(y(25665)),this.canvas.backgroundColor="#fff";if(Object.keys(this.objects).includes("default")){v.next=5;break}return v.next=5,this.onFrameEvent("add","default");case 5:return this.objects.default={},v.next=8,this.onFrameEvent("change","default");case 8:this.objects={default:{}},this.props.onFrameChange({frames:["default"],selected:"default"}),this.select([]),this.resetCanvasSize(),this.objectsToData();case 13:case"end":return v.stop()}},r,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"resetCanvasSize",value:function(){if(this.canvas){var t,r=this.canvasRef.current.clientWidth,a=this.canvasRef.current.clientHeight,l=W()({},this.state.uiWindow);r/a<l.width/l.height?(a=r*l.height/l.width,l.ratio=l.width/r):(r=a*l.width/l.height,l.ratio=l.height/a),this.setState({uiWindow:l}),this.canvas.setHeight(a),this.canvas.setWidth(r),this.canvas.viewportTransform[5]=a,this.canvas.viewportTransform[3]=-1;var o=this.canvasRef.current.clientWidth,c=this.canvasRef.current.clientHeight,h=o-r,v=c-a,p=document.getElementById("coordinateDisplay");p.style.right="".concat(h+12,"px"),p.style.bottom="".concat(v+25,"px");for(var d=0,m=Object.keys(this.objects[this.state.frame]);d<m.length;d++){var g=m[d];this.objects[this.state.frame][g].setRatio(l.ratio)}(t=this.background)===null||t===void 0||t.set({scaleX:1/l.ratio,scaleY:1/l.ratio}),this.canvas.renderAll(),this.objectsToData(),this.setState({infoModalShow:!1})}}},{key:"onPropertiesChange",value:function(t,r){var a=this;if(this.state.selectedId[0]===-2){if(r.team!==this.state.uiWindow.team){for(var l=0,o=Object.keys(this.objects[this.state.frame]);l<o.length;l++){var c=o[l];this.objects[this.state.frame][c].setTeam(r.team)}this.canvas.renderAll(),this.objectsToData()}if(this.setState({uiWindow:r,properties:r},function(){a.resetCanvasSize(),a.setRobotId()}),r.backgroundImage!==this.state.uiWindow.backgroundImage)if(r.backgroundImage){var h,v=this.state.uiWindow.ratio;(h=this.background)===null||h===void 0||h.set({scaleX:1/v,scaleY:1/v}),this.canvas.setBackgroundImage(this.background),this.canvas.renderAll()}else this.canvas.setBackgroundImage(null),this.canvas.renderAll();(r.width!==this.state.uiWindow.width||r.height!==this.state.uiWindow.height)&&Se.warning({title:"Warning",content:"Modify UI window width and height may cause unknown error."})}else this.state.selectedId.length===1&&(this.objects[this.state.frame][this.state.selectedId[0]].fromObject(r),this.canvas.renderAll(),this.objectsToData(),this.updateHistory())}},{key:"setBackground",value:function(t){var r=this;Z.fabric.Image.fromURL(t,function(a,l){var o;r.background=a;var c=r.state.uiWindow.ratio;(o=r.background)===null||o===void 0||o.set({scaleX:1/c,scaleY:-1/c}),r.state.uiWindow.backgroundImage&&(r.canvas.setBackgroundImage(r.background),r.canvas.renderAll())})}},{key:"componentDidMount",value:function(){var t=this,r=this;this.canvas=new Z.fabric.Canvas("ui"),this.setBackground(y(25665)),this.canvas.backgroundColor="#fff",window.addEventListener("resize",function(){t.resetCanvasSize()},!1),window.addEventListener("copy",function(a){var l=null;console.log(a.target,(0,k.jK)(a.target)),!(0,k.jK)(a.target)&&r.state.selectedId.length!==0&&r.state.selectedId[0]!==-2&&(a.preventDefault(),l=JSON.stringify(r.state.selectedId.map(function(o){return r.state.data[o]})),a.clipboardData.setData("text",l))}),window.addEventListener("paste",function(a){for(var l=!1,o=a.clipboardData.items,c=0;c<o.length;c++)if(o[c].type.indexOf("image")===0){a.preventDefault(),l=!0;var h=o[c].getAsFile(),v=new FileReader;v.onload=function(L){r.setBackground(L.target.result)},v.readAsDataURL(h)}if(!l&&!(0,k.jK)(a.target))try{a.preventDefault();var p=a.clipboardData.getData("text"),d=JSON.parse(p);Array.isArray(d)||(d=[d]);var m=[],g=20,M=O()(d),C;try{var S=function(){var F=C.value;setTimeout(function(){F.id=r.getNewDataId(),m.push(F.id),r.onObjectEvent("_update",F)},g),g+=20};for(M.s();!(C=M.n()).done;)S()}catch(L){M.e(L)}finally{M.f()}setTimeout(function(){r.select(m),t.updateHistory()},g)}catch(L){U.warning("Invalid data")}}),window.addEventListener("keydown",function(a){if(a.key==="Delete"&&r.state.selectedId.length!==0&&r.state.selectedId[0]!==-2){var l=O()(r.state.selectedId),o;try{for(l.s();!(o=l.n()).done;){var c=o.value;r.onObjectEvent("remove",{id:c})}}catch(p){l.e(p)}finally{l.f()}t.updateHistory()}if(a.ctrlKey&&a.key==="z"&&!a.shiftKey?(a.preventDefault(),t.onHistoryEvent("previous")):a.ctrlKey&&(0,dr.toLower)(a.key)==="z"&&a.shiftKey&&(a.preventDefault(),t.onHistoryEvent("next")),["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(a.key)&&!(0,k.jK)(a.target)){var h=function(d,m){switch(m*=r.state.uiWindow.ratio,d){case"ArrowUp":v.top+=m;break;case"ArrowDown":v.top-=m;break;case"ArrowLeft":v.left-=m;break;case"ArrowRight":v.left+=m;break}v instanceof Z.fabric.ActiveSelection?v.getObjects().forEach(function(g){g.setCoords(),g.resizeScale()}):(v.setCoords(),v.resizeScale()),r.canvas.renderAll(),r.objectsToData(),r.updateHistory()},v=r.canvas.getActiveObject();if(!v)return;a.preventDefault(),h(a.key,2),t.moveTimeout&&clearTimeout(t.moveTimeout),t.moveTimer&&clearInterval(t.moveTimer),t.moveTimeout=setTimeout(function(){t.moveTimer=setInterval(function(){h(a.key,1)},500)},1500)}}),window.addEventListener("keyup",function(a){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(a.key)&&(clearTimeout(t.moveTimeout),clearInterval(t.moveTimer))}),this.canvas.on({"mouse:up":function(){for(var l=0,o=Object.keys(r.objects[r.state.frame]);l<o.length;l++){var c=o[l];r.objects[r.state.frame][c].resizeScale()}r.canvas.renderAll(),r.objectsToData(),r.updateHistory();var h=r.canvas.getActiveObject();setTimeout(function(){if(h)if(h instanceof Z.fabric.ActiveSelection){var v=h.getObjects().map(function(p){return p.id});r.select(v,!0)}else r.select([h.id]);else r.select([])},100)},"mouse:move":function(l){var o=t.canvas.getPointer(l.e),c=t.state.uiWindow.ratio,h=Math.round(o.x*c),v=Math.round(o.y*c),p=document.getElementById("coordinateDisplay");p.style.display="block",p.textContent="x: ".concat(h,", y: ").concat(v)},"mouse:out":function(){var l=document.getElementById("coordinateDisplay");l.style.display="none"}}),setTimeout(function(){var a=t.his.get();t.props.setCouldDo(a),ve(a.now,function(l,o){return t.onObjectEvent(l,o)},function(l){return r.onFrameEvent("change",l)},function(){return t.canvas.renderAll()}).then(function(){t.setRobotId(),t.resetCanvasSize()}),t.cancelHistoryUpdate()},50),setTimeout(function(){var a=t.his.get();t.props.setCouldDo(a),ve(a.now,function(l,o){return t.onObjectEvent(l,o)},function(l){return r.onFrameEvent("change",l)},function(){return t.canvas.renderAll()}).then(function(){t.setRobotId(),t.resetCanvasSize()}),t.cancelHistoryUpdate()},200),window.dispatch=function(a,l){t.onObjectEvent(a,l)}}},{key:"upload",value:function(t){var r=this,a=this,l=new FileReader;l.onload=function(){var o=j()(x()().mark(function c(h){return x()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,a.reset();case 2:return p.next=4,ve(JSON.parse(h.target.result),function(d,m){return a.onObjectEvent(d,m)},function(d){return a.onFrameEvent("change",d)},function(){return a.canvas.renderAll()}).then(function(){r.setRobotId()});case 4:a.objectsToData(),a.his.reset({version:2,data:r.data,selected:r.state.frame});case 6:case"end":return p.stop()}},c)}));return function(c){return o.apply(this,arguments)}}(),l.readAsText(t)}},{key:"objectsToData",value:function(){for(var t=this,r={},a=0,l=Object.keys(this.objects);a<l.length;a++){var o=l[a];r[o]={};for(var c=0,h=Object.keys(this.objects[o]);c<h.length;c++){var v=h[c],p=this.objects[o][v].toObject();r[o][p.id]=p}}if(this.data=r,this.setState({data:r[this.state.frame]}),this.state.selectedId.length===1){var d;this.state.selectedId[0]===-2?d=this.state.uiWindow:d=r[this.state.frame][this.state.selectedId[0]],this.setState({properties:W()({},d)},function(){var m;(m=t.propertiesRef.current)===null||m===void 0||m.reload()})}}},{key:"onObjectEvent",value:function(t,r){var a=this;function l(p){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m={id:p.id,name:p.name,layer:p.layer,group:p.group,type:p.type,ratio:a.state.uiWindow.ratio,team:a.state.uiWindow.team},g=lr(m);a.objects[a.state.frame][p.id]=g,d&&g.fromObject(p),g.setRatio(a.state.uiWindow.ratio);for(var M=a.canvas.getObjects(),C=!0,S=0,L=Object.keys(M);S<L.length;S++){var F=L[S];if(M[F].id===g.id){C=!1;break}}a.canvas.add(g)}if(t==="add")if(typeof r.id=="number"&&r.id>=0&&!this.objects[this.state.frame][r.id])l(r,!0);else return console.log("id exists",r.id,this.objects[this.state.frame][r.id]),"W: Adding Object ".concat(r.id," exists");else if(t==="_add")r.id=this.getNewDataId(),r.ratio=this.state.uiWindow.ratio,r.team=this.state.uiWindow.team,l(r,!1);else if(t==="update")if(this.objects[this.state.frame][r.id])this.objects[this.state.frame][r.id].fromObject(r);else return"E: Updating object ".concat(r.id," not exists");else if(t==="_update")r.id>=0&&this.objects[this.state.frame][r.id]?this.objects[this.state.frame][r.id].fromObject(r):l(r);else if(t==="remove"){var o=r.id;if(this.objects[this.state.frame][o])this.select([]),this.canvas.remove(this.objects[this.state.frame][o]),this.canvas.renderAll(),delete this.objects[this.state.frame][o],this.objectsToData();else return"E: Remove object ".concat(o," not exists")}else if(t==="setAttr")this.objects[this.state.frame][r.id]&&this.objects[this.state.frame][r.id].set(r.payload);else if(t==="removeLayer")for(var c=0,h=Object.keys(this.objects[this.state.frame]);c<h.length;c++){var v=h[c];this.objects[this.state.frame][v].layer===r.layer&&this.onObjectEvent("remove",{id:v})}else t==="removeAll"&&this.reset(!0);return this.objectsToData(),this.canvas.renderAll(),"S"}},{key:"setFrame",value:function(t){this.objects[t]||(this.objects[t]={});for(var r=0,a=Object.keys(this.objects[this.state.frame]);r<a.length;r++){var l=a[r];this.canvas.remove(this.objects[this.state.frame][l])}this.canvas.renderAll();var o=this;return new Promise(function(c,h){o.setState({frame:t},function(){for(var v=o.canvas.getObjects(),p=0,d=Object.keys(o.objects[o.state.frame]);p<d.length;p++){for(var m=d[p],g=!0,M=0,C=Object.keys(v);M<C.length;M++){var S=C[M];if(v[S].id===o.objects[o.state.frame][m].id){g=!1;break}}g&&o.canvas.add(o.objects[o.state.frame][m])}o.objectsToData(),o.select([]),o.canvas.renderAll(),c()})})}},{key:"onHistoryEvent",value:function(){var i=j()(x()().mark(function r(a){var l=this,o;return x()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(o=this.his.get(),a!=="update"){h.next=6;break}return this.updateHistory(),h.abrupt("return");case 6:if(a!=="reset"){h.next=12;break}return o=this.his.reset({version:2,data:{default:{}},selected:"default"}),this.props.setCouldDo(o),h.abrupt("return");case 12:if(a!=="resetNow"){h.next=16;break}return o=this.his.reset({version:2,data:this.data,selected:this.state.frame}),this.props.setCouldDo(o),h.abrupt("return");case 16:return a==="previous"?o=this.his.previous():a==="next"&&(o=this.his.next()),this.props.setCouldDo(o),h.next=20,this.reset(!0);case 20:return h.next=22,ve(o.now,function(v,p){return l.onObjectEvent(v,p)},function(v){return l.onFrameEvent("change",v)},function(){return l.canvas.renderAll()}).then(function(){l.setRobotId()});case 22:this.cancelHistoryUpdate(),this.props.setCouldDo(o);case 24:case"end":return h.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"onFrameEvent",value:function(){var i=j()(x()().mark(function r(a,l){var o,c,h,v,p,d;return x()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(a!=="add"){g.next=6;break}return this.objects[l]={},g.next=4,this.setFrame(l);case 4:g.next=40;break;case 6:if(a!=="remove"){g.next=19;break}if(Object.keys(this.objects).length!==1){g.next=10;break}return U.error("Cannot remove last frame!"),g.abrupt("return");case 10:if(o=l,this.state.frame!==l){g.next=16;break}return l=Object.keys(this.objects)[0],l===o&&(l=Object.keys(this.objects)[1]),g.next=16,this.setFrame(l);case 16:delete this.objects[o],g.next=40;break;case 19:if(a!=="change"){g.next=24;break}return g.next=22,this.setFrame(l);case 22:g.next=40;break;case 24:if(a!=="copy"){g.next=34;break}return this.objects[l]={},c=this.objects[this.state.frame],g.next=29,this.setFrame(l);case 29:for(h=0,v=Object.keys(c);h<v.length;h++)p=v[h],this.onObjectEvent("_update",c[p].toObject());this.objectsToData(),this.canvas.renderAll(),g.next=40;break;case 34:if(a!=="rename"){g.next=40;break}return d=this.state.frame,g.next=38,this.onFrameEvent("copy",l);case 38:return g.next=40,this.onFrameEvent("remove",d);case 40:this.props.onFrameChange({frames:Object.keys(this.objects),selected:l}),this.objectsToData(),this.updateHistory();case 43:case"end":return g.stop()}},r,this)}));function t(r,a){return i.apply(this,arguments)}return t}()},{key:"render",value:function(){var t,r=this;return(t=this.canvas)===null||t===void 0||t.renderAll(),(0,u.jsx)("div",{style:{width:"100vw",height:"calc(100% - 20px)",padding:10},children:(0,u.jsxs)(_.eh,{autoSaveId:"container_h",className:"container",direction:"horizontal",children:[(0,u.jsx)(_.s_,{defaultSize:25,minSize:15,maxSize:45,order:1,children:(0,u.jsxs)(_.eh,{autoSaveId:"card_v",className:"full",direction:"vertical",children:[(0,u.jsx)(_.s_,{defaultSize:50,minSize:25,maxSize:75,children:(0,u.jsx)(_t,{onSelect:function(l){return r.select(l)},onObjectEvent:function(l,o){return r.onObjectEvent(l,o)},onReset:function(){return r.reset()},data:this.state.data,editable:this.state.editable,selectedId:this.state.selectedId})}),(0,u.jsx)(_.OT,{className:"panel-resize-handle",style:{height:6}}),(0,u.jsx)(_.s_,{defaultSize:50,children:(0,u.jsx)($e.Z,{size:"small",title:"Properties",style:{height:"100%"},children:(0,u.jsxs)("div",{className:"card-body",children:[this.state.properties?(0,u.jsx)(Ge.vY,{dataSource:this.state.properties,columns:Ke(this.state.properties),ref:this.propertiesRef,editable:this.props.editable?{onSave:function(l,o){return r.onPropertiesChange(l,o)}}:null,column:1,style:{marginTop:4}},this.state.selectedId[0]):(0,u.jsx)(he.Z,{image:he.Z.PRESENTED_IMAGE_SIMPLE}),this.state.selectedId[0]===-2?(0,u.jsxs)(G.Z,{direction:"vertical",size:"middle",style:{display:"flex"},children:[(0,u.jsx)(z.ZP,{onClick:function(){return(0,k.cT)("image/*").then(function(l){r.setState({imageUploadShow:!1}),r.setBackground((0,k.lZ)(l))}).catch(function(l){})},children:"Upload Background"}),(0,u.jsx)(z.ZP,{onClick:function(){return r.setBackground(y(25665))},children:"Reset Background"})]}):(0,u.jsx)("div",{})]})})})]})}),(0,u.jsx)(_.OT,{className:"panel-resize-handle",style:{width:6}}),(0,u.jsx)(_.s_,{defaultSize:75,order:2,onResize:function(l){return setTimeout(function(){return r.resetCanvasSize()},100)},children:(0,u.jsxs)("div",{className:"full",ref:this.canvasRef,children:[(0,u.jsx)("canvas",{className:"full",id:"ui"}),(0,u.jsx)("div",{id:"coordinateDisplay",style:{bottom:0,right:0,display:"none",padding:"1px 6px 1px 6px"}})]})})]})})}}]),s}(I.Component),vr=fr,pr=y(13769),Ie=y.n(pr),pe=y(22997),mr=y(74330),me=y(85576),tt=y(92462),rt=y(553);function gr(){return Ae.apply(this,arguments)}function Ae(){return Ae=j()(x()().mark(function n(){var e,s,i,t,r,a,l,o,c,h,v,p,d;return x()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(0,k.UP)()){g.next=14;break}return g.next=3,(0,tt.Py)();case 3:if(e=g.sent,!e.manifest){g.next=11;break}return s=e.manifest.version.slice(1).split(".").map(Number),i=localStorage.getItem("version_ignored"),i||(i="v1.4.1"),t=i.slice(1).split(".").map(Number),r=s[0]>t[0]||s[1]>t[1]||s[2]>t[2],g.abrupt("return",{shouldUpdate:r,manifest:e.manifest});case 11:return g.abrupt("return",e);case 14:return a=Date.now(),g.next=17,fetch("https://ui.bismarck.xyz/update.json?".concat(a));case 17:return l=g.sent,g.next=20,l.json();case 20:return o=g.sent,c=o.notes,h=o.version.slice(1).split(".").map(Number),v=localStorage.getItem("version_ignored"),v||(v="v1.4.1"),p=v.slice(1).split(".").map(Number),d=h[0]>p[0]||h[1]>p[1]||h[2]>p[2],g.abrupt("return",{shouldUpdate:d,manifest:{body:c,version:o.version}});case 28:case"end":return g.stop()}},n)})),Ae.apply(this,arguments)}function yr(){return Te.apply(this,arguments)}function Te(){return Te=j()(x()().mark(function n(){return x()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(0,k.UP)()){s.next=6;break}return s.next=3,(0,tt.F_)();case 3:return s.abrupt("return",s.sent);case 6:window.location.reload();case 7:case"end":return s.stop()}},n)})),Te.apply(this,arguments)}var De={checkUpdate:gr,installUpdate:yr,relaunch:rt.R},Ee=y(21798),xr=["node"],br=De.checkUpdate,Mr=De.installUpdate,kr=De.relaunch,wr=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{step:0,content:"",version:""}),i}return T()(s,[{key:"handleClose",value:function(){this.setState({step:0})}},{key:"handleOk",value:function(){var i=j()(x()().mark(function r(){return x()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,this.setState({step:2}),l.next=4,Mr();case 4:if(l.t0=!(0,k.UP)(),l.t0){l.next=9;break}return l.next=8,kr();case 8:l.t0=!l.sent;case 9:if(!l.t0){l.next=11;break}this.setState({step:3});case 11:l.next=16;break;case 13:l.prev=13,l.t1=l.catch(0),this.setState({step:-1});case 16:case"end":return l.stop()}},r,this,[[0,13]])}));function t(){return i.apply(this,arguments)}return t}()},{key:"check",value:function(){var t=this;if((0,k.Hn)())(0,k.UP)()||j()(x()().mark(function l(){var o,c;return x()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,fetch("/nightly/version?timestamp=".concat(new Date().getTime()));case 3:if(o=v.sent,o.status!==404){v.next=8;break}return U.error("There is no nightly version now."),setTimeout(function(){window.location.href="/"},2e3),v.abrupt("return");case 8:return v.next=10,o.text();case 10:c=v.sent,c.trim().slice(0,7)!=="v1.4.1".slice(8)&&(t.setState({step:2}),setTimeout(j()(x()().mark(function p(){var d,m;return x()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,fetch("/nightly/version?timestamp=".concat(new Date().getTime()));case 2:return d=M.sent,M.next=5,d.text();case 5:m=M.sent,m.trim()==="no"?window.location.href="/":window.location.reload();case 7:case"end":return M.stop()}},p)})),3e3)),v.next=17;break;case 14:v.prev=14,v.t0=v.catch(0),U.warning("Failed to check nightly version.");case 17:case"end":return v.stop()}},l,null,[[0,14]])}))();else{var r=/(https:\/\/github\.com\/bismarckkk\/RM-UI-Designer\/pull\/)(\d+)/g,a=/(https:\/\/github\.com\/bismarckkk\/RM-UI-Designer\/compare\/)(v\d+\.\d+\.\d+\.\.\.v\d+\.\d+\.\d+)/g;j()(x()().mark(function l(){var o,c,h;return x()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,p.next=3,br();case 3:o=p.sent,c=o.shouldUpdate,h=o.manifest,c&&t.setState({step:1,content:h.body.replace(r,function(d,m,g){return"[#".concat(g,"](").concat(m).concat(g,")")}).replace(a,function(d,m,g){return"[#".concat(g,"](").concat(m).concat(g,")")}),version:h.version}),p.next=12;break;case 9:p.prev=9,p.t0=p.catch(0),U.warning("Failed to check update.");case 12:case"end":return p.stop()}},l,null,[[0,9]])}))()}}},{key:"ignore",value:function(){localStorage.setItem("version_ignored",this.state.version),this.handleClose()}},{key:"componentDidMount",value:function(){this.check()}},{key:"render",value:function(){var t=(0,u.jsx)("div",{});return this.state.step===-1?t=(0,u.jsx)(pe.ZP,{status:"error",title:"Update Failed"}):this.state.step===1?t=(0,u.jsx)(Ee.U,{components:{a:function(a){var l=a.node,o=Ie()(a,xr);return(0,u.jsx)("a",W()(W()({},o),{},{target:"_blank"}))}},children:this.state.content}):this.state.step===2?t=(0,u.jsx)("div",{style:{padding:40,textAlign:"center",color:"var(--ant-color-text)"},children:(0,u.jsxs)(G.Z,{direction:"vertical",children:[(0,u.jsx)(mr.Z,{size:"large"}),(0,u.jsx)("h3",{children:"Updating..."})]})}):this.state.step===3&&(t=(0,u.jsx)(pe.ZP,{status:"success",title:"Update Success",subTitle:"Please restart the app to apply the update."})),(0,u.jsx)(me.Z,{title:"Auto Update",open:this.state.step,closable:this.state.step>1,maskClosable:this.state.step>1,zIndex:2100,footer:this.state.step===1?(0,u.jsxs)(G.Z,{children:[(0,u.jsx)(z.ZP,{onClick:this.ignore.bind(this),children:"Ignore"}),(0,u.jsx)(z.ZP,{onClick:this.handleClose.bind(this),children:"Cancel"}),(0,u.jsx)(z.ZP,{type:"primary",onClick:this.handleOk.bind(this),children:"Update"})]}):null,children:t})}}]),s}(I.Component),Sr=wr,Oe=y(40249),jr=["node"],zr=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{open:!1,content:null}),i}return T()(s,[{key:"componentDidMount",value:function(){var t=this,r=localStorage.getItem("eula");(!r||!JSON.parse(r))&&(this.setState({open:!0}),fetch(y(19293)).then(function(a){return a.text()}).then(function(a){t.setState({content:a})}))}},{key:"dontShow",value:function(){localStorage.setItem("eula","true"),this.setState({open:!1})}},{key:"render",value:function(){var t=this;return(0,u.jsx)(me.Z,{title:"Welcome to RM UI Designer!",onOk:function(){return t.setState({open:!1})},onCancel:function(){return t.setState({open:!1})},footer:(0,u.jsxs)(G.Z,{children:[(0,u.jsx)(z.ZP,{onClick:this.dontShow.bind(this),children:"Don't show"}),(0,u.jsx)(z.ZP,{type:"primary",onClick:function(){return t.setState({open:!1})},children:"OK"})]}),open:this.state.open,zIndex:2200,children:this.state.content?(0,u.jsx)(Ee.U,{components:{a:function(a){var l=a.node,o=Ie()(a,jr);return(0,u.jsx)("a",W()(W()({},o),{},{target:"_blank"}))}},children:this.state.content}):(0,u.jsx)(Oe.Z,{})})}}]),s}(I.Component),Cr=zr,Ir=y(40411),at=y(8791),Ar=y(28100),Tr=y(1944),Dr=y(39104),Er=y(37388),Or=y(73475),it=y(16165),st=y(49333),Nr=y(47745),Fr=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{title:"",open:!1,frames:[]}),b()(w()(i),"promise",null),i}return T()(s,[{key:"open",value:function(t,r){var a=this;return new Promise(function(l,o){a.setState({title:t,open:!0,frames:r}),a.promise&&a.promise.reject(),a.promise={resolve:l,reject:o}})}},{key:"render",value:function(){var t=this;return(0,u.jsx)(st.Y,{title:this.state.title,autoFocusFirstInput:!0,width:240,open:this.state.open,onOpenChange:function(a){t.promise&&!a&&t.state.open&&t.promise.reject(),t.setState({open:a})},onFinish:function(){var r=j()(x()().mark(function a(l){return x()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t.promise.resolve(l.frame),t.promise=null,c.abrupt("return",!0);case 3:case"end":return c.stop()}},a)}));return function(a){return r.apply(this,arguments)}}(),children:(0,u.jsx)(Nr.Z,{name:"frame",label:"New Frame Name",width:"sm",rules:[{required:!0,message:"Please input frame name!"},function(r){var a=r.getFieldValue,l=t;return{validator:function(c,h){{var v=!0,p=a("frame"),d=O()(l.state.frames),m;try{for(d.s();!(m=d.n()).done;){var g=m.value;if(g===p){v=!1;break}}}catch(M){d.e(M)}finally{d.f()}return v?Promise.resolve():Promise.reject(new Error("Cannot create same name frame!"))}}}}]})})}}]),s}(I.Component),Rr=Fr,Lr=["node"],Ur=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{open:!1,content:null}),i}return T()(s,[{key:"show",value:function(){this.setState({open:!0})}},{key:"componentDidMount",value:function(){var t=this;fetch(y(99734)).then(function(r){return r.text()}).then(function(r){t.setState({content:r})})}},{key:"render",value:function(){var t=this;return(0,u.jsx)(me.Z,{title:"About",onOk:function(){return t.setState({open:!1})},onCancel:function(){return t.setState({open:!1})},footer:null,open:this.state.open,children:this.state.content?(0,u.jsx)(Ee.U,{components:{a:function(a){var l=a.node,o=Ie()(a,Lr);return(0,u.jsx)("a",W()(W()({},o),{},{target:"_blank"}))}},children:this.state.content}):(0,u.jsx)(Oe.Z,{})})}}]),s}(I.Component),Zr=Ur,ie=y(96074),Hr=y(5574),Pr=y.n(Hr),ge=y(17990),nt=function(){function n(e){A()(this,n),b()(this,"getContentFunc",void 0),b()(this,"fileHandle",void 0),b()(this,"timerId",void 0),b()(this,"updateTimerId",void 0),this.getContentFunc=e,this.fileHandle=null,this.timerId=null,this.updateTimerId=null}return T()(n,[{key:"open",value:function(){var e=j()(x()().mark(function i(){var t,r,a,l,o;return x()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.fileHandle=null,h.prev=1,!(0,k.UP)()){h.next=9;break}return h.next=5,ge.WZ.open({multiple:!1,directory:!1,filters:[{name:"rmui file",extensions:["json","rmui"]}]});case 5:t=h.sent,t!==null&&t.length>0&&typeof t=="string"&&(this.fileHandle=t.replace(/\\/g,"/"),r=this.fileHandle.split("/").pop(),document.title="".concat(r," - RM UI Designer")),h.next=18;break;case 9:return h.next=11,window.showOpenFilePicker({types:[{description:"rmui file",accept:{"application/json":[".json",".rmui"]}}]});case 11:return a=h.sent,l=Pr()(a,1),this.fileHandle=l[0],h.next=16,this.fileHandle.getFile();case 16:o=h.sent.name,document.title="".concat(o," - RM UI Designer");case 18:this.enableAutoSave(),h.next=23;break;case 21:h.prev=21,h.t0=h.catch(1);case 23:return h.abrupt("return",this.fileHandle!==null);case 24:case"end":return h.stop()}},i,this,[[1,21]])}));function s(){return e.apply(this,arguments)}return s}()},{key:"create",value:function(){var e=j()(x()().mark(function i(){var t,r,a;return x()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.fileHandle=null,o.prev=1,!(0,k.UP)()){o.next=9;break}return o.next=5,ge.WZ.save({filters:[{name:"rmui file",extensions:["rmui"]}]});case 5:t=o.sent,t!==null&&(this.fileHandle=t.replace(/\\/g,"/"),r=this.fileHandle.split("/").pop(),document.title="".concat(r," - RM UI Designer")),o.next=16;break;case 9:return o.next=11,window.showSaveFilePicker({types:[{description:"rmui file",accept:{"application/json":[".rmui"]}}]});case 11:return this.fileHandle=o.sent,o.next=14,this.fileHandle.getFile();case 14:a=o.sent.name,document.title="".concat(a," - RM UI Designer");case 16:return o.next=18,this.write(JSON.stringify({version:2,data:{default:{}},selected:"default"}));case 18:this.enableAutoSave(),o.next=23;break;case 21:o.prev=21,o.t0=o.catch(1);case 23:return o.abrupt("return",this.fileHandle!==null);case 24:case"end":return o.stop()}},i,this,[[1,21]])}));function s(){return e.apply(this,arguments)}return s}()},{key:"enableAutoSave",value:function(){var s=this;this.timerId=setInterval(j()(x()().mark(function i(){var t;return x()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=s.getContentFunc(),a.next=3,s.write(t);case 3:case"end":return a.stop()}},i)})),6e4),U.success("Auto save enabled")}},{key:"disableAutoSave",value:function(){var e=j()(x()().mark(function i(){return x()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.save();case 2:this.timerId&&(clearInterval(this.timerId),this.timerId=null),this.updateTimerId&&(clearTimeout(this.updateTimerId),this.updateTimerId=null),U.warning("Auto save disabled");case 5:case"end":return r.stop()}},i,this)}));function s(){return e.apply(this,arguments)}return s}()},{key:"update",value:function(){var s=this;this.timerId!==null&&(this.updateTimerId!==null&&(clearTimeout(this.updateTimerId),this.updateTimerId=null),this.updateTimerId=setTimeout(j()(x()().mark(function i(){var t;return x()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=s.getContentFunc(),a.next=3,s.write(t);case 3:case"end":return a.stop()}},i)})),2e3))}},{key:"save",value:function(){var e=j()(x()().mark(function i(){var t;return x()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=this.getContentFunc(),a.next=3,this.write(t);case 3:case"end":return a.stop()}},i,this)}));function s(){return e.apply(this,arguments)}return s}()},{key:"write",value:function(){var e=j()(x()().mark(function i(t){var r;return x()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.fileHandle){l.next=2;break}throw new Error("File is not open");case 2:if(typeof this.fileHandle!="string"){l.next=7;break}return l.next=5,ge.fs.writeTextFile(this.fileHandle,t);case 5:l.next=14;break;case 7:return l.next=9,this.fileHandle.createWritable();case 9:return r=l.sent,l.next=12,r.write(t);case 12:return l.next=14,r.close();case 14:case"end":return l.stop()}},i,this)}));function s(i){return e.apply(this,arguments)}return s}()},{key:"read",value:function(){var e=j()(x()().mark(function i(){var t,r;return x()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.fileHandle){l.next=2;break}throw new Error("File is not open");case 2:if(typeof this.fileHandle!="string"){l.next=10;break}return l.next=5,ge.fs.readTextFile(this.fileHandle);case 5:return t=l.sent,r=new Blob([t],{type:"text/plain;charset=utf-8"}),l.abrupt("return",new File([r],this.fileHandle));case 10:return l.next=12,this.fileHandle.getFile();case 12:return l.abrupt("return",l.sent);case 13:case"end":return l.stop()}},i,this)}));function s(){return e.apply(this,arguments)}return s}()}]),n}();function Br(){return"showOpenFilePicker"in window||(0,k.UP)()}var Wr=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{title:"",open:!1,frames:[]}),b()(w()(i),"promise",null),i}return T()(s,[{key:"open",value:function(){var t=this;return new Promise(function(r,a){t.setState({open:!0}),t.promise&&t.promise.reject(),t.promise={resolve:r,reject:a}})}},{key:"onClick",value:function(t){this.setState({open:!1}),this.promise.resolve(t),this.promise=null}},{key:"render",value:function(){var t=this,r=Br();return(0,u.jsx)(me.Z,{footer:null,maskClosable:!1,closeIcon:null,zIndex:2050,open:this.state.open,children:(0,u.jsxs)(G.Z,{direction:"vertical",size:"middle",style:{width:"100%",padding:15},children:[(0,u.jsx)(z.ZP,{type:"primary",disabled:!r,style:{width:"100%"},size:"large",onClick:function(){return t.onClick("new")},children:"New Project"}),(0,u.jsx)(z.ZP,{type:"primary",disabled:!r,style:{width:"100%"},size:"large",onClick:function(){return t.onClick("open")},children:"Open Exist"}),(0,u.jsx)(ie.Z,{}),(0,u.jsx)(z.ZP,{type:"primary",style:{width:"100%"},size:"large",onClick:function(){return t.onClick("use")},children:"Temporary Use"})]})})}}]),s}(I.Component),Yr=Wr,$r=Object.defineProperty,lt=Object.getOwnPropertySymbols,Gr=Object.prototype.hasOwnProperty,Qr=Object.prototype.propertyIsEnumerable,ot=(n,e,s)=>e in n?$r(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,Vr=(n,e)=>{for(var s in e||(e={}))Gr.call(e,s)&&ot(n,s,e[s]);if(lt)for(var s of lt(e))Qr.call(e,s)&&ot(n,s,e[s]);return n};const Jr=n=>I.createElement("svg",Vr({className:"moon_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},n),I.createElement("path",{d:"M472 991.6c-157 0-304.4-77.2-394.3-206.6-6.9-9.9-7.6-22.9-1.8-33.6 5.8-10.7 17.1-17.8 29.2-16.7l7.7.4c2.4.2 4.8.3 7.2.3 229.4 0 416-186.6 416-416 0-85-25.7-167-74.3-236.9-6.9-9.9-7.6-22.9-1.8-33.6 5.8-10.7 17.2-17.6 29.2-16.7C748.7 41.6 952 252.1 952 511.6c0 264.7-215.3 480-480 480zM169.7 797.1c78.1 82.7 187.2 130.6 302.3 130.6 229.4 0 416-186.6 416-416 0-204-144.9-373-339.7-408.6 34 66.9 51.7 140.7 51.7 216.6 0 247.8-188.9 452.4-430.3 477.4z",fill:"#2c2c2c"}));var ci="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTQ3MiA5OTEuNmMtMTU3IDAtMzA0LjQtNzcuMi0zOTQuMy0yMDYuNi02LjktOS45LTcuNi0yMi45LTEuOC0zMy42IDUuOC0xMC43IDE3LjEtMTcuOCAyOS4yLTE2LjdsNy43LjRjMi40LjIgNC44LjMgNy4yLjMgMjI5LjQgMCA0MTYtMTg2LjYgNDE2LTQxNiAwLTg1LTI1LjctMTY3LTc0LjMtMjM2LjktNi45LTkuOS03LjYtMjIuOS0xLjgtMzMuNiA1LjgtMTAuNyAxNy4yLTE3LjYgMjkuMi0xNi43Qzc0OC43IDQxLjYgOTUyIDI1Mi4xIDk1MiA1MTEuNmMwIDI2NC43LTIxNS4zIDQ4MC00ODAgNDgwek0xNjkuNyA3OTcuMWM3OC4xIDgyLjcgMTg3LjIgMTMwLjYgMzAyLjMgMTMwLjYgMjI5LjQgMCA0MTYtMTg2LjYgNDE2LTQxNiAwLTIwNC0xNDQuOS0zNzMtMzM5LjctNDA4LjYgMzQgNjYuOSA1MS43IDE0MC43IDUxLjcgMjE2LjYgMCAyNDcuOC0xODguOSA0NTIuNC00MzAuMyA0NzcuNHoiIGZpbGw9IiMyYzJjMmMiLz48L3N2Zz4=",Kr=Object.defineProperty,ut=Object.getOwnPropertySymbols,Xr=Object.prototype.hasOwnProperty,qr=Object.prototype.propertyIsEnumerable,ct=(n,e,s)=>e in n?Kr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,_r=(n,e)=>{for(var s in e||(e={}))Xr.call(e,s)&&ct(n,s,e[s]);if(ut)for(var s of ut(e))qr.call(e,s)&&ct(n,s,e[s]);return n};const ea=n=>I.createElement("svg",_r({className:"sun_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},n),I.createElement("path",{d:"M522.88 874.667A21.333 21.333 0 0 1 544.213 896v85.333a21.333 21.333 0 0 1-21.333 21.334h-21.333a21.333 21.333 0 0 1-21.334-21.334V896a21.333 21.333 0 0 1 21.334-21.333h21.333zm268.416-107.52 60.352 60.352a21.333 21.333 0 0 1 0 30.165l-15.083 15.083a21.333 21.333 0 0 1-30.186 0l-60.331-60.352a21.333 21.333 0 0 1 0-30.166l15.083-15.082a21.333 21.333 0 0 1 30.165 0zm-527.957 0 15.082 15.082a21.333 21.333 0 0 1 0 30.166l-60.352 60.352a21.333 21.333 0 0 1-30.165 0l-15.083-15.083a21.333 21.333 0 0 1 0-30.165l60.331-60.352a21.333 21.333 0 0 1 30.187 0zM512 277.333c141.376 0 256 114.624 256 256s-114.624 256-256 256-256-114.624-256-256 114.624-256 256-256zm0 64a192 192 0 1 0 0 384 192 192 0 0 0 0-384zm448.213 160a21.333 21.333 0 0 1 21.334 21.334V544a21.333 21.333 0 0 1-21.334 21.333H874.88A21.333 21.333 0 0 1 853.547 544v-21.333a21.333 21.333 0 0 1 21.333-21.334h85.333zm-810.666 0a21.333 21.333 0 0 1 21.333 21.334V544a21.333 21.333 0 0 1-21.333 21.333H64.213A21.333 21.333 0 0 1 42.88 544v-21.333a21.333 21.333 0 0 1 21.333-21.334h85.334zm687.04-307.413 15.082 15.083a21.333 21.333 0 0 1 0 30.165l-60.352 60.352a21.333 21.333 0 0 1-30.165 0l-15.083-15.083a21.333 21.333 0 0 1 0-30.165L806.4 193.92a21.333 21.333 0 0 1 30.187 0zm-618.496 0 60.352 60.352a21.333 21.333 0 0 1 0 30.165L263.36 299.52a21.333 21.333 0 0 1-30.187 0l-60.352-60.373a21.333 21.333 0 0 1 0-30.166l15.083-15.082a21.333 21.333 0 0 1 30.165 0zM522.9 64a21.333 21.333 0 0 1 21.334 21.333v85.334A21.333 21.333 0 0 1 522.9 192h-21.333a21.333 21.333 0 0 1-21.333-21.333V85.333A21.333 21.333 0 0 1 501.568 64h21.333z",fill:"#ebebeb"}));var hi="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTUyMi44OCA4NzQuNjY3QTIxLjMzMyAyMS4zMzMgMCAwIDEgNTQ0LjIxMyA4OTZ2ODUuMzMzYTIxLjMzMyAyMS4zMzMgMCAwIDEtMjEuMzMzIDIxLjMzNGgtMjEuMzMzYTIxLjMzMyAyMS4zMzMgMCAwIDEtMjEuMzM0LTIxLjMzNFY4OTZhMjEuMzMzIDIxLjMzMyAwIDAgMSAyMS4zMzQtMjEuMzMzaDIxLjMzM3ptMjY4LjQxNi0xMDcuNTIgNjAuMzUyIDYwLjM1MmEyMS4zMzMgMjEuMzMzIDAgMCAxIDAgMzAuMTY1bC0xNS4wODMgMTUuMDgzYTIxLjMzMyAyMS4zMzMgMCAwIDEtMzAuMTg2IDBsLTYwLjMzMS02MC4zNTJhMjEuMzMzIDIxLjMzMyAwIDAgMSAwLTMwLjE2NmwxNS4wODMtMTUuMDgyYTIxLjMzMyAyMS4zMzMgMCAwIDEgMzAuMTY1IDB6bS01MjcuOTU3IDAgMTUuMDgyIDE1LjA4MmEyMS4zMzMgMjEuMzMzIDAgMCAxIDAgMzAuMTY2bC02MC4zNTIgNjAuMzUyYTIxLjMzMyAyMS4zMzMgMCAwIDEtMzAuMTY1IDBsLTE1LjA4My0xNS4wODNhMjEuMzMzIDIxLjMzMyAwIDAgMSAwLTMwLjE2NWw2MC4zMzEtNjAuMzUyYTIxLjMzMyAyMS4zMzMgMCAwIDEgMzAuMTg3IDB6TTUxMiAyNzcuMzMzYzE0MS4zNzYgMCAyNTYgMTE0LjYyNCAyNTYgMjU2cy0xMTQuNjI0IDI1Ni0yNTYgMjU2LTI1Ni0xMTQuNjI0LTI1Ni0yNTYgMTE0LjYyNC0yNTYgMjU2LTI1NnptMCA2NGExOTIgMTkyIDAgMSAwIDAgMzg0IDE5MiAxOTIgMCAwIDAgMC0zODR6bTQ0OC4yMTMgMTYwYTIxLjMzMyAyMS4zMzMgMCAwIDEgMjEuMzM0IDIxLjMzNFY1NDRhMjEuMzMzIDIxLjMzMyAwIDAgMS0yMS4zMzQgMjEuMzMzSDg3NC44OEEyMS4zMzMgMjEuMzMzIDAgMCAxIDg1My41NDcgNTQ0di0yMS4zMzNhMjEuMzMzIDIxLjMzMyAwIDAgMSAyMS4zMzMtMjEuMzM0aDg1LjMzM3ptLTgxMC42NjYgMGEyMS4zMzMgMjEuMzMzIDAgMCAxIDIxLjMzMyAyMS4zMzRWNTQ0YTIxLjMzMyAyMS4zMzMgMCAwIDEtMjEuMzMzIDIxLjMzM0g2NC4yMTNBMjEuMzMzIDIxLjMzMyAwIDAgMSA0Mi44OCA1NDR2LTIxLjMzM2EyMS4zMzMgMjEuMzMzIDAgMCAxIDIxLjMzMy0yMS4zMzRoODUuMzM0em02ODcuMDQtMzA3LjQxMyAxNS4wODIgMTUuMDgzYTIxLjMzMyAyMS4zMzMgMCAwIDEgMCAzMC4xNjVsLTYwLjM1MiA2MC4zNTJhMjEuMzMzIDIxLjMzMyAwIDAgMS0zMC4xNjUgMGwtMTUuMDgzLTE1LjA4M2EyMS4zMzMgMjEuMzMzIDAgMCAxIDAtMzAuMTY1TDgwNi40IDE5My45MmEyMS4zMzMgMjEuMzMzIDAgMCAxIDMwLjE4NyAwem0tNjE4LjQ5NiAwIDYwLjM1MiA2MC4zNTJhMjEuMzMzIDIxLjMzMyAwIDAgMSAwIDMwLjE2NUwyNjMuMzYgMjk5LjUyYTIxLjMzMyAyMS4zMzMgMCAwIDEtMzAuMTg3IDBsLTYwLjM1Mi02MC4zNzNhMjEuMzMzIDIxLjMzMyAwIDAgMSAwLTMwLjE2NmwxNS4wODMtMTUuMDgyYTIxLjMzMyAyMS4zMzMgMCAwIDEgMzAuMTY1IDB6TTUyMi45IDY0YTIxLjMzMyAyMS4zMzMgMCAwIDEgMjEuMzM0IDIxLjMzM3Y4NS4zMzRBMjEuMzMzIDIxLjMzMyAwIDAgMSA1MjIuOSAxOTJoLTIxLjMzM2EyMS4zMzMgMjEuMzMzIDAgMCAxLTIxLjMzMy0yMS4zMzNWODUuMzMzQTIxLjMzMyAyMS4zMzMgMCAwIDEgNTAxLjU2OCA2NGgyMS4zMzN6IiBmaWxsPSIjZWJlYmViIi8+PC9zdmc+",se=y(25641),ta=[1152e3,1e6,921600,576e3,5e5,460800,230400,115200,74800,57600,38400,19200,9600,4800],ra=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{open:!1,defaultOptions:{}}),b()(w()(i),"promise",null),i}return T()(s,[{key:"getOptions",value:function(t){var r=this;return new Promise(function(a,l){r.setState({open:!0,defaultOptions:t}),r.promise&&r.promise.reject(),r.promise={resolve:a,reject:l}})}},{key:"onFinish",value:function(){var i=j()(x()().mark(function r(a){return x()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.promise.resolve(a),this.promise=null,o.abrupt("return",!0);case 3:case"end":return o.stop()}},r,this)}));function t(r){return i.apply(this,arguments)}return t}()},{key:"render",value:function(){var t=this;return(0,u.jsxs)(st.Y,{title:"Serial",width:400,open:this.state.open,onOpenChange:function(a){return t.setState({open:a})},onFinish:function(){var r=j()(x()().mark(function a(l){return x()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.onFinish(l);case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},a)}));return function(a){return r.apply(this,arguments)}}(),children:[(0,u.jsx)(se.Z,{name:"baudRate",label:"Baud Rate",width:"sm",initialValue:this.state.defaultOptions.baudRate,options:ta.map(function(r){return{value:r,label:r.toString()}}),rules:[{required:!0}]}),(0,u.jsx)(se.Z,{name:"dataBits",label:"Data Bits",width:"sm",initialValue:this.state.defaultOptions.dataBits,options:[{value:8,label:"8"},{value:7,label:"7"}],rules:[{required:!0}]}),(0,u.jsx)(se.Z,{name:"stopBits",label:"Stop Bits",width:"sm",initialValue:this.state.defaultOptions.stopBits,options:[{value:1,label:"1"},{value:2,label:"2"}],rules:[{required:!0}]}),(0,u.jsx)(se.Z,{name:"parity",label:"Parity",width:"sm",initialValue:this.state.defaultOptions.parity,options:[{value:"none",label:"None"},{value:"even",label:"Even"},{value:"odd",label:"Odd"}],rules:[{required:!0}]}),(0,u.jsx)(se.Z,{name:"flowControl",label:"Flow Control",width:"sm",initialValue:this.state.defaultOptions.flowControl,options:[{value:"none",label:"None"},{value:"hardware",label:"Hardware"}],rules:[{required:!0}]})]})}}]),s}(I.Component),aa=ra,ye=y(2487),xe=y(42477),ht=y(78977),dt=y(97309),ia=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{show:!1,errors:[]}),i}return T()(s,[{key:"onClose",value:function(){this.setState({show:!1})}},{key:"show",value:function(t){this.setState({show:!0,errors:t})}},{key:"render",value:function(){var t=this,r=this.state.errors.filter(function(o){return o.level==="warn"}),a=this.state.errors.filter(function(o){return o.level==="error"}),l=(0,u.jsx)(pe.ZP,{status:"success",title:"0 error, 0 warning!",style:{marginTop:"50px"}});return a.length+r.length>0&&(l=(0,u.jsxs)("div",{style:{color:"var(--ant-color-text)",height:"100%"},children:[(0,u.jsxs)("p",{children:["Logged ",a.length," errors, ",r.length," warnings."]}),(0,u.jsx)("div",{style:{paddingBottom:10},className:"card-body",children:(0,u.jsx)(ye.Z,{bordered:!0,dataSource:this.state.errors,renderItem:function(c){return(0,u.jsx)(ye.Z.Item,{children:(0,u.jsxs)(G.Z,{size:"middle",children:[c.level==="warn"?(0,u.jsx)(ht.Z,{}):(0,u.jsx)(dt.Z,{}),"".concat(c.time.toLocaleTimeString(),": ").concat(c.message)]})})}})})]})),(0,u.jsx)(xe.Z,{title:"Serial Debug Log",placement:"right",onClose:function(){return t.onClose()},open:this.state.show,size:"large",getContainer:document.getElementById("content-in"),rootStyle:{inset:"25px 0 0 0"},style:{borderTop:"3px var(--ant-line-type) var(--ant-color-split)"},children:(0,u.jsx)("div",{style:{width:"100%",height:"calc(100% - 25px)"},children:l})})}}]),s}(I.Component),sa=ia,Ne=y(66309),na=y(55241),la=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];function ne(n){for(var e=255,s=0,i,t=n.byteLength;t--;)i=e^n[s],e=la[i],s++;return e}var oa=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];function le(n){for(var e=65535,s,i=0,t=n.byteLength;t--;)s=n[i],e=e>>8^oa[(e^s)&255],i++;return e}var ae=["UiLine","UiRect","UiRound","UiEllipse","UiArc","UiFloat","UiNumber","UiText"],Fe=["main","yellow","green","orange","purple","pink","cyan","black","white"],Re=["null","add","update","remove"],ft={257:1,258:2,259:5,260:7},ua=["null","removeLayer","removeAll"];function Le(n,e){return n[e]|n[e+1]<<8}function Ue(n,e){return n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24}function vt(n){var e=0,s=n[e++],i=n[e++],t="".concat(s,"-").concat(i),r=n[e++]|i<<8|s<<16,a=Ue(n,e);e+=4;var l=a&7,o=a>>3&7,c=a>>6&15,h=a>>10&15,v=a>>14&511,p=a>>23&511,d=Ue(n,e);e+=4;var m=d&1023,g=d>>10&2047,M=d>>21&2047,C=Ue(n,e),S=C&1023,L=C>>10&2047,F=C>>21&2047;return{group:t,id:r,operate_tpyel:l,figure_tpye:o,layer:c,color:h,_a:v,_b:p,width:m,start_x:g,start_y:M,_c:S,_d:L,_e:F,number:C}}function pt(n){var e=Le(n,0),s=Le(n,2),i=Le(n,4),t=[];if(e===256)t.push({type:ua[n[6]],obj:{layer:n[7]}});else if(e===272){var r=vt(n.subarray(6,21)),a=String.fromCharCode.apply(String,N()(n.subarray(21,21+r._b)));t.push({type:Re[r.operate_tpyel],obj:{layer:r.layer,group:r.group,type:ae[r.figure_tpye],id:r.id,name:"".concat(ae[r.figure_tpye],"_").concat(r.id&255),color:Fe[r.color],lineWidth:r.width,x:r.start_x,y:r.start_y,fontSize:r._a,text:a,_start:6,_end:n.length}})}else if(e in ft)for(var l=ft[e],o=0;o<l;o++){var c=vt(n.subarray(6+o*15,6+(o+1)*15)),h={layer:c.layer,group:c.group,type:ae[c.figure_tpye],id:c.id,name:"".concat(ae[c.figure_tpye],"_").concat(c.id&255),color:Fe[c.color],lineWidth:c.width,x:c.start_x,y:c.start_y,_start:6+o*15,_end:6+(o+1)*15};switch(ae[c.figure_tpye].slice(2)){case"Line":h.x2=c._d,h.y2=c._e;break;case"Rect":h.width=c._d-c.start_x,h.height=c._e-c.start_y;break;case"Round":h.r=c._c;break;case"Ellipse":h.rx=c._d,h.ry=c._e;break;case"Arc":h.startAngle=c._a,h.endAngle=c._b,h.rx=c._d,h.ry=c._e;break;case"Float":h.fontSize=c._a,h.float=c.number/1e3;break;case"Number":h.fontSize=c._a,h.number=c.number;break}t.push({type:Re[c.operate_tpyel],obj:h})}else console.log("unknown sub_id",e);return{sender:s,receiver:i,sub_id:e,events:t}}function ca(n){var e=[8,21,36,81,111,51];if(n[0]!==165)return{code:1,error:"Message must start with 0xA5",loc:[0]};if(n.length<7)return{code:2,error:"Message length must be at least 7 bytes",loc:[0]};var s=n[1]|n[2]<<8,i=n[3],t=n[4],r=n[5]|n[6]<<8,a=n.subarray(0,4);if(ne(a)!==t)return{code:3,error:"crc8 error, calc: 0x".concat(ne(a).toString(16),", msg: 0x").concat(t.toString(16)),loc:[4]};if(r!==769)return{code:4,error:"cmd_id 0x".concat(r.toString(16)," not match"),loc:[5,6]};if(!e.includes(s))return{code:5,error:"length error, length: ".concat(s),loc:[1,2]};if(n.length<6+s+2)return{code:6,error:"Message is not complete",loc:[n.length-1]};var l=n[7+s]|n[8+s]<<8;return le(n.subarray(0,7+s))!==l?{code:7,error:"crc16 error, calc: 0x".concat(le(n.subarray(0,7+s)).toString(16),", msg: 0x").concat(l.toString(16)),loc:[7+s,8+s],header:{length:s,seq:i,cmd_id:r}}:{code:0,msg:n.subarray(7+s+2),header:{length:s,seq:i,cmd_id:r}}}var ha=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{show:!1,history:{rx:0,log:[],start:-1}}),i}return T()(s,[{key:"onClose",value:function(){this.setState({show:!1})}},{key:"show",value:function(t){this.setState({show:!0,history:W()(W()({},t),{},{start:-1})})}},{key:"save",value:function(){var t="",r=O()(this.state.history.log),a;try{for(r.s();!(a=r.n()).done;){var l=a.value,o=O()(l),c;try{for(o.s();!(c=o.n()).done;){var h=c.value;t+=h.toString(16).padStart(2,"0").toUpperCase()+" "}}catch(v){o.e(v)}finally{o.f()}t=t.slice(0,-1)+`
`}}catch(v){r.e(v)}finally{r.f()}t=t.slice(0,-1),(0,k.E4)(t,"rx.log")}},{key:"load",value:function(){var i=j()(x()().mark(function r(){var a=this,l,o;return x()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,k.cT)(".log");case 2:l=h.sent,o=new FileReader,o.onload=function(){var v=o.result,p=v.split(`
`),d=0,m=[],g=O()(p),M;try{for(g.s();!(M=g.n()).done;){var C=M.value,S=[],L=C.split(" "),F=O()(L),Q;try{for(F.s();!(Q=F.n()).done;){var f=Q.value;S.push(parseInt(f,16))}}catch(R){F.e(R)}finally{F.f()}m.push(new Uint8Array(S)),d+=S.length}}catch(R){g.e(R)}finally{g.f()}a.setState({history:{rx:d,log:m,start:-1}})},o.readAsText(l);case 6:case"end":return h.stop()}},r)}));function t(){return i.apply(this,arguments)}return t}()},{key:"render",value:function(){var t=this,r=this,a=this.state.history,l;if(a.log.length===0)l=(0,u.jsx)(he.Z,{image:he.Z.PRESENTED_IMAGE_SIMPLE,description:"No log yet."});else{l=[];for(var o=0,c=function(d,m){return d==="A5"?(0,u.jsx)(Ne.Z,{color:"blue",onClick:function(){return r.setState({history:W()(W()({},r.state.history),{},{start:m})})},children:d},m):(0,u.jsx)(Ne.Z,{children:d},m)},h=function(d){var m=a.log[d];if(o>a.start||o+m.length<a.start)l.push((0,u.jsx)(ie.Z,{},d)),l.push(Array.from(m).map(function(H){return H.toString(16).padStart(2,"0").toUpperCase()}).map(function(H){var E=c(H,o);return o+=1,E}));else{l.push((0,u.jsx)(ie.Z,{},"".concat(d,"-prefix")));var g=a.start-o,M=Array.from(m.slice(0,g));l.push(Array.from(M).map(function(H){return H.toString(16).padStart(2,"0").toUpperCase()}).map(function(H){var E=c(H,o);return o+=1,E})),l.push((0,u.jsx)(ie.Z,{},"".concat(d,"-msg")));for(var C=N()(m.slice(g)),S=[0],L=d+1;L<a.log.length;L++)S.push(C.length),C.push.apply(C,N()(Array.from(a.log[L])));var F=function(E){l.push((0,u.jsx)(ie.Z,{},"".concat(d,"-suffix")));var D;for(D=0;D<S.length;D++)if(D===0){if(a.log[D+d].length-g>E){var J=a.log[D+d];l.push(Array.from(J.slice(E+g)).map(function($){return $.toString(16).padStart(2,"0").toUpperCase()}).map(function($){var ee=c($,o);return o+=1,ee}));break}}else if(S[D]+a.log[D+d].length>E){var q=a.log[D+d];l.push(Array.from(q.slice(E-S[D])).map(function($){return $.toString(16).padStart(2,"0").toUpperCase()}).map(function($){var ee=c($,o);return o+=1,ee}));break}d+=D},Q=function(E,D,J,q){return(0,u.jsx)(na.Z,{title:q,content:(0,u.jsx)(Ge.vY,{dataSource:J,columns:Ke(J),editable:!1,column:1,style:{width:250}},"".concat(o,"-").concat(q)),destroyTooltipOnHide:!0,children:D!=="Object"?Array.from(E).map(function($){return $.toString(16).padStart(2,"0").toUpperCase()}).map(function($){var ee=ke($,o,D);return o+=1,ee}):E})},f=function(E){var D=pt(Uint8Array.from(E));if(D.events.length>0){var J=[Q(E.slice(0,6),"purple",D,"Info")],q="geekblue",$=O()(D.events),ee;try{for($.s();!(ee=$.n()).done;){var we=ee.value;J.push(Q(E.slice(we.obj._start,we.obj._end),q,W()({operation:we.type},we.obj),"Object")),q==="geekblue"?q="cyan":q="geekblue"}}catch(ce){$.e(ce)}finally{$.f()}return J}else{var zt=[Q(E.slice(0,2),"geekblue",{error:"Wrong sub cmd id",sub_id:D.sub_id},"Error")];return zt.push(Array.from(E.slice(2)).map(function(ce){return ce.toString(16).padStart(2,"0").toUpperCase()}).map(function(ce){var oi=ke(ce,o,"orange");return o+=1,oi})),zt}},R=ca(Uint8Array.from(C));console.log(R);var ke=function(E,D,J){return(0,u.jsx)(Ne.Z,{color:J,children:E},D)};if(R.code===0){var St,ue=R.header;l.push(Q(C.slice(0,7),"green",ue,"Header")),(St=l).push.apply(St,N()(f(C.slice(7,ue.length+7)))),l.push(Array.from(C.slice(ue.length+7,ue.length+9)).map(function(H){return H.toString(16).padStart(2,"0").toUpperCase()}).map(function(H){var E=ke(H,o,"green");return o+=1,E})),F(ue.length+9)}else if(R.code<=2)l.push(Q(C.slice(0,1),"red",R,"Error")),F(1);else if(R.code<=6)l.push(Q(Array.from(C.slice(0,5)).map(function(H){return H.toString(16).padStart(2,"0").toUpperCase()}).map(function(H,E){var D="green";R.loc.includes(E)&&(D="red");var J=ke(H,o,D);return o+=1,J}),"Object",R,"Error")),F(5);else if(R.code<=7){var jt;l.push(Q(C.slice(0,7),"green",R.header,"Header")),(jt=l).push.apply(jt,N()(f(C.slice(7,R.loc[0])))),l.push(Q(C.slice(R.loc[0],R.loc[1]+1),"red",R,"Error")),F(R.loc[1]+1)}}v=d},v=0;v<a.log.length;v++)h(v)}return(0,u.jsx)(xe.Z,{title:"Serial Rx History",placement:"right",onClose:function(){return t.onClose()},open:this.state.show,size:"large",getContainer:document.getElementById("content-in"),rootStyle:{inset:"25px 0 0 0"},style:{borderTop:"3px var(--ant-line-type) var(--ant-color-split)"},children:(0,u.jsx)("div",{style:{width:"100%",height:"calc(100% - 25px)"},children:(0,u.jsxs)("div",{style:{color:"var(--ant-color-text)",height:"100%"},children:[(0,u.jsxs)(de.Z,{justify:"space-between",align:"center",children:[(0,u.jsxs)("p",{style:{margin:6},children:["RX: ",a.rx,",\xA0\xA0 This is not a real-time display, close and reopen to refresh."]}),(0,u.jsxs)(G.Z,{children:[(0,u.jsx)(z.ZP,{size:"small",type:"primary",onClick:function(){return t.save()},children:"Save"}),(0,u.jsx)(z.ZP,{size:"small",onClick:function(){return t.load()},children:"load"})]})]}),(0,u.jsx)("div",{style:{paddingBottom:10},className:"card-body",children:l})]})})})}}]),s}(I.Component),da=ha,fa=y(18299),va=function(n){P()(s,n);var e=B()(s);function s(){return A()(this,s),e.apply(this,arguments)}return T()(s,[{key:"render",value:function(){return(0,u.jsxs)(de.Z,{style:{width:"100%"},justify:"space-between",children:[this.props.children,(0,u.jsx)("div",{children:this.props.checked&&(0,u.jsx)(fa.Z,{})})]})}}]),s}(I.Component),pa=va,oe=y(73344),ma=function(n){P()(s,n);var e=B()(s);function s(){return A()(this,s),e.apply(this,arguments)}return T()(s,[{key:"render",value:function(){var t=this.props.errors.filter(function(l){return l.level==="Warn"}),r=this.props.errors.filter(function(l){return l.level==="Error"});console.log(this.props.errors),console.log(r);var a=(0,u.jsx)(pe.ZP,{status:"success",title:"Check Passed!",subTitle:"0 error, 0 warning!",style:{marginTop:"50px"}});return r.length+t.length>0&&(a=(0,u.jsxs)("div",{style:{color:"var(--ant-color-text)",height:"100%"},children:[(0,u.jsxs)("p",{children:["Found ",r.length," errors, ",t.length," warnings."]}),(0,u.jsx)("div",{style:{paddingBottom:10},className:"card-body",children:(0,u.jsx)(ye.Z,{bordered:!0,dataSource:this.props.errors,renderItem:function(o){return(0,u.jsx)(ye.Z.Item,{children:(0,u.jsxs)(G.Z,{size:"middle",children:[o.level==="warning"?(0,u.jsx)(ht.Z,{}):(0,u.jsx)(dt.Z,{}),o.message]})})}})})]})),(0,u.jsxs)("div",{style:{width:"100%",height:"calc(100% - 50px)"},children:[(0,u.jsx)("h3",{style:{color:"var(--ant-color-text)"},children:"Check Data"}),a]})}}]),s}(I.Component),ga=ma,ya=y(69615),xa=y(42308),mt=y(24389),ba=y(51376);function Ma(n){var e="";return n.h&&(e+=".h"),n.h&&n.c&&(e+=" and "),n.c&&(e+=".c"),e}function ka(){var n=document.querySelector(".rmui"),e=getComputedStyle(n),s=e.getPropertyValue("--ant-color-text-base");return s==="#fff"}var wa=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{preview:null,fileName:""}),b()(w()(i),"checked",[]),i}return T()(s,[{key:"review",value:function(t,r){this.setState({preview:this.props.code[t][r],fileName:"".concat(t,".").concat(r)})}},{key:"download",value:function(t,r){(0,k.E4)(this.props.code[t][r],"".concat(t,".").concat(r)),console.log(this.props.code[t][r])}},{key:"downloadChecked",value:function(){var i=j()(x()().mark(function r(){var a,l,o,c,h;return x()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.checked.length!==0){p.next=3;break}return U.error("Please select at least one file."),p.abrupt("return");case 3:return a={},p.t0=W(),p.t1=W()({},this.props.code),p.next=8,this.props.getUiBase();case 8:p.t2=p.sent,l=(0,p.t0)(p.t1,p.t2),o=O()(this.checked);try{for(o.s();!(c=o.n()).done;)h=c.value,a[h]=l[h]}catch(d){o.e(d)}finally{o.f()}(0,k.GM)(a).then(function(d){(0,k.Gj)(d,"codes.zip")});case 13:case"end":return p.stop()}},r,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"render",value:function(){var t=this,r=[{file:"ui base .h and .c",key:"_base"}];for(var a in this.props.code)r.push({file:"".concat(a," ").concat(Ma(this.props.code[a])),key:a,h:this.props.code[a].h!==void 0,c:this.props.code[a].c!==void 0});return(0,u.jsxs)("div",{className:"full",style:{overflow:"hidden"},children:[(0,u.jsx)("h3",{style:{color:"var(--ant-color-text)",marginBottom:20},children:"Download Data"}),(0,u.jsx)("div",{style:{paddingBottom:36},className:"card-body",children:(0,u.jsx)(ya.Z,{columns:[{title:"File",dataIndex:"file",key:"file"},{title:"Preview",dataIndex:"key",key:"preview",render:function(o,c){return(0,u.jsxs)(G.Z,{children:[c.h&&(0,u.jsx)(z.ZP,{type:"link",onClick:function(){t.review(o,"h")},children:"Preview .h"}),c.c&&(0,u.jsx)(z.ZP,{type:"link",onClick:function(){t.review(o,"c")},children:"Preview .c"})]})}},{title:"Download",dataIndex:"key",key:"download",render:function(o,c){return o!=="_base"?(0,u.jsxs)(G.Z,{children:[c.h&&(0,u.jsx)(z.ZP,{type:"link",onClick:function(){t.download(o,"h")},children:"Download .h"}),c.c&&(0,u.jsx)(z.ZP,{type:"link",onClick:function(){t.download(o,"c")},children:"Download .c"})]}):(0,u.jsx)(z.ZP,{type:"link",onClick:j()(x()().mark(function h(){var v,p;return x()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,t.props.getUiBase();case 2:return v=m.sent,m.next=5,(0,k.GM)(v);case 5:p=m.sent,(0,k.Gj)(p,"ui_base.zip");case 7:case"end":return m.stop()}},h)})),children:"Download .zip"})}}],dataSource:r,rowSelection:{type:"checkbox",onChange:function(o){var c=N()(o);c.includes("_base")&&(c=c.filter(function(h){return h!=="_base"}),c.push("ui_types"),c.push("ui_interface")),t.checked=c},getCheckboxProps:function(o){return{name:o.key}}},pagination:!1})}),(0,u.jsx)(xe.Z,{onClose:function(){return t.setState({preview:null})},open:this.state.preview!==null,title:this.state.fileName,size:"large",getContainer:document.getElementById("content-in"),rootStyle:{inset:"25px 0 0 0"},children:(0,u.jsx)("div",{style:{height:"100%",overflow:"auto"},children:(0,u.jsx)(xa.ZP,{value:this.state.preview||"",theme:ka()?mt.ub:mt.tR,extensions:[(0,ba.N)()],onContextMenu:function(o){o.stopPropagation()}})})})]})}}]),s}(I.Component),Sa=wa;function ja(n){var e=new Uint8Array(15),s=0,i=n.group.split("-");e[s++]=Math.round(Number(i[0])),e[s++]=Math.round(Number(i[1])),e[s++]=Math.round(n.id);var t=Math.round(n.operate_tpyel)|Math.round(n.figure_tpye)<<3|Math.round(n.layer)<<6|Math.round(n.color)<<10|Math.round(n._a)<<14|Math.round(n._b)<<23;e[s++]=t&255,e[s++]=t>>8&255,e[s++]=t>>16&255,e[s++]=t>>24&255;var r=Math.round(n.width)|Math.round(n.start_x)<<10|Math.round(n.start_y)<<21;e[s++]=r&255,e[s++]=r>>8&255,e[s++]=r>>16&255,e[s++]=r>>24&255;var a=Math.round(n._c)|Math.round(n._d)<<10|Math.round(n._e)<<21;return e[s++]=a&255,e[s++]=a>>8&255,e[s++]=a>>16&255,e[s++]=a>>24&255,e}function za(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"add",s=n.group,i=n.id&255,t=ae.indexOf(n.type),r=Fe.indexOf(n.color),a=n.layer,l;n.fontSize?l=Math.round(n.fontSize/10):l=n.lineWidth;var o=n.x,c=n.y,h=0,v=0,p=0,d=0,m=0;switch(n.type.slice(2)){case"Line":d=n.x2||0,m=n.y2||0;break;case"Rect":d=(n.width||0)+o,m=(n.height||0)+c;break;case"Round":p=n.r||0;break;case"Ellipse":d=n.rx||0,m=n.ry||0;break;case"Arc":h=n.startAngle||0,v=n.endAngle||0,d=n.rx||0,m=n.ry||0;break;case"Float":h=n.fontSize||0;var g=(n.float||0)*1e3;p=g&1023,d=g>>10&2047,m=g>>21&2047;break;case"Number":h=n.fontSize||0;var M=n.number||0;p=M&1023,d=M>>10&2047,m=M>>21&2047;break;case"Text":h=n.fontSize||0,v=(n.text||"").length;break}return{group:s,id:i,operate_tpyel:Re.indexOf(e),figure_tpye:t,layer:a,color:r,_a:h,_b:v,width:l,start_x:o,start_y:c,_c:p,_d:d,_e:m,number:p}}function gt(n){return ja(za(n))}function Ca(n){var e=new Uint8Array(0);if(n.forEach(function(a){e=new Uint8Array([].concat(N()(e),N()(gt(a))))}),2<n.length&&n.length<5){for(var s=new Uint8Array(15*(5-n.length)),i=0;i<15*(5-n.length);i++)s[i]=0;e=new Uint8Array([].concat(N()(e),N()(s)))}if(5<n.length&&n.length<7){for(var t=new Uint8Array(15*(7-n.length)),r=0;r<15*(7-n.length);r++)t[r]=0;e=new Uint8Array([].concat(N()(e),N()(t)))}return e}function Ia(n){var e=new Uint8Array([].concat(N()(gt(n[0])),N()(new Uint8Array(30))));if(n[0].text)for(var s=15;s<n[0].text.length+15;s++)e[s]=n[0].text.charCodeAt(s);return e}function Aa(n){return n[0].text?Ia(n):Ca(n)}var be=0,yt=769;function xt(n){var e=new Uint8Array(13),s=new Uint8Array(2);e[0]=165;var i=n.length+6;e[1]=i&255,e[2]=i>>8&255,e[3]=be,e[4]=ne(e.subarray(0,4)),e[5]=yt&255,e[6]=yt>>8&255;var t=0;n.length===2?t=256:n.length===15?t=257:n.length===30?t=258:n.length===75?t=259:n.length===105?t=260:n.length===45&&(t=272),e[7]=t&255,e[8]=t>>8&255,e[9]=K&255,e[10]=K>>8&255,e[11]=K+256&255,e[12]=K+256>>8&255;var r=new Uint8Array([].concat(N()(e),N()(n),N()(s))),a=le(r.subarray(0,r.length-2));return r[r.length-2]=a&255,r[r.length-1]=a>>8&255,be++,be>=256&&(be=0),r}function Ta(n){var e=Aa(n);return xt(e)}function Da(){return xt(new Uint8Array([2,0]))}var Ea=function(){function n(e,s,i){A()(this,n),this.frame_name=e,this.split_id=s,this.objs=i}return T()(n,[{key:"toSerialMsg",value:function(){var s=[],i=O()(this.objs),t;try{for(i.s();!(t=i.n()).done;){var r=t.value,a=W()({},r);a.group="".concat(this.frame_name,"-").concat(this.split_id),s.push(a)}}catch(l){i.e(l)}finally{i.f()}return Ta(s)}}]),n}(),bt=Ea,Oa=function(){function n(e,s,i){A()(this,n),this.frame_name=e,this.group_name=s,this.splits=[];var t=O()(i),r;try{for(t.s();!(r=t.n()).done;){var a=r.value;a.type==="UiText"&&this.splits.push(new bt(this.frame_name,this.splits.length,[a]))}}catch(h){t.e(h)}finally{t.f()}for(var l=i.filter(function(h){return h.type!=="UiText"}),o=Math.ceil(l.length/7),c=0;c<o;c++)this.splits.push(new bt(this.frame_name,this.splits.length,l.slice(c*7,(c+1)*7)))}return T()(n,[{key:"toSerialMsg",value:function(){var s=[],i=O()(this.splits),t;try{for(i.s();!(t=i.n()).done;){var r=t.value;s.push(r.toSerialMsg())}}catch(a){i.e(a)}finally{i.f()}return s}}]),n}(),Na=Oa,Fa=function(){function n(e,s){A()(this,n),this.name=e,this.groups=[];var i={};for(var t in s){var r=s[t];r.group in i?i[r.group].push(r):i[r.group]=[r]}for(var a in i)this.groups.push(new Na(this.name,a,i[a]))}return T()(n,[{key:"toSerialMsg",value:function(){var s=[],i=O()(this.groups),t;try{for(i.s();!(t=i.n()).done;){var r=t.value;s=s.concat(r.toSerialMsg())}}catch(a){i.e(a)}finally{i.f()}return s}}]),n}(),Mt=Fa,Ra=y(35394),La=y(84378),Ua=y(49200),Za=y(76631),Ha=y(40539),Pa=y(12285);function Ba(n){return Ze.apply(this,arguments)}function Ze(){return Ze=j()(x()().mark(function n(e){return x()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!e){i.next=21;break}return i.next=3,fetch(Ra);case 3:return i.next=5,i.sent.text();case 5:return i.t0=i.sent,i.next=8,fetch(La);case 8:return i.next=10,i.sent.text();case 10:return i.t1=i.sent,i.t2={h:i.t0,c:i.t1},i.next=14,fetch(Ua);case 14:return i.next=16,i.sent.text();case 16:return i.t3=i.sent,i.t4={h:i.t3},i.abrupt("return",{ui_interface:i.t2,ui_types:i.t4});case 21:return i.next=23,fetch(Za);case 23:return i.next=25,i.sent.text();case 25:return i.t5=i.sent,i.next=28,fetch(Ha);case 28:return i.next=30,i.sent.text();case 30:return i.t6=i.sent,i.t7={h:i.t5,c:i.t6},i.next=34,fetch(Pa);case 34:return i.next=36,i.sent.text();case 36:return i.t8=i.sent,i.t9={h:i.t8},i.abrupt("return",{ui_interface:i.t7,ui_types:i.t9});case 39:case"end":return i.stop()}},n)})),Ze.apply(this,arguments)}var Wa=function(){function n(e,s){if(A()(this,n),this.res=JSON.parse(window.Module.generate(JSON.stringify(e),s)),this.frames=[],Object.keys(e).length===1)this.frames.push(new Mt("g",e[Object.keys(e)[0]]));else for(var i in e)this.frames.push(new Mt(i,e[i]))}return T()(n,[{key:"gen",value:function(){return this.res.code}},{key:"getUiBase",value:function(s){return function(){return Ba(s)}}},{key:"check",value:function(){return this.res.info}},{key:"toSerialMsg",value:function(){var s={},i=O()(this.frames),t;try{for(i.s();!(t=i.n()).done;){var r=t.value;s[r.name]=r.toSerialMsg()}}catch(a){i.e(a)}finally{i.f()}return s}}]),n}(),kt=Wa,Ya=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{show:!1,step:"check"}),b()(w()(i),"downloadRef",(0,I.createRef)()),b()(w()(i),"data",{}),b()(w()(i),"errors",[]),i}return T()(s,[{key:"gen",value:function(t,r){this.helper=new kt(t,r!=="dynamic"),this.data=t,this.code=this.helper.gen(),this.errors=this.helper.check(),this.setState({show:!0,step:"check"})}},{key:"onClose",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var t=this,r=(0,u.jsx)(z.ZP,{type:"primary",onClick:function(){return t.setState({step:"generate"})},disabled:this.errors.filter(function(l){return l.level==="Error"}).length>0,children:"Generate"}),a=(0,u.jsx)(z.ZP,{type:"primary",onClick:function(){var o;return(o=t.downloadRef)===null||o===void 0||(o=o.current)===null||o===void 0?void 0:o.downloadChecked()},children:"Download"});return(0,u.jsx)("div",{children:(0,u.jsx)(xe.Z,{title:"C Code Generator",placement:"right",onClose:function(){return t.onClose()},open:this.state.show,size:"large",getContainer:document.getElementById("content-in"),rootStyle:{inset:"25px 0 0 0"},style:{borderTop:"3px var(--ant-line-type) var(--ant-color-split)"},footer:(0,u.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",padding:5},children:this.state.step==="check"?r:a}),children:this.state.step==="check"?(0,u.jsx)(ga,{errors:this.errors}):(0,u.jsx)(Sa,{code:this.code,getUiBase:this.helper.getUiBase(),ref:this.downloadRef})})})}}]),s}(I.Component),$a=Ya,Ga=function(){function n(){A()(this,n),b()(this,"messages",[]),b()(this,"enabled",!1),b()(this,"log",[]),b()(this,"rx",0)}return T()(n,[{key:"warn",value:function(s){this.enabled&&(this.messages.push({level:"warn",message:s,time:new Date}),console.warn(s)),this.messages.length>100&&(this.messages=this.messages.slice(-100))}},{key:"error",value:function(s){this.enabled&&(this.messages.push({level:"error",message:s,time:new Date}),console.error(s)),this.messages.length>100&&(this.messages=this.messages.slice(-100))}},{key:"clear",value:function(){this.messages=[]}},{key:"logHistory",value:function(s){this.log.push(Uint8Array.from(N()(s))),this.rx+=s.length,this.log.length>100&&this.log.shift()}},{key:"get",value:function(){return this.messages}},{key:"getHistory",value:function(){return{log:N()(this.log),rx:this.rx}}}]),n}(),Qa=new Ga,Y=Qa,Va=[8,21,36,81,111,51],Ja=function(){function n(){A()(this,n),b()(this,"buffer",void 0),this.buffer=new Uint8Array(0)}return T()(n,[{key:"transform",value:function(s,i){for(this.buffer=Uint8Array.from([].concat(N()(this.buffer),N()(s))),Y.logHistory(s);this.buffer.length>7;){if(this.buffer[0]!==165){this.buffer=this.buffer.subarray(1);continue}if(this.buffer.length<7)break;var t=this.buffer[1]|this.buffer[2]<<8,r=this.buffer[3],a=this.buffer[4],l=this.buffer[5]|this.buffer[6]<<8,o=this.buffer.subarray(0,4);if(ne(o)!==a){this.buffer=this.buffer.subarray(1),Y.warn("crc8 error, calc: 0x".concat(ne(o).toString(16),", msg: 0x").concat(a.toString(16)));continue}if(l!==769){this.buffer=this.buffer.subarray(1),Y.warn("cmd_id 0x".concat(l.toString(16)," not match"));continue}if(!Va.includes(t)){this.buffer=this.buffer.subarray(1),Y.warn("length error, length: ".concat(t));continue}if(this.buffer.length<6+t+2)break;var c=this.buffer.subarray(7,7+t),h=this.buffer[7+t]|this.buffer[8+t]<<8;if(le(this.buffer.subarray(0,7+t))!==h){this.buffer=this.buffer.subarray(1),Y.error("crc16 error, calc: 0x".concat(le(this.buffer.subarray(0,7+t)).toString(16),", msg: 0x").concat(h.toString(16)));continue}i.enqueue(c),this.buffer=this.buffer.subarray(7+t+2)}}}]),n}(),He=Ja,Ka=function(){function n(e,s){A()(this,n),b()(this,"options",{baudRate:115200,dataBits:8,stopBits:1,flowControl:"none",parity:"none"}),this.onEvent=e,this.onError=s,this.reader=null,this.transformer=new TransformStream(new He)}return T()(n,[{key:"connect",value:function(){var e=j()(x()().mark(function i(){return x()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("serial"in navigator){r.next=3;break}return U.error("Web Serial API not supported."),r.abrupt("return");case 3:return r.next=5,navigator.serial.requestPort();case 5:return this.port=r.sent,r.next=8,this.port.open(this.options);case 8:this.readableStreamClosed=this.port.readable.pipeTo(this.transformer.writable),this.reader=this.transformer.readable.getReader(),Y.enabled=!0,Y.clear(),this.readLoop();case 13:case"end":return r.stop()}},i,this)}));function s(){return e.apply(this,arguments)}return s}()},{key:"stop",value:function(){var e=j()(x()().mark(function i(){var t,r,a;return x()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=new TextEncoderStream,r=t.writable.getWriter(),a=t.readable.pipeTo(this.port.writable),this.reader.cancel(),o.next=6,this.readableStreamClosed.catch(function(){});case 6:return r.close(),o.next=9,a;case 9:return o.next=11,this.port.close();case 11:this.reader=null,this.transformer=new TransformStream(new He),Y.enabled=!1;case 14:case"end":return o.stop()}},i,this)}));function s(){return e.apply(this,arguments)}return s}()},{key:"readLoop",value:function(){var e=j()(x()().mark(function i(){var t,r,a,l,o,c,h,v;return x()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:d.prev=0;case 1:return d.next=4,this.reader.read();case 4:if(t=d.sent,r=t.value,a=t.done,!a){d.next=10;break}return this.reader.releaseLock(),d.abrupt("break",21);case 10:if(l=pt(r),l.sender===K){d.next=14;break}return Y.error("Sender ".concat(l.sender," not match self ").concat(K)),d.abrupt("continue",1);case 14:if(l.receiver===K+256){d.next=17;break}return Y.error("Receiver ".concat(l.receiver," not match self ").concat(K)),d.abrupt("continue",1);case 17:if(o=this===null||this===void 0?void 0:this.onEvent(l),o){c=O()(o);try{for(c.s();!(h=c.n()).done;)v=h.value,v[0]==="W"?Y.warn(v.slice(3)):v[0]==="E"&&Y.error(v.slice(3))}catch(m){c.e(m)}finally{c.f()}}d.next=1;break;case 21:d.next=37;break;case 23:return d.prev=23,d.t0=d.catch(0),d.prev=25,d.next=28,this.stop();case 28:d.next=32;break;case 30:d.prev=30,d.t1=d.catch(25);case 32:this.reader=null,this.transformer=new TransformStream(new He),Y.enabled=!1,Y.clear(),this.onError(d.t0);case 37:case"end":return d.stop()}},i,this,[[0,23],[25,30]])}));function s(){return e.apply(this,arguments)}return s}()},{key:"getLog",value:function(){return Y.get()}},{key:"getHistory",value:function(){return Y.getHistory()}}]),n}(),Xa=Ka,qa=function(){function n(){A()(this,n),b()(this,"options",{baudRate:115200,dataBits:8,stopBits:1,flowControl:"none",parity:"none"}),b()(this,"writer",null)}return T()(n,[{key:"connect",value:function(){var e=j()(x()().mark(function i(){return x()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("serial"in navigator){r.next=3;break}return U.error("Web Serial API not supported."),r.abrupt("return");case 3:return r.next=5,navigator.serial.requestPort();case 5:return this.port=r.sent,r.next=8,this.port.open(this.options);case 8:this.writer=this.port.writable.getWriter();case 9:case"end":return r.stop()}},i,this)}));function s(){return e.apply(this,arguments)}return s}()},{key:"stop",value:function(){var e=j()(x()().mark(function i(){return x()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.writer.releaseLock();case 2:return this.writer=null,r.next=5,this.port.close();case 5:case"end":return r.stop()}},i,this)}));function s(){return e.apply(this,arguments)}return s}()},{key:"write",value:function(){var e=j()(x()().mark(function i(t){var r=this,a,l,o,c,h,v,p;return x()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(this.writer){m.next=3;break}return U.error("Serial port is not open."),m.abrupt("return");case 3:a=0,setTimeout(function(){r.writer.write(Da())},a),a+=50,l=new kt(t.data),o=l.toSerialMsg(),c=o[t.selected],h=O()(c),m.prev=10,p=x()().mark(function g(){var M;return x()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:M=v.value,setTimeout(function(){r.writer.write(M)},a),a+=50;case 3:case"end":return S.stop()}},g)}),h.s();case 13:if((v=h.n()).done){m.next=17;break}return m.delegateYield(p(),"t0",15);case 15:m.next=13;break;case 17:m.next=22;break;case 19:m.prev=19,m.t1=m.catch(10),h.e(m.t1);case 22:return m.prev=22,h.f(),m.finish(22);case 25:case"end":return m.stop()}},i,this,[[10,19,22,25]])}));function s(i){return e.apply(this,arguments)}return s}()}]),n}(),_a=qa,Me=[{key:"File-new",label:"New"},{key:"File-open",label:"Open"},{key:"File-save",label:"Save"},{key:"File-saveAs",label:"Save as"},{key:"File-autoSave",label:"Auto Save"},{type:"divider"},{key:"File-generate1",label:"Generate Static Code",icon:(0,u.jsx)(at.Z,{})},{key:"File-generate2",label:"Generate Dynamic Code",icon:(0,u.jsx)(at.Z,{})}],Pe=[{key:"Edit-undo",label:"Undo"},{key:"Edit-redo",label:"Redo"},{key:"Edit-reset",label:"Reset History"}],X=[{key:"Simulate-from",label:"From Robot",children:[{key:"Simulate-from-start",label:"Start"},{key:"Simulate-from-stop",label:"Stop"},{key:"Simulate-from-log",label:"Debug Log"},{key:"Simulate-from-rx",label:"Rx History"}]},{key:"Simulate-to",label:"To Referee",children:[{key:"Simulate-to-start",label:"Start"},{key:"Simulate-to-stop",label:"Stop"},{key:"Simulate-to-update",label:"Update"}]},{key:"Simulate-settings",label:"Settings"}],ei=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{fullscreen:!1,frames:["default"],selectedFrame:"default",darkMode:!1,couldUndo:!1,couldRedo:!1,serialStart:!1,serialToStart:!1,autoSave:!0}),b()(w()(i),"formRef",(0,I.createRef)()),b()(w()(i),"aboutRef",(0,I.createRef)()),b()(w()(i),"generatorRef",(0,I.createRef)()),b()(w()(i),"logDrawerRef",(0,I.createRef)()),b()(w()(i),"rxDrawerRef",(0,I.createRef)()),b()(w()(i),"serialModalRef",(0,I.createRef)()),b()(w()(i),"modeModalRef",(0,I.createRef)()),b()(w()(i),"tauri",(0,k.UP)()),b()(w()(i),"serial",new Xa(function(l){return i.onSerialEvent(l)},function(l){return i.onSerialError(l)})),b()(w()(i),"serialTo",new _a),b()(w()(i),"fileHandler",null),i}return T()(s,[{key:"onSerialEvent",value:function(t){var r=[],a=O()(t.events),l;try{for(a.s();!(l=a.n()).done;){var o=l.value,c=this.props.onObjectEvent(o.type,o.obj);(c[0]==="W"||c[0]==="E")&&r.push(c)}}catch(h){a.e(h)}finally{a.f()}return r}},{key:"onSerialError",value:function(t){this.props.setEditable(!0),this.setState({serialStart:!1}),U.error(t.text)}},{key:"componentDidMount",value:function(){var i=j()(x()().mark(function r(){var a=this,l,o,c,h,v;return x()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(c=function(){return c=j()(x()().mark(function g(){var M;return x()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,oe.G.isMaximized();case 2:M=S.sent,l.setState({fullscreen:M});case 4:case"end":return S.stop()}},g)})),c.apply(this,arguments)},o=function(){return c.apply(this,arguments)},l=this,!this.tauri){d.next=8;break}return d.next=6,o();case 6:return d.next=8,oe.G.onResized(function(m){return o()});case 8:return d.next=11,(h=this.modeModalRef.current)===null||h===void 0?void 0:h.open();case 11:if(v=d.sent,v!=="new"){d.next=25;break}return this.fileHandler=new nt(function(){return JSON.stringify({version:2,data:a.props.getData(),selected:a.state.selectedFrame})}),d.next=16,this.fileHandler.create();case 16:if(!d.sent){d.next=23;break}return d.t0=this.props,d.next=20,this.fileHandler.read();case 20:return d.t1=d.sent,d.t0.upload.call(d.t0,d.t1),d.abrupt("break",42);case 23:d.next=40;break;case 25:if(v!=="open"){d.next=38;break}return this.fileHandler=new nt(function(){return JSON.stringify({version:2,data:a.props.getData(),selected:a.state.selectedFrame})}),d.next=29,this.fileHandler.open();case 29:if(!d.sent){d.next=36;break}return d.t2=this.props,d.next=33,this.fileHandler.read();case 33:return d.t3=d.sent,d.t2.upload.call(d.t2,d.t3),d.abrupt("break",42);case 36:d.next=40;break;case 38:return this.setState({autoSave:!1}),d.abrupt("break",42);case 40:d.next=8;break;case 42:window.addEventListener("keydown",function(){var m=j()(x()().mark(function g(M){return x()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(M.ctrlKey&&M.key==="s")){S.next=8;break}if(M.preventDefault(),!a.fileHandler){S.next=7;break}return S.next=5,a.fileHandler.save();case 5:S.next=8;break;case 7:(0,k.q7)(a.props.getData(),"ui.rmui",a.state.selectedFrame);case 8:case"end":return S.stop()}},g)}));return function(g){return m.apply(this,arguments)}}());case 43:case"end":return d.stop()}},r,this)}));function t(){return i.apply(this,arguments)}return t}()},{key:"setCouldDo",value:function(t){this.setState({couldUndo:t.couldPrevious,couldRedo:t.couldNext}),this.fileHandler&&this.state.autoSave&&this.fileHandler.update()}},{key:"fullScreen",value:function(){if(this.tauri)oe.G.maximize();else{var t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}this.setState({fullscreen:!0})}},{key:"exitFullscreen",value:function(){this.tauri?oe.G.unmaximize():document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.setState({fullscreen:!1})}},{key:"setFrames",value:function(t){this.setState({frames:t.frames,selectedFrame:t.selected})}},{key:"onMenuClick",value:function(){var i=j()(x()().mark(function r(a){var l=this,o,c,h,v,p,d,m,g,M,C,S,L,F;return x()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(o=a.keyPath[a.keyPath.length-1],o.slice(0,6)!=="Insert"){f.next=7;break}c=a.key.slice(7),h={id:-1,name:"New".concat(c),layer:0,group:"Ungroup",type:"Ui".concat(c)},this.props.onObjectEvent("_add",h),f.next=207;break;case 7:if(o!=="Edit-reset"){f.next=11;break}this.props.onHistoryEvent("resetNow"),f.next=207;break;case 11:if(o!=="Edit-undo"){f.next=15;break}this.props.onHistoryEvent("previous"),f.next=207;break;case 15:if(o!=="Edit-redo"){f.next=19;break}this.props.onHistoryEvent("next"),f.next=207;break;case 19:if(o!=="File-new"){f.next=40;break}if(!this.fileHandler){f.next=36;break}return f.next=23,this.fileHandler.disableAutoSave();case 23:return this.setState({autoSave:!1}),f.next=26,this.fileHandler.create();case 26:if(!f.sent){f.next=34;break}return f.t0=this.props,f.next=30,this.fileHandler.read();case 30:f.t1=f.sent,f.t0.upload.call(f.t0,f.t1),this.fileHandler.enableAutoSave(),this.setState({autoSave:!0});case 34:f.next=38;break;case 36:this.props.reset(),this.props.onHistoryEvent("reset");case 38:f.next=207;break;case 40:if(o!=="File-save"){f.next=49;break}if(!this.fileHandler){f.next=46;break}return f.next=44,this.fileHandler.save();case 44:f.next=47;break;case 46:(0,k.q7)(this.props.getData(),"ui.rmui",this.state.selectedFrame);case 47:f.next=207;break;case 49:if(o!=="File-saveAs"){f.next=63;break}if(!this.fileHandler){f.next=61;break}return f.next=53,this.fileHandler.disableAutoSave();case 53:return this.setState({autoSave:!1}),f.next=56,this.fileHandler.create();case 56:if(!f.sent){f.next=61;break}return f.next=59,this.fileHandler.save();case 59:this.fileHandler.enableAutoSave(),this.setState({autoSave:!0});case 61:f.next=207;break;case 63:if(o!=="File-autoSave"){f.next=74;break}if(!this.fileHandler){f.next=72;break}if(!this.state.autoSave){f.next=70;break}return f.next=68,this.fileHandler.disableAutoSave();case 68:f.next=71;break;case 70:this.fileHandler.enableAutoSave();case 71:this.setState({autoSave:!this.state.autoSave});case 72:f.next=207;break;case 74:if(o!=="File-open"){f.next=94;break}if(!this.fileHandler){f.next=91;break}return f.next=78,this.fileHandler.disableAutoSave();case 78:return this.setState({autoSave:!1}),f.next=81,this.fileHandler.open();case 81:if(!f.sent){f.next=89;break}return f.t2=this.props,f.next=85,this.fileHandler.read();case 85:f.t3=f.sent,f.t2.upload.call(f.t2,f.t3),this.fileHandler.enableAutoSave(),this.setState({autoSave:!0});case 89:f.next=92;break;case 91:(0,k.cT)(".rmui").then(function(R){l.props.upload(R)}).catch(function(){});case 92:f.next=207;break;case 94:if(o!=="File-generate1"){f.next=98;break}(v=this.generatorRef.current)===null||v===void 0||v.gen(this.props.getData(),"static"),f.next=207;break;case 98:if(o!=="File-generate2"){f.next=102;break}(p=this.generatorRef.current)===null||p===void 0||p.gen(this.props.getData(),"dynamic"),f.next=207;break;case 102:if(o!=="FrameOp-add"){f.next=109;break}return f.next=105,this.formRef.current.open("New Frame",this.state.frames);case 105:d=f.sent,this.props.setFrame("add",d),f.next=207;break;case 109:if(o!=="FrameOp-remove"){f.next=113;break}this.props.setFrame("remove",this.state.selectedFrame),f.next=207;break;case 113:if(o!=="FrameOp-copy"){f.next=120;break}return f.next=116,this.formRef.current.open("Copy Frame To",this.state.frames);case 116:m=f.sent,this.props.setFrame("copy",m),f.next=207;break;case 120:if(o!=="FrameOp-rename"){f.next=127;break}return f.next=123,this.formRef.current.open("Rename Frame To",this.state.frames);case 123:g=f.sent,this.props.setFrame("rename",g),f.next=207;break;case 127:if(o!=="FrameOp-change"){f.next=132;break}M=a.key.slice(7),this.props.setFrame("change",M),f.next=207;break;case 132:if(a.key!=="Simulate-from-start"){f.next=145;break}return f.prev=133,f.next=136,this.serial.connect();case 136:this.props.setEditable(!1),this.setState({serialStart:!0}),f.next=143;break;case 140:f.prev=140,f.t4=f.catch(133),U.error(f.t4.text);case 143:f.next=207;break;case 145:if(a.key!=="Simulate-from-stop"){f.next=158;break}return f.prev=146,f.next=149,this.serial.stop();case 149:this.props.setEditable(!0),this.setState({serialStart:!1}),f.next=156;break;case 153:f.prev=153,f.t5=f.catch(146),U.error(f.t5.text);case 156:f.next=207;break;case 158:if(a.key!=="Simulate-from-log"){f.next=162;break}(C=this.logDrawerRef.current)===null||C===void 0||C.show(this.serial.getLog()),f.next=207;break;case 162:if(a.key!=="Simulate-from-rx"){f.next=166;break}(S=this.rxDrawerRef.current)===null||S===void 0||S.show(this.serial.getHistory()),f.next=207;break;case 166:if(a.key!=="Simulate-to-start"){f.next=179;break}return f.prev=167,f.next=170,this.serialTo.connect();case 170:U.warning("This Module is beta now, maybe not work!"),this.setState({serialToStart:!0}),f.next=177;break;case 174:f.prev=174,f.t6=f.catch(167),U.error(f.t6.text);case 177:f.next=207;break;case 179:if(a.key!=="Simulate-to-stop"){f.next=191;break}return f.prev=180,f.next=183,this.serialTo.stop();case 183:this.setState({serialToStart:!1}),f.next=189;break;case 186:f.prev=186,f.t7=f.catch(180),U.error(f.t7.text);case 189:f.next=207;break;case 191:if(a.key!=="Simulate-to-update"){f.next=202;break}return f.prev=192,f.next=195,this.serialTo.write({data:this.props.getData(),selected:this.state.selectedFrame});case 195:f.next=200;break;case 197:f.prev=197,f.t8=f.catch(192),U.error(f.t8.text);case 200:f.next=207;break;case 202:if(o!=="Simulate-settings"){f.next=207;break}return f.next=205,(L=this.serialModalRef.current)===null||L===void 0?void 0:L.getOptions(this.serial.options);case 205:F=f.sent,F&&(this.serial.options=F);case 207:case"end":return f.stop()}},r,this,[[133,140],[146,153],[167,174],[180,186],[192,197]])}));function t(r){return i.apply(this,arguments)}return t}()},{key:"getFramesMenu",value:function(){var t=[{key:"FrameOp-add",label:"New Frame"},{key:"FrameOp-copy",label:"Copy This Frame"},{key:"FrameOp-rename",label:"Rename This Frame"},{key:"FrameOp-remove",label:"Remove This Frame"},{key:"FrameOp-change",label:"Change to",selectable:"true",children:[]}],r=O()(this.state.frames),a;try{for(r.s();!(a=r.n()).done;){var l=a.value;t[4].children.push({key:"Frames-".concat(l),label:l})}}catch(o){r.e(o)}finally{r.f()}return t}},{key:"render",value:function(){var t=this,r=(0,u.jsx)(z.ZP,{type:"text",onClick:function(){return t.fullScreen()},size:"small",children:(0,u.jsx)(Ar.Z,{style:{color:"var(--ant-color-text)"}})}),a=(0,u.jsx)(z.ZP,{type:"text",onClick:function(){return t.exitFullscreen()},size:"small",children:(0,u.jsx)(Tr.Z,{style:{color:"var(--ant-color-text)"}})}),l=(0,u.jsx)(z.ZP,{type:"text",onClick:function(){return t.props.setDarkMode(!0)},size:"small",children:(0,u.jsx)(it.Z,{component:Jr})}),o=(0,u.jsx)(z.ZP,{type:"text",onClick:function(){return t.props.setDarkMode(!1)},size:"small",children:(0,u.jsx)(it.Z,{component:ea})});return Pe[0].disabled=!this.state.couldUndo,Pe[1].disabled=!this.state.couldRedo,X[0].disabled=this.state.serialToStart,X[1].disabled=this.state.serialStart,X[2].disabled=this.state.serialStart||this.state.serialToStart,X[0].children[0].disabled=this.state.serialStart,X[0].children[1].disabled=!this.state.serialStart,X[1].children[0].disabled=this.state.serialToStart,X[1].children[1].disabled=!this.state.serialToStart,X[1].children[2].disabled=!this.state.serialToStart,Me[3].disabled=!this.fileHandler,Me[4].disabled=!this.fileHandler,Me[4].label=(0,u.jsx)(pa,{checked:this.state.autoSave,children:"Auto Save"}),(0,u.jsxs)("div",{style:{width:"100%",height:32,marginTop:-5,zIndex:2e3,position:"relative"},className:"solid-color","data-tauri-drag-region":!0,children:[(0,u.jsxs)(de.Z,{style:{width:"100vw",display:"flex",paddingTop:-5},justify:"flex-start",align:"center","data-tauri-drag-region":!0,children:[(0,u.jsx)("div",{style:{fontFamily:"YouSheBiaoTiHei",fontSize:20,paddingLeft:6,paddingRight:6,paddingTop:3,display:"flex",color:"var(--ant-color-text)",cursor:"default"},"data-tauri-drag-region":!0,children:"RoboMaster UI Designer"}),(0,u.jsx)(te.Z,{menu:{items:[].concat(Me),onClick:function(h){return t.onMenuClick(h)}},children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:"File"})}),(0,u.jsx)(te.Z,{menu:{items:[].concat(Pe),onClick:function(h){return t.onMenuClick(h)}},children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:"Edit"})}),(0,u.jsx)(te.Z,{menu:{items:or(),onClick:function(h){return t.onMenuClick(h)}},children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:"Insert"})}),(0,u.jsx)(te.Z,{menu:{items:this.getFramesMenu(),onClick:function(h){return t.onMenuClick(h)},selectedKeys:["Frames-".concat(this.state.selectedFrame)]},children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:"Frames"})}),(0,u.jsx)(te.Z,{menu:{items:[].concat(X),onClick:function(h){return t.onMenuClick(h)}},children:(0,u.jsxs)(z.ZP,{type:"text",size:"small",children:["Simulate\xA0",(0,u.jsx)(Ir.Z,{color:this.state.serialStart||this.state.serialToStart?"green":"red"})]})}),(0,u.jsx)(z.ZP,{type:"text",size:"small",onClick:function(){var h;(h=t.aboutRef.current)===null||h===void 0||h.show()},children:"About"}),(0,u.jsxs)("div",{style:{marginRight:5,justifyContent:"flex-end",marginLeft:"auto",marginTop:2},"data-tauri-drag-region":!0,children:[(0,u.jsxs)("div",{style:{display:"inline",marginRight:15,fontSize:10,cursor:"default",color:"var(--ant-color-text)"},"data-tauri-drag-region":!0,children:["Try\xA0",(0,u.jsx)("a",{href:"/nightly",children:(0,u.jsx)(z.ZP,{type:"link",style:{padding:0},size:"small","data-tauri-drag-region":!0,children:"Nightly"})})]}),(0,u.jsxs)("div",{style:{display:"inline",marginRight:15,fontSize:10,cursor:"default",color:"var(--ant-color-text)"},"data-tauri-drag-region":!0,children:["Created by\xA0",(0,u.jsx)("a",{href:"https://github.com/bismarckkk",target:"_blank",children:(0,u.jsx)(z.ZP,{type:"link",style:{padding:0},size:"small","data-tauri-drag-region":!0,children:"Bismarckkk"})})]}),this.props.darkMode?o:l,(0,u.jsx)("a",{href:"https://github.com/bismarckkk/RM-UI-Designer",target:"_blank",children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:(0,u.jsx)(Dr.Z,{style:{color:"var(--ant-color-text)"}})})}),(0,u.jsx)(z.ZP,{type:"text",size:"small",onClick:function(){return oe.G.minimize()},style:{display:this.tauri?"inline":"none"},children:(0,u.jsx)(Er.Z,{style:{color:"var(--ant-color-text)"}})}),this.state.fullscreen?a:r,(0,u.jsx)(z.ZP,{type:"text",size:"small",onClick:function(){return(0,rt.J)()},style:{display:this.tauri?"inline":"none"},children:(0,u.jsx)(Or.Z,{style:{color:"var(--ant-color-text)"}})})]})]}),(0,u.jsx)(Rr,{ref:this.formRef}),(0,u.jsx)(Zr,{ref:this.aboutRef}),(0,u.jsx)($a,{ref:this.generatorRef}),(0,u.jsx)(sa,{ref:this.logDrawerRef}),(0,u.jsx)(da,{ref:this.rxDrawerRef}),(0,u.jsx)(aa,{ref:this.serialModalRef}),(0,u.jsx)(Yr,{ref:this.modeModalRef})]})}}]),s}(I.Component),ti=ei;function ri(n){return Pt(),(0,u.jsx)("div",{})}var ai=ri,ii=y(18253),si=We.Z.darkAlgorithm,wt=We.Z.compactAlgorithm,ni=function(n){P()(s,n);var e=B()(s);function s(){var i;A()(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return i=e.call.apply(e,[this].concat(r)),b()(w()(i),"state",{simulate:!1,darkMode:i.isBrowserDarkMode(),isMounted:!1}),b()(w()(i),"modal",null),b()(w()(i),"renderRef",I.createRef()),b()(w()(i),"menuRef",I.createRef()),i}return T()(s,[{key:"isBrowserDarkMode",value:function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(t){return!1}}},{key:"componentDidMount",value:function(){var t=this,r=this,a=0;window.addEventListener("drop",function(c){return c.preventDefault()},!1),window.addEventListener("dragover",function(c){return c.preventDefault()},!1),window.addEventListener("contextmenu",function(c){c.target.tagName.toLowerCase()!=="input"&&c.preventDefault()},!1);function l(c){!r.modal&&c<880&&c!==a&&(a=c,r.modal=Se.warning({title:"Display Aera too Small",content:"Cannot show all contents on this window. Please resize this window or rotate your phone.",footer:null,zIndex:2500})),r.modal&&c>=880&&(r.modal.destroy(),r.modal=null)}setTimeout(function(){return l(window.innerWidth)},500),window.addEventListener("resize",function(){l(window.innerWidth)},!1);var o=window.matchMedia("(prefers-color-scheme: dark)");o.addEventListener("change",function(c){r.setState({darkMode:c.matches})}),setTimeout(function(){t.setState({isMounted:!0})},500)}},{key:"setDarkMode",value:function(t){this.setState({darkMode:t})}},{key:"render",value:function(){var t=this;return this.state.isMounted?(0,u.jsx)(Ot.ZP,{locale:ii.Z,theme:{cssVar:{key:"rmui"},hashed:!1,algorithm:this.state.darkMode?[si,wt]:wt},children:(0,u.jsxs)(Ye.Z,{children:[(0,u.jsx)("div",{className:"rmui",children:(0,u.jsxs)("div",{className:"container background-color",style:{height:"100vh",paddingBottom:12,overflow:"hidden"},children:[(0,u.jsx)(ti,{save:function(){return t.renderRef.current.save()},onObjectEvent:function(a,l){return t.renderRef.current.onObjectEvent(a,l)},onHistoryEvent:function(a){return t.renderRef.current.onHistoryEvent(a)},reset:function(){return t.renderRef.current.reset()},setFrame:function(a,l){return t.renderRef.current.onFrameEvent(a,l)},upload:function(a){return t.renderRef.current.upload(a)},getData:function(){return t.renderRef.current.getData()},setEditable:function(a){return t.renderRef.current.setEditable(a)},setDarkMode:function(a){return t.setDarkMode(a)},ref:this.menuRef,darkMode:this.state.darkMode}),(0,u.jsx)(Nt.Z,{content:["RM Ui Designer","v1.4.1"],zIndex:0,style:{height:"100%"},gap:[30,30],children:(0,u.jsx)("div",{id:"content-in",style:{width:"100vw",height:"100%",zIndex:2,position:"relative"},children:(0,u.jsx)(vr,{style:{width:"100vw",height:"100%"},editable:!0,ref:this.renderRef,onFrameChange:function(a){var l;return(l=t.menuRef.current)===null||l===void 0?void 0:l.setFrames(a)},setCouldDo:function(a){var l;(l=t.menuRef.current)===null||l===void 0||l.setCouldDo(a)},setRobotId:function(a){var l;(l=t.menuRef.current)===null||l===void 0||l.setRobotId(a)}})})})]})}),(0,u.jsx)(ai,{}),(0,u.jsx)(Sr,{}),(0,u.jsx)(Cr,{})]})}):(0,u.jsx)(Oe.Z,{})}}]),s}(I.Component),li=ni}}]);
