"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[858],{83762:function(P,Y,v){v.r(Y),v.d(Y,{default:function(){return Pr}});var vt=v(12444),I=v.n(vt),pt=v(72004),C=v.n(pt),xt=v(25098),w=v.n(xt),mt=v(31996),E=v.n(mt),gt=v(26037),N=v.n(gt),yt=v(9783),M=v.n(yt),j=v(67294),ze=v(9361),bt=v(28459),Se=v(62338),Mt=v(65848),kt=v(97857),R=v.n(kt),wt=v(15009),b=v.n(wt),jt=v(99289),S=v.n(jt),zt=v(64599),A=v.n(zt),St=v(19632),K=v.n(St),Ie=v(63084),Ce=v(32983),B=v(42075),z=v(14726),Z,It,ie,Ct=function(){var o=Se.Z.useApp();return Z=o.message,ie=o.modal,It=o.notification,null},W=v(3909),At=v(56680),Ae=v(86250),H=v(83159),Tt=v(27847),Dt=v(90420),Ot=v(99611),Et=v(94149),Nt=v(3355),Rt=v(80882),u=v(85893),Lt=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{status:n.props.defaultStatus||!1}),n}return C()(s,[{key:"render",value:function(){var t=this;return(0,u.jsx)(z.ZP,{size:"small",type:"text",onClick:function(){t.props.onChange&&t.props.onChange(!t.state.status),t.setState({status:!t.state.status})},children:this.state.status?this.props.onNode||"ON":this.props.offNode||"OFF"})}}]),s}(j.Component),Te=Lt;function Ut(o){return o.map(function(e){return e===-2?"window":"E-".concat(e)})}var Ft=[{key:"D1-group-layer",label:"layer"},{key:"D1-group-group",label:"group"}],Pt=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{treeData:[],rightClickMenuOpen:!1,groupKey:"layer"}),M()(w()(n),"treeData",[]),n}return C()(s,[{key:"selectKey2id",value:function(t){var a=this,r=[],i=A()(t),l;try{var c=function(){var p=l.value;if(p==="window")r.push(-2);else if(p.startsWith("E-"))r.push(parseInt(p.slice(2)));else{var d=a.treeData.find(function(k){return k.key===p}).children.map(function(k){return parseInt(k.key.slice(2))}),m=A()(d),g;try{for(m.s();!(g=m.n()).done;){var x=g.value;r.includes(x)||r.push(x)}}catch(k){m.e(k)}finally{m.f()}}};for(i.s();!(l=i.n()).done;)c()}catch(h){i.e(h)}finally{i.f()}return r}},{key:"onElementMenuContainerClick",value:function(t){t.target.localName==="div"&&(this.setState({rightClickMenuOpen:!1}),(t.target.classList.contains("ant-tree")||!t.ctrlKey&&!t.shiftKey)&&this.props.onSelect([]))}},{key:"onElementMenuClick",value:function(t){var a=this;if(this.setState({rightClickMenuOpen:!1}),t.key==="D2-copy"){var r=null;t.target.localName!=="input"&&this.props.selectedId.length!==0&&this.props.selectedId[0]!==-2&&(t.preventDefault(),r=JSON.stringify(this.props.selectedId.map(function(h){return a.props.data[h]})),t.clipboardData.setData("text",r))}else if(t.key==="D2-delete"){var i=A()(this.props.selectedId),l;try{for(i.s();!(l=i.n()).done;){var c=l.value;this.props.onObjectEvent("remove",{id:c})}}catch(h){i.e(h)}finally{i.f()}}}},{key:"onElementRightClick",value:function(t){var a=this.selectKey2id([t.node.key]);a[0]in this.props.selectedId||this.props.onSelect(a)}},{key:"onSelect",value:function(t){if(t.length!==0){var a=this.selectKey2id(t);a.includes(-2)&&(a=[a[a.length-1]]),this.props.onSelect(a)}}},{key:"onMenuOpenChange",value:function(t){if(t){var a=this;setTimeout(function(){a.props.selectedId.length!==0&&a.props.selectedId[0]!==-2?a.setState({rightClickMenuOpen:!0}):a.setState({rightClickMenuOpen:!1})},100)}else this.setState({rightClickMenuOpen:!1})}},{key:"elementsMenuOnClick",value:function(t){var a=this;this.setState({groupKey:t.key.slice(9)},function(){return a.updateTree()})}},{key:"updateTree",value:function(){for(var t=this,a=this.state.groupKey,r=[],i=Object.keys(this.props.data),l=function(){for(var p=t.props.data[i[c]],d=-1,m=0;m<r.length;m++)if(r[m].key==="".concat(a,"-").concat(p[a])){d=m;break}d===-1&&(r.push({title:"".concat(a," ").concat(p[a]),key:"".concat(a,"-").concat(p[a]),children:[],isLeaf:!1}),d=r.length-1),r[d].children.push({title:(0,u.jsxs)(Ae.Z,{justify:"space-between",style:{width:"100%"},children:[p.name,(0,u.jsxs)(B.Z,{children:[(0,u.jsx)(Te,{onChange:function(x){return t.props.onObjectEvent("setAttr",{id:p.id,payload:{visible:x}})},defaultStatus:!0,offNode:(0,u.jsx)(Dt.Z,{}),onNode:(0,u.jsx)(Ot.Z,{})}),(0,u.jsx)(Te,{onChange:function(x){return t.props.onObjectEvent("setAttr",{id:p.id,payload:{selectable:x}})},defaultStatus:!0,offNode:(0,u.jsx)(Et.Z,{}),onNode:(0,u.jsx)(Nt.Z,{style:{transform:"scaleX(-1)"}})})]})]}),key:"E-".concat(i[c])})},c=0;c<i.length;c++)l();return r=r.sort(function(h,p){return h.key.toString().localeCompare(p.key.toString())}),r.unshift({title:"UI Window",key:"window"}),this.treeData=r,r}},{key:"render",value:function(){var t=this;return(0,u.jsx)(Ie.Z,{size:"small",title:"Elements",style:{height:"100%"},extra:(0,u.jsx)(H.Z,{menu:{items:Ft,onClick:function(r){return t.elementsMenuOnClick(r)},selectable:!0,selectedKeys:["D1-group-".concat(this.state.groupKey)]},children:(0,u.jsxs)(B.Z,{style:{fontSize:11},children:["Group by",(0,u.jsx)(Rt.Z,{size:"small"})]})}),children:(0,u.jsx)("div",{className:"card-body",onMouseUp:function(r){return t.onElementMenuContainerClick(r)},children:(0,u.jsx)(H.Z,{menu:{items:[{key:"D2-copy",label:"Copy"},{key:"D2-delete",label:"Delete",danger:!0}],onClick:function(r){t.onElementMenuClick(r)}},trigger:["contextMenu"],open:this.state.rightClickMenuOpen,onOpenChange:function(r){t.onMenuOpenChange(r)},children:(0,u.jsx)(Tt.Z,{className:"full",treeData:this.updateTree(),onSelect:function(r){return t.onSelect(r)},selectedKeys:Ut(this.props.selectedId),onRightClick:function(r){return t.onElementRightClick(r)},treeDefaultExpandAll:!0,showLine:!0,blockNode:!0,multiple:!0,selectable:this.props.editable})})})})}}]),s}(j.Component),Zt=Pt,D=v(32777),J=v(17990),Bt=v(55733),Wt=v.n(Bt),Q=document.createElement("a"),G=document.createElement("input");G.type="file";var T={yellow:"rgb(255, 238, 70)",green:"rgb(168, 255, 45)",orange:"rgb(255, 163, 8)",purple:"rgb(240, 41, 246)",pink:"rgb(255, 100, 142)",cyan:"rgb(69, 255, 242)",white:"#fff",black:"#000",blue:"rgb(47, 168, 223)",red:"rgb(255, 69, 70)"};function De(o){var e=o.split(".").pop();return{name:e+" file",extensions:[e]}}function Oe(o,e){if(V())S()(b()().mark(function t(){var a;return b()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,J.WZ.save({filters:[De(e)],defaultPath:e});case 2:if(a=i.sent,!(a!==null&&a.length>0)){i.next=6;break}return i.next=6,J.fs.writeTextFile(a,o);case 6:case"end":return i.stop()}},t)}))();else{var s=new Blob([o],{type:"text/plain;charset=utf-8"}),n=URL.createObjectURL(s);Q.href=n,Q.download=e,Q.click(),URL.revokeObjectURL(n)}}function Ee(o,e){if(V())S()(b()().mark(function n(){var t,a;return b()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,J.WZ.save({filters:[De(e)],defaultPath:e});case 2:if(t=i.sent,!(t!==null&&t.length>0)){i.next=9;break}return i.next=6,o.arrayBuffer();case 6:return a=i.sent,i.next=9,J.fs.writeBinaryFile(t,a);case 9:case"end":return i.stop()}},n)}))();else{var s=URL.createObjectURL(o);Q.href=s,Q.download=e,Q.click(),URL.revokeObjectURL(s)}}function Yt(o,e,s){var n={version:2,data:o,selected:s},t=JSON.stringify(n);Oe(t,e)}function Ht(o){var e=null;return window.createObjcectURL!==void 0?e=window.createOjcectURL(o):window.URL!==void 0?e=window.URL.createObjectURL(o):window.webkitURL!==void 0&&(e=window.webkitURL.createObjectURL(o)),e}function V(){return window!==void 0&&window.__TAURI__!==void 0}function Gt(o){return ne.apply(this,arguments)}function ne(){return ne=S()(b()().mark(function o(e){var s;return b()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=new(Wt()),e.forEach(function(a){s.file(a.fileName,a.content)}),t.next=4,s.generateAsync({type:"blob"});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},o)})),ne.apply(this,arguments)}function Ne(o){return se.apply(this,arguments)}function se(){return se=S()(b()().mark(function o(e){var s,n,t;return b()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:s=[];for(n in e)for(t in e[n])s.push({fileName:"".concat(n,".").concat(t),content:e[n][t]});return r.next=4,Gt(s);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}},o)})),se.apply(this,arguments)}function Re(o){return new Promise(function(e,s){if(V()){var n=[o.slice(1)],t="".concat(n," file");o==="image/*"&&(n=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],t="image"),S()(b()().mark(function a(){var r,i,l,c,h;return b()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,J.WZ.open({multiple:!1,directory:!1,filters:[{name:t,extensions:n}]});case 2:if(r=d.sent,!(r!==null&&r.length>0)){d.next=16;break}return i=r.replace(/\\/g,"/"),l=i.split("/").pop(),d.t0=Blob,d.next=9,J.fs.readBinaryFile(r);case 9:d.t1=d.sent,d.t2=[d.t1],c=new d.t0(d.t2),h=new File([c],l),e(h),d.next=17;break;case 16:s();case 17:case"end":return d.stop()}},a)}))()}else G.accept=o,G.value="",G.onchange=function(){if(G.files.length>0){var a=G.files[0];e(a)}else s(new Error("No file selected"))},G.click()})}function _(o){return document.getElementById("content-in").contains(o)||o.getAttribute("contentEditable")==="true"?!0:o.tagName==="INPUT"||o.tagName==="TEXTAREA"}var $t=function(o){E()(s,o);var e=N()(s);function s(){return I()(this,s),e.apply(this,arguments)}return C()(s,[{key:"render",value:function(){return this.props.color==="Main"?(0,u.jsxs)("div",{children:[(0,u.jsxs)("div",{style:{border:"1px solid #aaa",height:16,width:16,borderRadius:"20%",display:"inline-flex"},children:[(0,u.jsx)("div",{style:{backgroundColor:"red",height:12,width:6,margin:"1px 0 1px 1px",borderTopLeftRadius:"20%",borderBottomLeftRadius:"20%",display:"inline-flex"}}),(0,u.jsx)("div",{style:{backgroundColor:"blue",height:12,width:6,margin:"1px 1px 1px 0",borderTopRightRadius:"20%",borderBottomRightRadius:"20%",display:"inline-flex"}})]}),"\xA0 Main"]}):(0,u.jsx)("div",{children:(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{style:{border:"1px solid #aaa",height:16,width:16,borderRadius:"20%",display:"inline-flex"},children:(0,u.jsx)("div",{style:{backgroundColor:T[this.props.color.toLowerCase()],height:12,width:12,margin:1,borderRadius:"20%",display:"inline-flex"}})}),"\xA0 ",this.props.color]})})}}]),s}(j.Component),U=$t,Le={id:{title:"Id",key:"id",dataIndex:"id",valueType:"digit",editable:!1},name:{title:"Name",key:"name",dataIndex:"name"},group:{title:"Group",key:"group",dataIndex:"group"},kind:{title:"Kind",key:"kind",dataIndex:"kind",editable:!1},lineWidth:{title:"Line Width",key:"lineWidth",dataIndex:"lineWidth",valueType:"digit"},layer:{title:"Layer",key:"layer",dataIndex:"layer",valueType:"digit"},x:{title:"X",key:"x",dataIndex:"x",valueType:"digit"},y:{title:"Y",key:"y",dataIndex:"y",valueType:"digit"},x2:{title:"X2",key:"x2",dataIndex:"x2",valueType:"digit"},y2:{title:"Y2",key:"y2",dataIndex:"y2",valueType:"digit"},width:{title:"Width",key:"width",dataIndex:"width",valueType:"digit"},height:{title:"Height",key:"height",dataIndex:"height",valueType:"digit"},rx:{title:"Rx",key:"rx",dataIndex:"rx",valueType:"digit"},ry:{title:"Ry",key:"ry",dataIndex:"ry",valueType:"digit"},r:{title:"R",key:"r",dataIndex:"r",valueType:"digit"},startAngle:{title:"Start Angle",key:"startAngle",dataIndex:"startAngle",valueType:"digit"},endAngle:{title:"End Angle",key:"endAngle",dataIndex:"endAngle",valueType:"digit"},fontSize:{title:"Font Size",key:"fontSize",dataIndex:"fontSize",valueType:"digit"},float:{title:"Number",key:"float",dataIndex:"float",valueType:"digit"},number:{title:"Number",key:"number",dataIndex:"number",valueType:"digit"},text:{title:"Text",key:"text",dataIndex:"text",formItemProps:{rules:[{max:30},{type:"string"}]}},color:{title:"Color",key:"color",dataIndex:"color",valueType:"select",valueEnum:{main:(0,u.jsx)(U,{color:"Main"}),yellow:(0,u.jsx)(U,{color:"Yellow"}),green:(0,u.jsx)(U,{color:"Green"}),orange:(0,u.jsx)(U,{color:"Orange"}),purple:(0,u.jsx)(U,{color:"Purple"}),pink:(0,u.jsx)(U,{color:"Pink"}),cyan:(0,u.jsx)(U,{color:"Cyan"}),black:(0,u.jsx)(U,{color:"Black"}),white:(0,u.jsx)(U,{color:"White"})}},team:{title:"Team",key:"team",dataIndex:"team",valueType:"select",valueEnum:{red:(0,u.jsx)(U,{color:"Red"}),blue:(0,u.jsx)(U,{color:"Blue"})}},role:{title:"Role",key:"role",dataIndex:"role",valueType:"select",valueEnum:{1:"Hero",2:"Engineer",3:"No3. Infantry",4:"No4. Infantry",5:"No5. Infantry",6:"Drone"}},backgroundImage:{title:"Background Image",key:"backgroundImage",dataIndex:"backgroundImage",valueType:"switch"}};function Jt(o){for(var e=Object.keys(o),s=[],n=0;n<e.length;n++)Le[e[n]]&&s.push(Le[e[n]]);return s}var Qt=D.fabric.util.createClass(D.fabric.Rect,{type:"UiRect",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(e){e||(e={}),e.color||(e.color="main"),this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.groupName,this.ratio=e.ratio,this._color=e.color,this.team=e.team,e.lockRotation=!0,e.lockScalingFlip=!0,e.hasRotatingPoint=!1,e.width||(e.width=50/this.ratio),e.height||(e.height=50/this.ratio),e.left||(e.left=50/this.ratio),e.top||(e.top=50/this.ratio),e.strokeWidth||(e.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?e.stroke=T[this._color]:(e.stroke=T[e.team],this._color="main"),e.fill=null,this.callSuper("initialize",e),this.moveTo(e.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){this.set("width",Math.round(this.width*this.scaleX*this.ratio)/this.ratio),this.set("height",Math.round(this.height*this.scaleY*this.ratio)/this.ratio),this.set("left",Math.round(this.left*this.ratio)/this.ratio),this.set("top",Math.round(this.top*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,width:this.width*this.ratio,height:this.height*this.ratio,x:this.left*this.ratio,y:this.top*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(e){this._color=e.color,this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.group,this.set("width",e.width/this.ratio),this.set("height",e.height/this.ratio),this.set("left",e.x/this.ratio),this.set("top",e.y/this.ratio),this.set("strokeWidth",e.lineWidth/this.ratio),this._color==="main"?this.set("stroke",T[this.team]):this.set("stroke",T[this._color]),this.moveTo(e.layer)},setRatio:function(e){this.set("width",this.width*this.ratio/e),this.set("height",this.height*this.ratio/e),this.set("left",this.left*this.ratio/e),this.set("top",this.top*this.ratio/e),this.set("strokeWidth",this.strokeWidth*this.ratio/e),this.ratio=e},setTeam:function(e){this.team=e,this._color==="main"&&this.set("stroke",T[this.team])}}),Vt=D.fabric.util.createClass(D.fabric.Line,{type:"UiLine",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(e){e||(e={}),e.color||(e.color="main"),this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.groupName,this.ratio=e.ratio,this._color=e.color,this.team=e.team,e.lockRotation=!0,e.lockScalingFlip=!0,e.hasRotatingPoint=!1,e.x1||(e.x1=50/this.ratio),e.y1||(e.y1=50/this.ratio),e.x2||(e.x2=100/this.ratio),e.y2||(e.y2=100/this.ratio),e.strokeWidth||(e.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?e.stroke=T[this._color]:(e.stroke=T[e.team],this._color="main"),e.fill=null,this.callSuper("initialize",[e.x1,e.y1,e.x2,e.y2],e),this.moveTo(e.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){var e=this.left,s=this.top,n=Math.round((this.x2-this.x1)*this.scaleX),t=Math.round((this.y2-this.y1)*this.scaleY);t<0&&(s=s+t,t=Math.abs(t)),n<0&&(e=e+n,n=Math.abs(n)),this.set("x1",Math.round(e*this.ratio)/this.ratio),this.set("y1",Math.round(s*this.ratio)/this.ratio),this.set("x2",Math.round((e+n)*this.ratio)/this.ratio),this.set("y2",Math.round((s+t)*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,x:this.x1*this.ratio,y:this.y1*this.ratio,x2:this.x2*this.ratio,y2:this.y2*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(e){this._color=e.color,this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.group,this.set("x2",e.x2/this.ratio),this.set("y2",e.y2/this.ratio),this.set("x1",e.x/this.ratio),this.set("y1",e.y/this.ratio),this.set("strokeWidth",e.lineWidth/this.ratio),this._color==="main"?this.set("stroke",T[this.team]):this.set("stroke",T[this._color]),this.moveTo(e.layer)},setRatio:function(e){this.set("x1",this.x1*this.ratio/e),this.set("y1",this.y1*this.ratio/e),this.set("x2",this.x2*this.ratio/e),this.set("y2",this.y2*this.ratio/e),this.set("strokeWidth",this.strokeWidth*this.ratio/e),this.ratio=e},setTeam:function(e){this.team=e,this._color==="main"&&this.set("stroke",T[this.team])}}),le=D.fabric.util.createClass(D.fabric.Ellipse,{type:"UiEllipse",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(e){e||(e={}),e.color||(e.color="main"),this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.groupName,this.ratio=e.ratio,this._color=e.color,this.team=e.team,e.lockRotation=!0,e.lockScalingFlip=!0,e.hasRotatingPoint=!1,e.rx||(e.rx=50/this.ratio),e.ry||(e.ry=50/this.ratio),e.left||(e.left=50/this.ratio),e.top||(e.top=50/this.ratio),e.strokeWidth||(e.strokeWidth=1/this.ratio),this._color&&this._color!=="main"?e.stroke=T[this._color]:(e.stroke=T[e.team],this._color="main"),e.fill=null,this.callSuper("initialize",e),this.moveTo(e.layer),this.setControlVisible("mtr",!1),this.transparentCorners=!1},resizeScale:function(){this.set("rx",Math.round(this.rx*this.scaleX*this.ratio)/this.ratio),this.set("ry",Math.round(this.ry*this.scaleY*this.ratio)/this.ratio),this.set("left",Math.round(this.left*this.ratio)/this.ratio),this.set("top",Math.round(this.top*this.ratio)/this.ratio),this.set("scaleX",1),this.set("scaleY",1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,rx:this.rx*this.ratio,ry:this.ry*this.ratio,x:(this.left+this.rx)*this.ratio,y:(this.top+this.ry)*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(e){this._color=e.color,this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.group,this.set("rx",e.rx/this.ratio),this.set("ry",e.ry/this.ratio),this.set("left",(e.x-e.rx)/this.ratio),this.set("top",(e.y-e.ry)/this.ratio),this.set("strokeWidth",e.lineWidth/this.ratio),this._color==="main"?this.set("stroke",T[this.team]):this.set("stroke",T[this._color]),this.moveTo(e.layer)},setRatio:function(e){this.set("rx",this.rx*this.ratio/e),this.set("ry",this.ry*this.ratio/e),this.set("left",this.left*this.ratio/e),this.set("top",this.top*this.ratio/e),this.set("strokeWidth",this.strokeWidth*this.ratio/e),this.ratio=e},setTeam:function(e){this.team=e,this._color==="main"&&this.set("stroke",T[this.team])}}),Kt=D.fabric.util.createClass(le,{type:"UiRound",r:50,initialize:function(e){e||(e={}),e.r||(e.r=50/this.ratio),e.rx=e.r,e.ry=e.r,this.callSuper("initialize",e),this.setControlVisible("ml",!1),this.setControlVisible("mb",!1),this.setControlVisible("mr",!1),this.setControlVisible("mt",!1)},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,r:this.rx*this.ratio,x:(this.left+this.rx)*this.ratio,y:(this.top+this.ry)*this.ratio,color:this._color,lineWidth:this.strokeWidth*this.ratio}},fromObject:function(e){e.rx=e.r,e.ry=e.r,this.callSuper("fromObject",e)}}),Xt=D.fabric.util.createClass(le,{type:"UiArc",startAngle:0,endAngle:90,initialize:function(e){e||(e={}),e.startAngle||(e.startAngle=0),e.endAngle||(e.endAngle=90),this.callSuper("initialize",e),this.startAngle=e.startAngle,this.endAngle=e.endAngle,this.set("dirty",!0)},toObject:function(){return D.fabric.util.object.extend(this.callSuper("toObject"),{startAngle:this.startAngle,endAngle:this.endAngle})},_render:function(e){var s=(this.startAngle-90)*(Math.PI/180),n=(this.endAngle-90)*(Math.PI/180);e.beginPath(),e.ellipse(0,0,this.rx,this.ry,0,s,n,!1),e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke()},fromObject:function(e){this.set("startAngle",e.startAngle),this.set("endAngle",e.endAngle),this.set("ry",1),this.callSuper("fromObject",e)}});function ee(o,e){var s=ee.canvas||(ee.canvas=document.createElement("canvas")),n=s.getContext("2d");n.font=e;var t=n.measureText(o);return t.width}var oe=D.fabric.util.createClass(D.fabric.Text,{type:"UiText",id:0,name:"",layer:0,groupName:"",ratio:1,_color:"",team:"red",initialize:function(e){e||(e={}),e.color||(e.color="main"),this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.groupName,this.ratio=e.ratio,this._color=e.color,this.team=e.team,e.flipY=!0,e.fontSize||(e.fontSize=20/this.ratio),e.fontFamily||(e.fontFamily="ds-digitalnormal"),e.text||(e.text="Text"),e.left||(e.left=50/this.ratio),e.top||(e.top=50/this.ratio),e.width||(e.width=ee(e.text,e.fontSize+"px "+e.fontFamily)/this.ratio),this._color&&this._color!=="main"?e.fill=T[this._color]:(e.fill=T[e.team],this._color="main"),this.callSuper("initialize",e.text,e),this.moveTo(e.layer),this.setControlsVisibility({tl:!1,tr:!1,bl:!1,br:!1,ml:!1,mt:!1,mr:!1,mb:!1,mtr:!1})},toObject:function(){return{type:this.type,id:this.id,name:this.name,layer:this.layer,group:this.groupName,fontSize:this.fontSize*this.ratio,x:this.left*this.ratio,y:this.top*this.ratio,text:this.text,color:this._color}},fromObject:function(e){this._color=e.color,this.id=e.id,this.name=e.name,this.layer=e.layer,this.groupName=e.group,this.set("left",e.x/this.ratio),this.set("top",e.y/this.ratio),this.set("fontSize",e.fontSize/this.ratio),this.text=e.text,this.set("width",ee(e.text,e.fontSize+"px "+this.fontFamily)/this.ratio),this._color==="main"?this.set("fill",T[this.team]):this.set("fill",T[this._color]),this.moveTo(e.layer),this.set("fontFamily","ds-digitalnormal")},setRatio:function(e){this.set("width",this.width*this.ratio/e),this.set("left",this.left*this.ratio/e),this.set("top",this.top*this.ratio/e),this.set("fontSize",this.fontSize*this.ratio/e),this.ratio=e},resizeScale:function(){},setTeam:function(e){this.team=e,this._color==="main"&&this.set("fill",T[this.team])}}),qt=D.fabric.util.createClass(oe,{type:"UiNumber",number:12345,initialize:function(e){e||(e={}),this.number=e.number||12345,e.text=this.number.toString(),this.callSuper("initialize",e)},toObject:function(){var e=this.callSuper("toObject");return e.number=this.number,delete e.text,e},fromObject:function(e){this.number=parseInt(e.number),e.text=this.number.toString(),this.callSuper("fromObject",e)}}),_t=D.fabric.util.createClass(oe,{type:"UiFloat",float:12.345,initialize:function(e){e||(e={}),this.float=e.float||12.345,e.text=this.float.toString(),this.callSuper("initialize",e)},toObject:function(){var e=this.callSuper("toObject");return e.float=this.float,delete e.text,e},fromObject:function(e){this.float=parseFloat(e.float),e.text=this.float.toString(),this.callSuper("fromObject",e)}}),Ue={Rect:Qt,Line:Vt,Round:Kt,Ellipse:le,Arc:Xt,Text:oe,Number:qt,Float:_t};function ea(o){var e={id:o.id,name:o.name,layer:o.layer,groupName:o.group,ratio:o.ratio,team:o.team},s=o.type.slice(2);return s==="Text"&&Z.warning("Text object is beta now, maybe not same with client!"),new Ue[s](e)}function ta(){for(var o=[],e=0,s=Object.keys(Ue);e<s.length;e++){var n=s[e];o.push({key:"Insert-".concat(n),label:n})}return o}function ce(o,e,s,n){return ue.apply(this,arguments)}function ue(){return ue=S()(b()().mark(function o(e,s,n,t){var a,r,i,l,c,h,p,d,m,g;return b()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(e){k.next=2;break}return k.abrupt("return");case 2:if(a=1,e.version&&(a=e.version),a!==1){k.next=10;break}return k.next=7,n("default");case 7:for(r=0,i=Object.keys(e);r<i.length;r++)l=i[r],s("_update",e[l]);k.next=22;break;case 10:if(a!==2){k.next=22;break}c=0,h=Object.keys(e.data);case 12:if(!(c<h.length)){k.next=20;break}return p=h[c],k.next=16,n(p);case 16:for(d=0,m=Object.keys(e.data[p]);d<m.length;d++)g=m[d],s("_update",e.data[p][g]);case 17:c++,k.next=12;break;case 20:return k.next=22,n(e.selected);case 22:t();case 23:case"end":return k.stop()}},o)})),ue.apply(this,arguments)}var aa=v(96486),Fe=v.n(aa);function Pe(o){return o.head>0?R()({},o.data[o.head-1]):null}function Ze(o){return o.head<o.data.length-1?R()({},o.data[o.head+1]):null}var ra=function(){function o(){I()(this,o),M()(this,"cacheTimer",null),M()(this,"updateTimer",null),M()(this,"now",null),M()(this,"_previous",null),M()(this,"_next",null),M()(this,"his",null),M()(this,"catchUpdate",!0);var e=localStorage.getItem("history"),s={data:[{}],head:0,version:1};e?s=JSON.parse(e):(e=localStorage.getItem("data"),e?s.data[0]=JSON.parse(e):s.data[0]={version:2,data:{default:{}},selected:"default"},localStorage.setItem("history",JSON.stringify(s))),this.now=s.data[s.head],this._previous=Pe(s),this._next=Ze(s)}return C()(o,[{key:"save",value:function(){var s=this;this.cacheTimer&&clearTimeout(this.cacheTimer),this.cacheTimer=setTimeout(function(){s.his.head>50&&(s.his.data=s.his.data.slice(s.his.head-50),s.his.head=50),s.his.head<s.his.data.length-20&&(s.his.data=s.his.data.slice(0,s.his.head+20)),localStorage.setItem("history",JSON.stringify(s.his)),s.his=null},2e3)}},{key:"read",value:function(){this.his||(this.his=JSON.parse(localStorage.getItem("history")))}},{key:"get",value:function(){return this.catchUpdate?(console.log(this.his),{now:this.now,couldNext:this._next!==null,couldPrevious:this._previous!==null}):{now:this.now,couldNext:!1,couldPrevious:!1}}},{key:"reset",value:function(s){return this._previous=null,this._next=null,this.his={data:[s],head:0,version:1},console.log(this.his),this.save(),this.get()}},{key:"next",value:function(){return this._next&&(this._previous=this.now,this.now=this._next,this.read(),this.his.head++,this._next=Ze(this.his),this.save()),this.get()}},{key:"previous",value:function(){return this._previous&&(this._next=this.now,this.now=this._previous,this.read(),this.his.head--,this._previous=Pe(this.his),this.save()),this.get()}},{key:"cancelUpdate",value:function(){this.updateTimer&&clearTimeout(this.updateTimer)}},{key:"update",value:function(s){var n=this;this.catchUpdate&&(this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(function(){Fe().isEqual(s,n.now)||(n._previous=n.now,n.now=s,n.read(),n.his.data=n.his.data.slice(0,n.his.head+1),n.his.data.push(s),n.his.head++,n._next=null,n.save())},500))}}]),o}(),ia=ra,na=v(30819),sa=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"objects",{default:{}}),M()(w()(n),"data",{}),M()(w()(n),"state",{properties:null,selectedId:[],frame:"default",uiWindow:{height:1080,width:1920,ratio:1,team:"red",role:1,backgroundImage:!0},infoModalShow:!1,data:{},editable:!0}),M()(w()(n),"canvas",null),M()(w()(n),"canvasRef",(0,j.createRef)()),M()(w()(n),"propertiesRef",(0,j.createRef)()),M()(w()(n),"background",null),M()(w()(n),"his",new ia),M()(w()(n),"moveTimer",null),M()(w()(n),"moveTimeout",null),n}return C()(s,[{key:"getNewDataId",value:function(){return Object.keys(this.state.data).length===0?0:Math.max.apply(Math,K()(Object.keys(this.state.data)))+1}},{key:"setEditable",value:function(t){this.setState({editable:t}),this.his.catchUpdate=t,this.canvas.selection=t,D.fabric.Object.prototype.selectable=t;var a=this.canvas.getObjects();if(t){var r=A()(a),i;try{for(r.s();!(i=r.n()).done;){var l=i.value;l.set("selectable",!0)}}catch(d){r.e(d)}finally{r.f()}}else{var c=A()(a),h;try{for(c.s();!(h=c.n()).done;){var p=h.value;p.set("selectable",!1)}}catch(d){c.e(d)}finally{c.f()}}this.select([])}},{key:"setRobotId",value:function(){var t=this.state.uiWindow.role;this.state.uiWindow.team==="blue"&&(t+=100),this.props.setRobotId(t)}},{key:"cancelHistoryUpdate",value:function(){var t=this;this.his.cancelUpdate(),setTimeout(function(){t.his.cancelUpdate(),t.props.setCouldDo(t.his.get())},200)}},{key:"save",value:function(){Yt(this.data,"ui.rmui",this.state.frame)}},{key:"updateHistory",value:function(){var t=this;setTimeout(function(){var a={version:2,data:t.data,selected:t.state.frame};Fe().isEqual(a,t.his.now)||(t.his.update(a),t.props.setCouldDo({couldNext:!1,couldPrevious:!0}))},100)}},{key:"getData",value:function(){return this.data}},{key:"select",value:function(t,a){var r=this;if(t.length===0)this.setState({properties:null,selectedId:[]}),this.canvas.discardActiveObject(),this.canvas.renderAll();else if(t[0]===-2)this.setState({properties:this.state.uiWindow,selectedId:[-2]}),this.canvas.discardActiveObject(),this.canvas.renderAll();else if(t.length===1)this.setState({properties:this.state.data[t[0]],selectedId:[t[0]]}),this.canvas.setActiveObject(this.objects[this.state.frame][t[0]]),this.canvas.renderAll();else if(this.setState({properties:null,selectedId:t}),!a){var i=t.map(function(c){return r.objects[r.state.frame][c]}),l=new D.fabric.ActiveSelection(i,{canvas:this.canvas,hasControls:!1});this.canvas.setActiveObject(l),this.canvas.renderAll()}}},{key:"reset",value:function(){var n=S()(b()().mark(function a(){var r,i,l,c=arguments;return b()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(r=c.length>0&&c[0]!==void 0?c[0]:!1,r){i=this.canvas.getObjects();for(l in i)this.canvas.remove(i[l]);this.canvas.renderAll()}else this.canvas.clear(),this.setBackground(v(25665)),this.canvas.backgroundColor="#fff";if(Object.keys(this.objects).includes("default")){p.next=5;break}return p.next=5,this.onFrameEvent("add","default");case 5:return this.objects.default={},p.next=8,this.onFrameEvent("change","default");case 8:this.objects={default:{}},this.props.onFrameChange({frames:["default"],selected:"default"}),this.select([]),this.resetCanvasSize(),this.objectsToData();case 13:case"end":return p.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"resetCanvasSize",value:function(){if(this.canvas){var t,a=this.canvasRef.current.clientWidth,r=this.canvasRef.current.clientHeight,i=R()({},this.state.uiWindow);a/r<i.width/i.height?(r=a*i.height/i.width,i.ratio=i.width/a):(a=r*i.width/i.height,i.ratio=i.height/r),this.setState({uiWindow:i}),this.canvas.setHeight(r),this.canvas.setWidth(a),this.canvas.viewportTransform[5]=r,this.canvas.viewportTransform[3]=-1;var l=this.canvasRef.current.clientWidth,c=this.canvasRef.current.clientHeight,h=l-a,p=c-r,d=document.getElementById("coordinateDisplay");d.style.right="".concat(h+12,"px"),d.style.bottom="".concat(p+25,"px");for(var m=0,g=Object.keys(this.objects[this.state.frame]);m<g.length;m++){var x=g[m];this.objects[this.state.frame][x].setRatio(i.ratio)}(t=this.background)===null||t===void 0||t.set({scaleX:1/i.ratio,scaleY:1/i.ratio}),this.canvas.renderAll(),this.objectsToData(),this.setState({infoModalShow:!1})}}},{key:"onPropertiesChange",value:function(t,a){var r=this;if(this.state.selectedId[0]===-2){if(a.team!==this.state.uiWindow.team){for(var i=0,l=Object.keys(this.objects[this.state.frame]);i<l.length;i++){var c=l[i];this.objects[this.state.frame][c].setTeam(a.team)}this.canvas.renderAll(),this.objectsToData()}if(this.setState({uiWindow:a,properties:a},function(){r.resetCanvasSize(),r.setRobotId()}),a.backgroundImage!==this.state.uiWindow.backgroundImage)if(a.backgroundImage){var h,p=this.state.uiWindow.ratio;(h=this.background)===null||h===void 0||h.set({scaleX:1/p,scaleY:1/p}),this.canvas.setBackgroundImage(this.background),this.canvas.renderAll()}else this.canvas.setBackgroundImage(null),this.canvas.renderAll();(a.width!==this.state.uiWindow.width||a.height!==this.state.uiWindow.height)&&ie.warning({title:"Warning",content:"Modify UI window width and height may cause unknown error."})}else this.state.selectedId.length===1&&(this.objects[this.state.frame][this.state.selectedId[0]].fromObject(a),this.canvas.renderAll(),this.objectsToData(),this.updateHistory())}},{key:"setBackground",value:function(t){var a=this;D.fabric.Image.fromURL(t,function(r,i){var l;a.background=r;var c=a.state.uiWindow.ratio;(l=a.background)===null||l===void 0||l.set({scaleX:1/c,scaleY:-1/c}),a.state.uiWindow.backgroundImage&&(a.canvas.setBackgroundImage(a.background),a.canvas.renderAll())})}},{key:"componentDidMount",value:function(){var t=this,a=this;this.canvas=new D.fabric.Canvas("ui"),this.setBackground(v(25665)),this.canvas.backgroundColor="#fff",window.addEventListener("resize",function(){t.resetCanvasSize()},!1),window.addEventListener("copy",function(i){var l=null;console.log(i.target,_(i.target)),!_(i.target)&&a.state.selectedId.length!==0&&a.state.selectedId[0]!==-2&&(i.preventDefault(),l=JSON.stringify(a.state.selectedId.map(function(c){return a.state.data[c]})),i.clipboardData.setData("text",l))}),window.addEventListener("paste",function(i){for(var l=!1,c=i.clipboardData.items,h=0;h<c.length;h++)if(c[h].type.indexOf("image")===0){i.preventDefault(),l=!0;var p=c[h].getAsFile(),d=new FileReader;d.onload=function($){a.setBackground($.target.result)},d.readAsDataURL(p)}if(!l&&!_(i.target))try{i.preventDefault();var m=i.clipboardData.getData("text"),g=JSON.parse(m);Array.isArray(g)||(g=[g]);var x=[],k=20,O=A()(g),F;try{var y=function(){var je=F.value;setTimeout(function(){je.id=a.getNewDataId(),x.push(je.id),a.onObjectEvent("_update",je)},k),k+=20};for(O.s();!(F=O.n()).done;)y()}catch($){O.e($)}finally{O.f()}setTimeout(function(){a.select(x),t.updateHistory()},k)}catch($){Z.warning("Invalid data")}}),window.addEventListener("keydown",function(i){if(i.key==="Delete"&&a.state.selectedId.length!==0&&a.state.selectedId[0]!==-2){var l=A()(a.state.selectedId),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;a.onObjectEvent("remove",{id:h})}}catch(m){l.e(m)}finally{l.f()}t.updateHistory()}if(i.ctrlKey&&i.key==="z"&&!i.shiftKey?(i.preventDefault(),t.onHistoryEvent("previous")):i.ctrlKey&&(0,na.toLower)(i.key)==="z"&&i.shiftKey&&(i.preventDefault(),t.onHistoryEvent("next")),["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(i.key)&&!_(i.target)){var p=function(g,x){switch(x*=a.state.uiWindow.ratio,g){case"ArrowUp":d.top+=x;break;case"ArrowDown":d.top-=x;break;case"ArrowLeft":d.left-=x;break;case"ArrowRight":d.left+=x;break}d instanceof D.fabric.ActiveSelection?d.getObjects().forEach(function(k){k.setCoords(),k.resizeScale()}):(d.setCoords(),d.resizeScale()),a.canvas.renderAll(),a.objectsToData(),a.updateHistory()},d=a.canvas.getActiveObject();if(!d)return;i.preventDefault(),p(i.key,2),t.moveTimeout&&clearTimeout(t.moveTimeout),t.moveTimer&&clearInterval(t.moveTimer),t.moveTimeout=setTimeout(function(){t.moveTimer=setInterval(function(){p(i.key,1)},500)},1500)}}),window.addEventListener("keyup",function(i){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(i.key)&&(clearTimeout(t.moveTimeout),clearInterval(t.moveTimer))}),this.canvas.on({"mouse:up":function(){for(var l=0,c=Object.keys(a.objects[a.state.frame]);l<c.length;l++){var h=c[l];a.objects[a.state.frame][h].resizeScale()}a.canvas.renderAll(),a.objectsToData(),a.updateHistory();var p=a.canvas.getActiveObject();setTimeout(function(){if(p)if(p instanceof D.fabric.ActiveSelection){var d=p.getObjects().map(function(m){return m.id});a.select(d,!0)}else a.select([p.id]);else a.select([])},100)},"mouse:move":function(l){var c=t.canvas.getPointer(l.e),h=t.state.uiWindow.ratio,p=Math.round(c.x*h),d=Math.round(c.y*h),m=document.getElementById("coordinateDisplay");m.style.display="block",m.textContent="x: ".concat(p,", y: ").concat(d)},"mouse:out":function(){var l=document.getElementById("coordinateDisplay");l.style.display="none"}});var r=this.his.get();this.props.setCouldDo(r),ce(r.now,function(i,l){return t.onObjectEvent(i,l)},function(i){return a.onFrameEvent("change",i)},function(){return t.canvas.renderAll()}).then(function(){t.setRobotId(),t.resetCanvasSize()}),this.cancelHistoryUpdate()}},{key:"upload",value:function(){var t=this,a=this;Re(".rmui").then(function(r){var i=new FileReader;i.onload=function(){var l=S()(b()().mark(function c(h){return b()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,a.reset();case 2:return d.next=4,ce(JSON.parse(h.target.result),function(m,g){return a.onObjectEvent(m,g)},function(m){return a.onFrameEvent("change",m)},function(){return a.canvas.renderAll()}).then(function(){t.setRobotId()});case 4:a.objectsToData(),a.his.reset({version:2,data:t.data,selected:t.state.frame});case 6:case"end":return d.stop()}},c)}));return function(c){return l.apply(this,arguments)}}(),i.readAsText(r)}).catch(function(r){})}},{key:"objectsToData",value:function(){for(var t=this,a={},r=0,i=Object.keys(this.objects);r<i.length;r++){var l=i[r];a[l]={};for(var c=0,h=Object.keys(this.objects[l]);c<h.length;c++){var p=h[c],d=this.objects[l][p].toObject();a[l][d.id]=d}}if(this.data=a,this.setState({data:a[this.state.frame]}),this.state.selectedId.length===1){var m;this.state.selectedId[0]===-2?m=this.state.uiWindow:m=a[this.state.frame][this.state.selectedId[0]],this.setState({properties:R()({},m)},function(){var g;(g=t.propertiesRef.current)===null||g===void 0||g.reload()})}}},{key:"onObjectEvent",value:function(t,a){var r=this;function i(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,g={id:d.id,name:d.name,layer:d.layer,group:d.group,type:d.type,ratio:r.state.uiWindow.ratio,team:r.state.uiWindow.team},x=ea(g);r.objects[r.state.frame][d.id]=x,m&&x.fromObject(d),x.setRatio(r.state.uiWindow.ratio);for(var k=r.canvas.getObjects(),O=!0,F=0,y=Object.keys(k);F<y.length;F++){var $=y[F];if(k[$].id===x.id){O=!1;break}}r.canvas.add(x)}if(t==="add")typeof a.id=="number"&&a.id>=0&&!this.objects[this.state.frame][a.id]?i(a,!0):console.log("id exists",a.id,this.objects[this.state.frame][a.id]);else if(t==="_add")a.id=this.getNewDataId(),a.ratio=this.state.uiWindow.ratio,a.team=this.state.uiWindow.team,i(a,!1);else if(t==="update")this.objects[this.state.frame][a.id]&&this.objects[this.state.frame][a.id].fromObject(a);else if(t==="_update")a.id>=0&&this.objects[this.state.frame][a.id]?this.objects[this.state.frame][a.id].fromObject(a):i(a);else if(t==="remove"){var l=a.id;this.objects[this.state.frame][l]&&(this.select([]),this.canvas.remove(this.objects[this.state.frame][l]),this.canvas.renderAll(),delete this.objects[this.state.frame][l],this.objectsToData())}else if(t==="setAttr")this.objects[this.state.frame][a.id]&&this.objects[this.state.frame][a.id].set(a.payload);else if(t==="removeLayer")for(var c=0,h=Object.keys(this.objects[this.state.frame]);c<h.length;c++){var p=h[c];this.objects[this.state.frame][p].layer===a.layer&&this.onObjectEvent("remove",{id:p})}else t==="removeAll"&&this.reset(!0);this.objectsToData(),this.canvas.renderAll()}},{key:"setFrame",value:function(t){this.objects[t]||(this.objects[t]={});for(var a=0,r=Object.keys(this.objects[this.state.frame]);a<r.length;a++){var i=r[a];this.canvas.remove(this.objects[this.state.frame][i])}this.canvas.renderAll();var l=this;return new Promise(function(c,h){l.setState({frame:t},function(){for(var p=l.canvas.getObjects(),d=0,m=Object.keys(l.objects[l.state.frame]);d<m.length;d++){for(var g=m[d],x=!0,k=0,O=Object.keys(p);k<O.length;k++){var F=O[k];if(p[F].id===l.objects[l.state.frame][g].id){x=!1;break}}x&&l.canvas.add(l.objects[l.state.frame][g])}l.objectsToData(),l.select([]),l.canvas.renderAll(),c()})})}},{key:"onHistoryEvent",value:function(){var n=S()(b()().mark(function a(r){var i=this,l;return b()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(r!=="update"){h.next=5;break}return this.updateHistory(),h.abrupt("return");case 5:if(r!=="reset"){h.next=11;break}return l=this.his.reset({version:2,data:{default:{}},selected:"default"}),this.props.setCouldDo(l),h.abrupt("return");case 11:if(r!=="resetNow"){h.next=15;break}return l=this.his.reset({version:2,data:this.data,selected:this.state.frame}),this.props.setCouldDo(l),h.abrupt("return");case 15:return r==="previous"?l=this.his.previous():r==="next"&&(l=this.his.next()),this.props.setCouldDo(l),h.next=19,this.reset(!0);case 19:return h.next=21,ce(l.now,function(p,d){return i.onObjectEvent(p,d)},function(p){return i.onFrameEvent("change",p)},function(){return i.canvas.renderAll()}).then(function(){i.setRobotId()});case 21:this.cancelHistoryUpdate(),this.props.setCouldDo(l);case 23:case"end":return h.stop()}},a,this)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"onFrameEvent",value:function(){var n=S()(b()().mark(function a(r,i){var l,c,h,p,d,m;return b()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(r!=="add"){x.next=6;break}return this.objects[i]={},x.next=4,this.setFrame(i);case 4:x.next=40;break;case 6:if(r!=="remove"){x.next=19;break}if(Object.keys(this.objects).length!==1){x.next=10;break}return Z.error("Cannot remove last frame!"),x.abrupt("return");case 10:if(l=i,this.state.frame!==i){x.next=16;break}return i=Object.keys(this.objects)[0],i===l&&(i=Object.keys(this.objects)[1]),x.next=16,this.setFrame(i);case 16:delete this.objects[l],x.next=40;break;case 19:if(r!=="change"){x.next=24;break}return x.next=22,this.setFrame(i);case 22:x.next=40;break;case 24:if(r!=="copy"){x.next=34;break}return this.objects[i]={},c=this.objects[this.state.frame],x.next=29,this.setFrame(i);case 29:for(h=0,p=Object.keys(c);h<p.length;h++)d=p[h],this.onObjectEvent("_update",c[d].toObject());this.objectsToData(),this.canvas.renderAll(),x.next=40;break;case 34:if(r!=="rename"){x.next=40;break}return m=this.state.frame,x.next=38,this.onFrameEvent("copy",i);case 38:return x.next=40,this.onFrameEvent("remove",m);case 40:this.props.onFrameChange({frames:Object.keys(this.objects),selected:i}),this.objectsToData(),this.updateHistory();case 43:case"end":return x.stop()}},a,this)}));function t(a,r){return n.apply(this,arguments)}return t}()},{key:"render",value:function(){var t,a=this;return(t=this.canvas)===null||t===void 0||t.renderAll(),(0,u.jsx)("div",{style:{width:"100vw",height:"calc(100% - 20px)",padding:10},children:(0,u.jsxs)(W.eh,{autoSaveId:"container_h",className:"container",direction:"horizontal",children:[(0,u.jsx)(W.s_,{defaultSize:25,minSize:15,maxSize:45,order:1,children:(0,u.jsxs)(W.eh,{autoSaveId:"card_v",className:"full",direction:"vertical",children:[(0,u.jsx)(W.s_,{defaultSize:50,minSize:25,maxSize:75,children:(0,u.jsx)(Zt,{onSelect:function(i){return a.select(i)},onObjectEvent:function(i,l){return a.onObjectEvent(i,l)},onReset:function(){return a.reset()},data:this.state.data,editable:this.state.editable,selectedId:this.state.selectedId})}),(0,u.jsx)(W.OT,{className:"panel-resize-handle",style:{height:6}}),(0,u.jsx)(W.s_,{defaultSize:50,children:(0,u.jsx)(Ie.Z,{size:"small",title:"Properties",style:{height:"100%"},children:(0,u.jsxs)("div",{className:"card-body",children:[this.state.properties?(0,u.jsx)(At.vY,{dataSource:this.state.properties,columns:Jt(this.state.properties),ref:this.propertiesRef,editable:this.props.editable?{onSave:function(i,l){return a.onPropertiesChange(i,l)}}:null,column:1,style:{marginTop:4}},this.state.selectedId[0]):(0,u.jsx)(Ce.Z,{image:Ce.Z.PRESENTED_IMAGE_SIMPLE}),this.state.selectedId[0]===-2?(0,u.jsxs)(B.Z,{direction:"vertical",size:"middle",style:{display:"flex"},children:[(0,u.jsx)(z.ZP,{onClick:function(){return Re("image/*").then(function(i){a.setState({imageUploadShow:!1}),a.setBackground(Ht(i))}).catch(function(i){})},children:"Upload Background"}),(0,u.jsx)(z.ZP,{onClick:function(){return a.setBackground(v(25665))},children:"Reset Background"})]}):(0,u.jsx)("div",{})]})})})]})}),(0,u.jsx)(W.OT,{className:"panel-resize-handle",style:{width:6}}),(0,u.jsx)(W.s_,{defaultSize:75,order:2,onResize:function(i){return setTimeout(function(){return a.resetCanvasSize()},100)},children:(0,u.jsxs)("div",{className:"full",ref:this.canvasRef,children:[(0,u.jsx)("canvas",{className:"full",id:"ui"}),(0,u.jsx)("div",{id:"coordinateDisplay",style:{bottom:0,right:0,display:"none",padding:"1px 6px 1px 6px"}})]})})]})})}}]),s}(j.Component),la=sa,oa=v(13769),Be=v.n(oa),te=v(21797),ca=v(75081),We=v(85576),Ye=v(92462),He=v(553);function ua(){return he.apply(this,arguments)}function he(){return he=S()(b()().mark(function o(){var e,s,n,t,a,r,i,l,c,h,p,d,m;return b()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!V()){x.next=14;break}return x.next=3,(0,Ye.Py)();case 3:if(e=x.sent,!e.manifest){x.next=11;break}return s=e.manifest.version.slice(1).split(".").map(Number),n=localStorage.getItem("version_ignored"),n||(n="v1.1.4"),t=n.slice(1).split(".").map(Number),a=s[0]>t[0]||s[1]>t[1]||s[2]>t[2],x.abrupt("return",{shouldUpdate:a,manifest:e.manifest});case 11:return x.abrupt("return",e);case 14:return r=Date.now(),x.next=17,fetch("https://ui.bismarck.xyz/update.json?".concat(r));case 17:return i=x.sent,x.next=20,i.json();case 20:return l=x.sent,c=l.notes,h=l.version.slice(1).split(".").map(Number),p=localStorage.getItem("version_ignored"),p||(p="v1.1.4"),d=p.slice(1).split(".").map(Number),m=h[0]>d[0]||h[1]>d[1]||h[2]>d[2],x.abrupt("return",{shouldUpdate:m,manifest:{body:c,version:l.version}});case 28:case"end":return x.stop()}},o)})),he.apply(this,arguments)}function ha(){return de.apply(this,arguments)}function de(){return de=S()(b()().mark(function o(){return b()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!V()){s.next=6;break}return s.next=3,(0,Ye.F_)();case 3:return s.abrupt("return",s.sent);case 6:window.location.reload();case 7:case"end":return s.stop()}},o)})),de.apply(this,arguments)}var fe={checkUpdate:ua,installUpdate:ha,relaunch:He.R},Ge=v(21798),da=["node"],fa=fe.checkUpdate,va=fe.installUpdate,pa=fe.relaunch,xa=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{step:0,content:"",version:""}),n}return C()(s,[{key:"handleClose",value:function(){this.setState({step:0})}},{key:"handleOk",value:function(){var n=S()(b()().mark(function a(){return b()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,this.setState({step:2}),i.next=4,va();case 4:return i.next=6,pa();case 6:if(i.sent){i.next=8;break}this.setState({step:3});case 8:i.next=13;break;case 10:i.prev=10,i.t0=i.catch(0),this.setState({step:-1});case 13:case"end":return i.stop()}},a,this,[[0,10]])}));function t(){return n.apply(this,arguments)}return t}()},{key:"check",value:function(){var t=this,a=/(https:\/\/github\.com\/bismarckkk\/RM-UI-Designer\/pull\/)(\d+)/g,r=/(https:\/\/github\.com\/bismarckkk\/RM-UI-Designer\/compare\/)(v\d+\.\d+\.\d+\.\.\.v\d+\.\d+\.\d+)/g;S()(b()().mark(function i(){var l,c,h;return b()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,d.next=3,fa();case 3:l=d.sent,c=l.shouldUpdate,h=l.manifest,c&&t.setState({step:1,content:h.body.replace(a,function(m,g,x){return"[#".concat(x,"](").concat(g).concat(x,")")}).replace(r,function(m,g,x){return"[#".concat(x,"](").concat(g).concat(x,")")}),version:h.version}),d.next=12;break;case 9:d.prev=9,d.t0=d.catch(0),Z.warning("Failed to check update.");case 12:case"end":return d.stop()}},i,null,[[0,9]])}))()}},{key:"ignore",value:function(){localStorage.setItem("version_ignored",this.state.version),this.handleClose()}},{key:"componentDidMount",value:function(){this.check()}},{key:"render",value:function(){var t=(0,u.jsx)("div",{});return this.state.step===-1?t=(0,u.jsx)(te.ZP,{status:"error",title:"Update Failed"}):this.state.step===1?t=(0,u.jsx)(Ge.U,{components:{a:function(r){var i=r.node,l=Be()(r,da);return(0,u.jsx)("a",R()(R()({},l),{},{target:"_blank"}))}},children:this.state.content}):this.state.step===2?t=(0,u.jsx)("div",{style:{padding:40,textAlign:"center",color:"var(--ant-color-text)"},children:(0,u.jsxs)(B.Z,{direction:"vertical",children:[(0,u.jsx)(ca.Z,{size:"large"}),(0,u.jsx)("h3",{children:"Updating..."})]})}):this.state.step===3&&(t=(0,u.jsx)(te.ZP,{status:"success",title:"Update Success",subTitle:"Please restart the app to apply the update."})),(0,u.jsx)(We.Z,{title:"Auto Update",open:this.state.step,closable:this.state.step>1,maskClosable:this.state.step>1,footer:this.state.step>1?null:(0,u.jsxs)(B.Z,{children:[(0,u.jsx)(z.ZP,{onClick:this.ignore.bind(this),children:"Ignore"}),(0,u.jsx)(z.ZP,{onClick:this.handleClose.bind(this),children:"Cancel"}),(0,u.jsx)(z.ZP,{type:"primary",onClick:this.handleOk.bind(this),children:"Update"})]}),children:t})}}]),s}(j.Component),ma=xa,ga=v(40411),ya=v(73711),ba=v(27732),Ma=v(11713),ka=v(1210),wa=v(52745),ja=v(97937),$e=v(16165),Je=v(37476),za=v(5966),Sa=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{title:"",open:!1,frames:[]}),M()(w()(n),"promise",null),n}return C()(s,[{key:"open",value:function(t,a){var r=this;return new Promise(function(i,l){r.setState({title:t,open:!0,frames:a}),r.promise&&r.promise.reject(),r.promise={resolve:i,reject:l}})}},{key:"render",value:function(){var t=this;return(0,u.jsx)(Je.Y,{title:this.state.title,autoFocusFirstInput:!0,width:240,open:this.state.open,onOpenChange:function(r){t.promise&&!r&&t.state.open&&t.promise.reject(),t.setState({open:r})},onFinish:function(){var a=S()(b()().mark(function r(i){return b()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t.promise.resolve(i.frame),t.promise=null,c.abrupt("return",!0);case 3:case"end":return c.stop()}},r)}));return function(r){return a.apply(this,arguments)}}(),children:(0,u.jsx)(za.Z,{name:"frame",label:"New Frame Name",width:"sm",rules:[{required:!0,message:"Please input frame name!"},function(a){var r=a.getFieldValue,i=t;return{validator:function(c,h){{var p=!0,d=r("frame"),m=A()(i.state.frames),g;try{for(m.s();!(g=m.n()).done;){var x=g.value;if(x===d){p=!1;break}}}catch(k){m.e(k)}finally{m.f()}return p?Promise.resolve():Promise.reject(new Error("Cannot create same name frame!"))}}}}]})})}}]),s}(j.Component),Ia=Sa,Ca=v(40249),Aa=["node"],Ta=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{open:!1,content:null}),n}return C()(s,[{key:"show",value:function(){this.setState({open:!0})}},{key:"componentDidMount",value:function(){var t=this;fetch(v(99734)).then(function(a){return a.text()}).then(function(a){t.setState({content:a})})}},{key:"render",value:function(){var t=this;return(0,u.jsx)(We.Z,{title:"About",onOk:function(){return t.setState({open:!1})},onCancel:function(){return t.setState({open:!1})},footer:null,open:this.state.open,children:this.state.content?(0,u.jsx)(Ge.U,{components:{a:function(r){var i=r.node,l=Be()(r,Aa);return(0,u.jsx)("a",R()(R()({},l),{},{target:"_blank"}))}},children:this.state.content}):(0,u.jsx)(Ca.Z,{})})}}]),s}(j.Component),Da=Ta,Oa=Object.defineProperty,Qe=Object.getOwnPropertySymbols,Ea=Object.prototype.hasOwnProperty,Na=Object.prototype.propertyIsEnumerable,Ve=(o,e,s)=>e in o?Oa(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,Ra=(o,e)=>{for(var s in e||(e={}))Ea.call(e,s)&&Ve(o,s,e[s]);if(Qe)for(var s of Qe(e))Na.call(e,s)&&Ve(o,s,e[s]);return o};const La=o=>j.createElement("svg",Ra({className:"moon_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},o),j.createElement("path",{d:"M472 991.6c-157 0-304.4-77.2-394.3-206.6-6.9-9.9-7.6-22.9-1.8-33.6 5.8-10.7 17.1-17.8 29.2-16.7l7.7.4c2.4.2 4.8.3 7.2.3 229.4 0 416-186.6 416-416 0-85-25.7-167-74.3-236.9-6.9-9.9-7.6-22.9-1.8-33.6 5.8-10.7 17.2-17.6 29.2-16.7C748.7 41.6 952 252.1 952 511.6c0 264.7-215.3 480-480 480zM169.7 797.1c78.1 82.7 187.2 130.6 302.3 130.6 229.4 0 416-186.6 416-416 0-204-144.9-373-339.7-408.6 34 66.9 51.7 140.7 51.7 216.6 0 247.8-188.9 452.4-430.3 477.4z",fill:"#2c2c2c"}));var Zr="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTQ3MiA5OTEuNmMtMTU3IDAtMzA0LjQtNzcuMi0zOTQuMy0yMDYuNi02LjktOS45LTcuNi0yMi45LTEuOC0zMy42IDUuOC0xMC43IDE3LjEtMTcuOCAyOS4yLTE2LjdsNy43LjRjMi40LjIgNC44LjMgNy4yLjMgMjI5LjQgMCA0MTYtMTg2LjYgNDE2LTQxNiAwLTg1LTI1LjctMTY3LTc0LjMtMjM2LjktNi45LTkuOS03LjYtMjIuOS0xLjgtMzMuNiA1LjgtMTAuNyAxNy4yLTE3LjYgMjkuMi0xNi43Qzc0OC43IDQxLjYgOTUyIDI1Mi4xIDk1MiA1MTEuNmMwIDI2NC43LTIxNS4zIDQ4MC00ODAgNDgwek0xNjkuNyA3OTcuMWM3OC4xIDgyLjcgMTg3LjIgMTMwLjYgMzAyLjMgMTMwLjYgMjI5LjQgMCA0MTYtMTg2LjYgNDE2LTQxNiAwLTIwNC0xNDQuOS0zNzMtMzM5LjctNDA4LjYgMzQgNjYuOSA1MS43IDE0MC43IDUxLjcgMjE2LjYgMCAyNDcuOC0xODguOSA0NTIuNC00MzAuMyA0NzcuNHoiIGZpbGw9IiMyYzJjMmMiLz48L3N2Zz4=",Ua=Object.defineProperty,Ke=Object.getOwnPropertySymbols,Fa=Object.prototype.hasOwnProperty,Pa=Object.prototype.propertyIsEnumerable,Xe=(o,e,s)=>e in o?Ua(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s,Za=(o,e)=>{for(var s in e||(e={}))Fa.call(e,s)&&Xe(o,s,e[s]);if(Ke)for(var s of Ke(e))Pa.call(e,s)&&Xe(o,s,e[s]);return o};const Ba=o=>j.createElement("svg",Za({className:"sun_svg__icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:200,height:200},o),j.createElement("path",{d:"M522.88 874.667A21.333 21.333 0 0 1 544.213 896v85.333a21.333 21.333 0 0 1-21.333 21.334h-21.333a21.333 21.333 0 0 1-21.334-21.334V896a21.333 21.333 0 0 1 21.334-21.333h21.333zm268.416-107.52 60.352 60.352a21.333 21.333 0 0 1 0 30.165l-15.083 15.083a21.333 21.333 0 0 1-30.186 0l-60.331-60.352a21.333 21.333 0 0 1 0-30.166l15.083-15.082a21.333 21.333 0 0 1 30.165 0zm-527.957 0 15.082 15.082a21.333 21.333 0 0 1 0 30.166l-60.352 60.352a21.333 21.333 0 0 1-30.165 0l-15.083-15.083a21.333 21.333 0 0 1 0-30.165l60.331-60.352a21.333 21.333 0 0 1 30.187 0zM512 277.333c141.376 0 256 114.624 256 256s-114.624 256-256 256-256-114.624-256-256 114.624-256 256-256zm0 64a192 192 0 1 0 0 384 192 192 0 0 0 0-384zm448.213 160a21.333 21.333 0 0 1 21.334 21.334V544a21.333 21.333 0 0 1-21.334 21.333H874.88A21.333 21.333 0 0 1 853.547 544v-21.333a21.333 21.333 0 0 1 21.333-21.334h85.333zm-810.666 0a21.333 21.333 0 0 1 21.333 21.334V544a21.333 21.333 0 0 1-21.333 21.333H64.213A21.333 21.333 0 0 1 42.88 544v-21.333a21.333 21.333 0 0 1 21.333-21.334h85.334zm687.04-307.413 15.082 15.083a21.333 21.333 0 0 1 0 30.165l-60.352 60.352a21.333 21.333 0 0 1-30.165 0l-15.083-15.083a21.333 21.333 0 0 1 0-30.165L806.4 193.92a21.333 21.333 0 0 1 30.187 0zm-618.496 0 60.352 60.352a21.333 21.333 0 0 1 0 30.165L263.36 299.52a21.333 21.333 0 0 1-30.187 0l-60.352-60.373a21.333 21.333 0 0 1 0-30.166l15.083-15.082a21.333 21.333 0 0 1 30.165 0zM522.9 64a21.333 21.333 0 0 1 21.334 21.333v85.334A21.333 21.333 0 0 1 522.9 192h-21.333a21.333 21.333 0 0 1-21.333-21.333V85.333A21.333 21.333 0 0 1 501.568 64h21.333z",fill:"#ebebeb"}));var Br="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTUyMi44OCA4NzQuNjY3QTIxLjMzMyAyMS4zMzMgMCAwIDEgNTQ0LjIxMyA4OTZ2ODUuMzMzYTIxLjMzMyAyMS4zMzMgMCAwIDEtMjEuMzMzIDIxLjMzNGgtMjEuMzMzYTIxLjMzMyAyMS4zMzMgMCAwIDEtMjEuMzM0LTIxLjMzNFY4OTZhMjEuMzMzIDIxLjMzMyAwIDAgMSAyMS4zMzQtMjEuMzMzaDIxLjMzM3ptMjY4LjQxNi0xMDcuNTIgNjAuMzUyIDYwLjM1MmEyMS4zMzMgMjEuMzMzIDAgMCAxIDAgMzAuMTY1bC0xNS4wODMgMTUuMDgzYTIxLjMzMyAyMS4zMzMgMCAwIDEtMzAuMTg2IDBsLTYwLjMzMS02MC4zNTJhMjEuMzMzIDIxLjMzMyAwIDAgMSAwLTMwLjE2NmwxNS4wODMtMTUuMDgyYTIxLjMzMyAyMS4zMzMgMCAwIDEgMzAuMTY1IDB6bS01MjcuOTU3IDAgMTUuMDgyIDE1LjA4MmEyMS4zMzMgMjEuMzMzIDAgMCAxIDAgMzAuMTY2bC02MC4zNTIgNjAuMzUyYTIxLjMzMyAyMS4zMzMgMCAwIDEtMzAuMTY1IDBsLTE1LjA4My0xNS4wODNhMjEuMzMzIDIxLjMzMyAwIDAgMSAwLTMwLjE2NWw2MC4zMzEtNjAuMzUyYTIxLjMzMyAyMS4zMzMgMCAwIDEgMzAuMTg3IDB6TTUxMiAyNzcuMzMzYzE0MS4zNzYgMCAyNTYgMTE0LjYyNCAyNTYgMjU2cy0xMTQuNjI0IDI1Ni0yNTYgMjU2LTI1Ni0xMTQuNjI0LTI1Ni0yNTYgMTE0LjYyNC0yNTYgMjU2LTI1NnptMCA2NGExOTIgMTkyIDAgMSAwIDAgMzg0IDE5MiAxOTIgMCAwIDAgMC0zODR6bTQ0OC4yMTMgMTYwYTIxLjMzMyAyMS4zMzMgMCAwIDEgMjEuMzM0IDIxLjMzNFY1NDRhMjEuMzMzIDIxLjMzMyAwIDAgMS0yMS4zMzQgMjEuMzMzSDg3NC44OEEyMS4zMzMgMjEuMzMzIDAgMCAxIDg1My41NDcgNTQ0di0yMS4zMzNhMjEuMzMzIDIxLjMzMyAwIDAgMSAyMS4zMzMtMjEuMzM0aDg1LjMzM3ptLTgxMC42NjYgMGEyMS4zMzMgMjEuMzMzIDAgMCAxIDIxLjMzMyAyMS4zMzRWNTQ0YTIxLjMzMyAyMS4zMzMgMCAwIDEtMjEuMzMzIDIxLjMzM0g2NC4yMTNBMjEuMzMzIDIxLjMzMyAwIDAgMSA0Mi44OCA1NDR2LTIxLjMzM2EyMS4zMzMgMjEuMzMzIDAgMCAxIDIxLjMzMy0yMS4zMzRoODUuMzM0em02ODcuMDQtMzA3LjQxMyAxNS4wODIgMTUuMDgzYTIxLjMzMyAyMS4zMzMgMCAwIDEgMCAzMC4xNjVsLTYwLjM1MiA2MC4zNTJhMjEuMzMzIDIxLjMzMyAwIDAgMS0zMC4xNjUgMGwtMTUuMDgzLTE1LjA4M2EyMS4zMzMgMjEuMzMzIDAgMCAxIDAtMzAuMTY1TDgwNi40IDE5My45MmEyMS4zMzMgMjEuMzMzIDAgMCAxIDMwLjE4NyAwem0tNjE4LjQ5NiAwIDYwLjM1MiA2MC4zNTJhMjEuMzMzIDIxLjMzMyAwIDAgMSAwIDMwLjE2NUwyNjMuMzYgMjk5LjUyYTIxLjMzMyAyMS4zMzMgMCAwIDEtMzAuMTg3IDBsLTYwLjM1Mi02MC4zNzNhMjEuMzMzIDIxLjMzMyAwIDAgMSAwLTMwLjE2NmwxNS4wODMtMTUuMDgyYTIxLjMzMyAyMS4zMzMgMCAwIDEgMzAuMTY1IDB6TTUyMi45IDY0YTIxLjMzMyAyMS4zMzMgMCAwIDEgMjEuMzM0IDIxLjMzM3Y4NS4zMzRBMjEuMzMzIDIxLjMzMyAwIDAgMSA1MjIuOSAxOTJoLTIxLjMzM2EyMS4zMzMgMjEuMzMzIDAgMCAxLTIxLjMzMy0yMS4zMzNWODUuMzMzQTIxLjMzMyAyMS4zMzMgMCAwIDEgNTAxLjU2OCA2NGgyMS4zMzN6IiBmaWxsPSIjZWJlYmViIi8+PC9zdmc+",X=v(64317),Wa=[1152e3,1e6,921600,576e3,5e5,460800,230400,115200,74800,57600,38400,19200,9600,4800],Ya=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{open:!1,defaultOptions:{}}),M()(w()(n),"promise",null),n}return C()(s,[{key:"getOptions",value:function(t){var a=this;return new Promise(function(r,i){a.setState({open:!0,defaultOptions:t}),a.promise&&a.promise.reject(),a.promise={resolve:r,reject:i}})}},{key:"onFinish",value:function(){var n=S()(b()().mark(function a(r){return b()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.promise.resolve(r),this.promise=null,l.abrupt("return",!0);case 3:case"end":return l.stop()}},a,this)}));function t(a){return n.apply(this,arguments)}return t}()},{key:"render",value:function(){var t=this;return(0,u.jsxs)(Je.Y,{title:"Serial",width:400,open:this.state.open,onOpenChange:function(r){return t.setState({open:r})},onFinish:function(){var a=S()(b()().mark(function r(i){return b()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.onFinish(i);case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},r)}));return function(r){return a.apply(this,arguments)}}(),children:[(0,u.jsx)(X.Z,{name:"baudRate",label:"Baud Rate",width:"sm",initialValue:this.state.defaultOptions.baudRate,options:Wa.map(function(a){return{value:a,label:a.toString()}}),rules:[{required:!0}]}),(0,u.jsx)(X.Z,{name:"dataBits",label:"Data Bits",width:"sm",initialValue:this.state.defaultOptions.dataBits,options:[{value:8,label:"8"},{value:7,label:"7"}],rules:[{required:!0}]}),(0,u.jsx)(X.Z,{name:"stopBits",label:"Stop Bits",width:"sm",initialValue:this.state.defaultOptions.stopBits,options:[{value:1,label:"1"},{value:2,label:"2"}],rules:[{required:!0}]}),(0,u.jsx)(X.Z,{name:"parity",label:"Parity",width:"sm",initialValue:this.state.defaultOptions.parity,options:[{value:"none",label:"None"},{value:"even",label:"Even"},{value:"odd",label:"Odd"}],rules:[{required:!0}]}),(0,u.jsx)(X.Z,{name:"flowControl",label:"Flow Control",width:"sm",initialValue:this.state.defaultOptions.flowControl,options:[{value:"none",label:"None"},{value:"hardware",label:"Hardware"}],rules:[{required:!0}]})]})}}]),s}(j.Component),Ha=Ya,ae=v(2487),ve=v(85265),qe=v(28058),_e=v(18429),Ga=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{show:!1,errors:[]}),n}return C()(s,[{key:"onClose",value:function(){this.setState({show:!1})}},{key:"show",value:function(t){this.setState({show:!0,errors:t})}},{key:"render",value:function(){var t=this,a=this.state.errors.filter(function(l){return l.level==="warn"}),r=this.state.errors.filter(function(l){return l.level==="error"}),i=(0,u.jsx)(te.ZP,{status:"success",title:"0 error, 0 warning!",style:{marginTop:"50px"}});return r.length+a.length>0&&(i=(0,u.jsxs)("div",{style:{color:"var(--ant-color-text)",height:"100%"},children:[(0,u.jsxs)("p",{children:["Logged ",r.length," errors, ",a.length," warnings."]}),(0,u.jsx)("div",{style:{paddingBottom:10},className:"card-body",children:(0,u.jsx)(ae.Z,{bordered:!0,dataSource:this.state.errors,renderItem:function(c){return(0,u.jsx)(ae.Z.Item,{children:(0,u.jsxs)(B.Z,{size:"middle",children:[c.level==="warn"?(0,u.jsx)(qe.Z,{}):(0,u.jsx)(_e.Z,{}),"".concat(c.time.toLocaleTimeString(),": ").concat(c.message)]})})}})})]})),(0,u.jsx)(ve.Z,{title:"Serial Debug Log",placement:"right",onClose:function(){return t.onClose()},open:this.state.show,size:"large",getContainer:document.getElementById("content-in"),rootStyle:{inset:"25px 0 0 0"},children:(0,u.jsx)("div",{style:{width:"100%",height:"calc(100% - 25px)"},children:i})})}}]),s}(j.Component),$a=Ga,re=v(73344),Ja=function(o){E()(s,o);var e=N()(s);function s(){return I()(this,s),e.apply(this,arguments)}return C()(s,[{key:"render",value:function(){var t=this.props.errors.filter(function(i){return i.level==="warning"}),a=this.props.errors.filter(function(i){return i.level==="error"}),r=(0,u.jsx)(te.ZP,{status:"success",title:"Check Passed!",subTitle:"0 error, 0 warning!",style:{marginTop:"50px"}});return a.length+t.length>0&&(r=(0,u.jsxs)("div",{style:{color:"var(--ant-color-text)",height:"100%"},children:[(0,u.jsxs)("p",{children:["Found ",a.length," errors, ",t.length," warnings."]}),(0,u.jsx)("div",{style:{paddingBottom:10},className:"card-body",children:(0,u.jsx)(ae.Z,{bordered:!0,dataSource:this.props.errors,renderItem:function(l){return(0,u.jsx)(ae.Z.Item,{children:(0,u.jsxs)(B.Z,{size:"middle",children:[l.level==="warning"?(0,u.jsx)(qe.Z,{}):(0,u.jsx)(_e.Z,{}),l.info]})})}})})]})),(0,u.jsxs)("div",{style:{width:"100%",height:"calc(100% - 50px)"},children:[(0,u.jsx)("h3",{style:{color:"var(--ant-color-text)"},children:"Check Data"}),r]})}}]),s}(j.Component),Qa=Ja,Va=v(49107),Ka=v(42308),et=v(24389),Xa=v(51376),f=`
`,tt={UiArc:"arc",UiRound:"round",UiRect:"rect",UiLine:"line",UiEllipse:"ellipse",UiText:"string",UiInt:"number",UiFloat:"number"},at={UiLine:0,UiRect:1,UiRound:2,UiEllipse:3,UiArc:4,UiFloat:5,UiInt:6,UiText:7},rt={lineWidth:"width",layer:"layer",x:"start_x",y:"start_y",x2:"end_x",y2:"end_y",rx:"rx",ry:"ry",r:"r",startAngle:"start_angle",endAngle:"end_angle",number:"number",color:"color",fontSize:"font_size",strLength:"str_length"},it={main:0,yellow:1,green:2,orange:3,purple:4,pink:5,cyan:6,black:7,white:8};function qa(o,e,s){for(var n="",t=0;t<s;t++)n=n+`
#include "ui_`.concat(o,"_").concat(e,"_").concat(t,'.h"');for(var a=`
#define ui_init_`.concat(o,"_").concat(e,`() \\
`),r=`
#define ui_update_`.concat(o,"_").concat(e,`() \\
`),i=`
#define ui_remove_`.concat(o,"_").concat(e,`() \\
`),l=0;l<s;l++)a+="_ui_init_".concat(o,"_").concat(e,"_").concat(l,`(); \\
`),r+="_ui_update_".concat(o,"_").concat(e,"_").concat(l,`(); \\
`),i+="_ui_remove_".concat(o,"_").concat(e,"_").concat(l,`(); \\
`);return n+="".concat(f).concat(a.slice(0,-4)).concat(f).concat(r.slice(0,-4)).concat(f).concat(i.slice(0,-4),`
    `),"".concat(n,`
`)}function _a(o,e){var s="",n=A()(e),t;try{for(n.s();!(t=n.n()).done;){var a=t.value;s+=qa(o,a.group_name,a.splits.length)}}catch(r){n.e(r)}finally{n.f()}return s}function er(o){var e="//".concat(f,"// Created by RM UI Designer").concat(f,"//").concat(f).concat(f,"#ifndef UI_H").concat(f,"#define UI_H").concat(f,"#ifdef __cplusplus").concat(f,'extern "C" {').concat(f,"#endif").concat(f).concat(f,'#include "ui_interface.h"').concat(f),s=A()(o),n;try{for(s.s();!(n=s.n()).done;){var t=n.value;e+=_a(t.name,t.groups)}}catch(a){s.e(a)}finally{s.f()}return"".concat(e).concat(f).concat(f,"#ifdef __cplusplus").concat(f,"}").concat(f,"#endif").concat(f).concat(f,`#endif //UI_H
`)}function tr(o,e,s,n){var t="//".concat(f,"// Created by RM UI Designer").concat(f,"//").concat(f).concat(f,"#ifndef UI_").concat(o,"_").concat(e,"_").concat(s,"_H").concat(f,"#define UI_").concat(o,"_").concat(e,"_").concat(s,"_H").concat(f).concat(f,'#include "ui_interface.h"').concat(f).concat(f),a=A()(n),r;try{for(a.s();!(r=a.n()).done;){var i=r.value;t+="extern ui_interface_".concat(tt[i.type],"_t *ui_").concat(o,"_").concat(e,"_").concat(i.name,`;
`)}}catch(l){a.e(l)}finally{a.f()}return t+="".concat(f,"void _ui_init_").concat(o,"_").concat(e,"_").concat(s,"();").concat(f,"void _ui_update_").concat(o,"_").concat(e,"_").concat(s,"();").concat(f,"void _ui_remove_").concat(o,"_").concat(e,"_").concat(s,"();").concat(f).concat(f,"#endif //UI_").concat(o,"_").concat(e,"_").concat(s,"_H").concat(f),t}function ar(o,e,s){var n=R()({},s),t=at[n.type],a=n.name;n.type==="UiFloat"&&(n.number=Math.round(n.float*1e3),delete n.float),n.type==="UiRect"&&(n.x2=n.x+n.width,n.y2=n.y+n.height,delete n.width,delete n.height),(n.type==="UiFloat"||n.type==="UiNumber")&&(n.lineWidth=Math.round(n.fontSize/10)),n.color=it[n.color],delete n.type,delete n.id,delete n.name,delete n.group;var r="ui_".concat(o,"_").concat(e,"_").concat(a),i="    ".concat(r,"->figure_tpye = ").concat(t,`;
`);for(var l in n){var c=n[l];typeof c=="number"&&(c=Math.round(c)),i+="    ".concat(r,"->").concat(rt[l]," = ").concat(c,`;
`)}return"".concat(i,`
`)}function rr(o,e,s,n,t,a,r,i){for(var l="".concat(o,"_").concat(s,"_").concat(t),c="//".concat(f,"// Created by RM UI Designer").concat(f,"//").concat(f).concat(f,'#include "ui_').concat(l,'.h"').concat(f).concat(f,"#define FRAME_ID ").concat(e).concat(f,"#define GROUP_ID ").concat(n).concat(f,"#define START_ID ").concat(a).concat(f,"#define OBJ_NUM ").concat(r.length).concat(f,"#define FRAME_OBJ_NUM ").concat(i).concat(f).concat(f,"CAT(ui_, CAT(FRAME_OBJ_NUM, _frame_t)) ui_").concat(l,";").concat(f),h=0;h<r.length;h++){var p=tt[r[h].type],d=r[h].name;c+="ui_interface_".concat(p,"_t *ui_").concat(o,"_").concat(s,"_").concat(d," = ")+"(ui_interface_".concat(p,"_t *)&(ui_").concat(l,".data[").concat(h,`]);
`)}c+="".concat(f,"void _ui_init_").concat(l,"() {").concat(f,"    for (int i = 0; i < OBJ_NUM; i++) {").concat(f,"        ui_").concat(l,".data[i].figure_name[0] = FRAME_ID;").concat(f,"        ui_").concat(l,".data[i].figure_name[1] = GROUP_ID;").concat(f,"        ui_").concat(l,".data[i].figure_name[2] = i + START_ID;").concat(f,"        ui_").concat(l,".data[i].operate_tpyel = 1;").concat(f,"    }").concat(f,"    for (int i = OBJ_NUM; i < FRAME_OBJ_NUM; i++) {").concat(f,"        ui_").concat(l,".data[i].operate_tpyel = 0;").concat(f,"    }").concat(f).concat(f);var m=A()(r),g;try{for(m.s();!(g=m.n()).done;){var x=g.value;c+=ar(o,s,x)}}catch(k){m.e(k)}finally{m.f()}return c+="".concat(f,"    CAT(ui_proc_, CAT(FRAME_OBJ_NUM, _frame))(&ui_").concat(l,");").concat(f,"    SEND_MESSAGE((uint8_t *) &ui_").concat(l,", sizeof(ui_").concat(l,"));").concat(f,"}").concat(f).concat(f,"void _ui_update_").concat(l,"() {").concat(f,"    for (int i = 0; i < OBJ_NUM; i++) {").concat(f,"        ui_").concat(l,".data[i].operate_tpyel = 2;").concat(f,"    }").concat(f).concat(f,"    CAT(ui_proc_, CAT(FRAME_OBJ_NUM, _frame))(&ui_").concat(l,");").concat(f,"    SEND_MESSAGE((uint8_t *) &ui_").concat(l,", sizeof(ui_").concat(l,"));").concat(f,"}").concat(f).concat(f,"void _ui_remove_").concat(l,"() {").concat(f,"    for (int i = 0; i < OBJ_NUM; i++) {").concat(f,"        ui_").concat(l,".data[i].operate_tpyel = 3;").concat(f,"    }").concat(f).concat(f,"    CAT(ui_proc_, CAT(FRAME_OBJ_NUM, _frame))(&ui_").concat(l,");").concat(f,"    SEND_MESSAGE((uint8_t *) &ui_").concat(l,", sizeof(ui_").concat(l,"));").concat(f,"}").concat(f),c}function ir(o,e,s,n,t,a,r){var i="".concat(o,"_").concat(s,"_").concat(t),l=R()({},r[0]),c=l.name,h=l.text;l.color=it[l.color],l.strLength=h.length,l.lineWidth=Math.round(l.fontSize/10),delete l.text,delete l.type,delete l.id,delete l.name,delete l.group;var p="//".concat(f,"// Created by RM UI Designer").concat(f,"//").concat(f).concat(f,'#include "ui_').concat(i,'.h"').concat(f,'#include "string.h"').concat(f).concat(f,"#define FRAME_ID ").concat(e).concat(f,"#define GROUP_ID ").concat(n).concat(f,"#define START_ID ").concat(a).concat(f).concat(f,"ui_string_frame_t ui_").concat(i,";").concat(f).concat(f,"ui_interface_string_t* ui_").concat(o,"_").concat(s,"_").concat(c," = &ui_").concat(i,".option;").concat(f).concat(f,"void _ui_init_").concat(i,"() {").concat(f,"    ui_").concat(i,".option.figure_name[0] = FRAME_ID;").concat(f,"    ui_").concat(i,".option.figure_name[1] = GROUP_ID;").concat(f,"    ui_").concat(i,".option.figure_name[2] = START_ID;").concat(f,"    ui_").concat(i,".option.operate_tpyel = 1;").concat(f);p+="    ui_".concat(i,".option.figure_tpye = ").concat(at.UiText,`;
`);for(var d in l){var m=l[d];typeof m=="number"&&(m=Math.round(m)),p+="    ui_".concat(i,".option.").concat(rt[d]," = ").concat(m,`;
`)}return p+="    strcpy(ui_".concat(o,"_").concat(s,"_").concat(c,'->string, "').concat(h,'");').concat(f).concat(f,"    ui_proc_string_frame(&ui_").concat(i,");").concat(f,"    SEND_MESSAGE((uint8_t *) &ui_").concat(i,", sizeof(ui_").concat(i,"));").concat(f,"}").concat(f).concat(f,"void _ui_update_").concat(i,"() {").concat(f,"    ui_").concat(i,".option.operate_tpyel = 2;").concat(f).concat(f,"    ui_proc_string_frame(&ui_").concat(i,");").concat(f,"    SEND_MESSAGE((uint8_t *) &ui_").concat(i,", sizeof(ui_").concat(i,"));").concat(f,"}").concat(f).concat(f,"void _ui_remove_").concat(i,"() {").concat(f,"    ui_").concat(i,".option.operate_tpyel = 3;").concat(f).concat(f,"    ui_proc_string_frame(&ui_").concat(i,");").concat(f,"    SEND_MESSAGE((uint8_t *) &ui_").concat(i,", sizeof(ui_").concat(i,"));").concat(f,"}"),p}var nr=v(75112),sr=v(8938),lr=v(33562),pe=null,xe=null,me=null;function nt(){return ge.apply(this,arguments)}function ge(){return ge=S()(b()().mark(function o(){return b()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(pe!==null){s.next=6;break}return s.next=3,fetch(nr);case 3:return s.next=5,s.sent.text();case 5:pe=s.sent;case 6:if(xe!==null){s.next=12;break}return s.next=9,fetch(sr);case 9:return s.next=11,s.sent.text();case 11:xe=s.sent;case 12:if(me!==null){s.next=18;break}return s.next=15,fetch(lr);case 15:return s.next=17,s.sent.text();case 17:me=s.sent;case 18:return s.abrupt("return",{ui_interface:{h:pe,c:xe},ui_types:{h:me}});case 19:case"end":return s.stop()}},o)})),ge.apply(this,arguments)}function or(o){var e="";return o.h&&(e+=".h"),o.h&&o.c&&(e+=" and "),o.c&&(e+=".c"),e}function cr(){var o=document.querySelector(".rmui"),e=getComputedStyle(o),s=e.getPropertyValue("--ant-color-text-base");return s==="#fff"}var ur=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{preview:null,fileName:""}),M()(w()(n),"checked",[]),n}return C()(s,[{key:"review",value:function(t,a){this.setState({preview:this.props.code[t][a],fileName:"".concat(t,".").concat(a)})}},{key:"download",value:function(t,a){Oe(this.props.code[t][a],"".concat(t,".").concat(a)),console.log(this.props.code[t][a])}},{key:"downloadChecked",value:function(){var n=S()(b()().mark(function a(){var r,i,l,c,h;return b()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.checked.length!==0){d.next=3;break}return Z.error("Please select at least one file."),d.abrupt("return");case 3:return r={},d.t0=R(),d.t1=R()({},this.props.code),d.next=8,nt();case 8:d.t2=d.sent,i=(0,d.t0)(d.t1,d.t2),l=A()(this.checked);try{for(l.s();!(c=l.n()).done;)h=c.value,r[h]=i[h]}catch(m){l.e(m)}finally{l.f()}Ne(r).then(function(m){Ee(m,"codes.zip")});case 13:case"end":return d.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"render",value:function(){var t=this,a=[{file:"ui base .h and .c",key:"_base"}];for(var r in this.props.code)a.push({file:"".concat(r," ").concat(or(this.props.code[r])),key:r,h:this.props.code[r].h!==void 0,c:this.props.code[r].c!==void 0});return(0,u.jsxs)("div",{className:"full",style:{overflow:"hidden"},children:[(0,u.jsx)("h3",{style:{color:"var(--ant-color-text)",marginBottom:20},children:"Download Data"}),(0,u.jsx)("div",{style:{paddingBottom:36},className:"card-body",children:(0,u.jsx)(Va.Z,{columns:[{title:"File",dataIndex:"file",key:"file"},{title:"Preview",dataIndex:"key",key:"preview",render:function(l,c){return(0,u.jsxs)(B.Z,{children:[c.h&&(0,u.jsx)(z.ZP,{type:"link",onClick:function(){t.review(l,"h")},children:"Preview .h"}),c.c&&(0,u.jsx)(z.ZP,{type:"link",onClick:function(){t.review(l,"c")},children:"Preview .c"})]})}},{title:"Download",dataIndex:"key",key:"download",render:function(l,c){return l!=="_base"?(0,u.jsxs)(B.Z,{children:[c.h&&(0,u.jsx)(z.ZP,{type:"link",onClick:function(){t.download(l,"h")},children:"Download .h"}),c.c&&(0,u.jsx)(z.ZP,{type:"link",onClick:function(){t.download(l,"c")},children:"Download .c"})]}):(0,u.jsx)(z.ZP,{type:"link",onClick:S()(b()().mark(function h(){var p,d;return b()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,nt();case 2:return p=g.sent,g.next=5,Ne(p);case 5:d=g.sent,Ee(d,"ui_base.zip");case 7:case"end":return g.stop()}},h)})),children:"Download .zip"})}}],dataSource:a,rowSelection:{type:"checkbox",onChange:function(l){var c=K()(l);c.includes("_base")&&(c=c.filter(function(h){return h!=="_base"}),c.push("ui_types"),c.push("ui_interface")),t.checked=c},getCheckboxProps:function(l){return{name:l.key}}},pagination:!1})}),(0,u.jsx)(ve.Z,{onClose:function(){return t.setState({preview:null})},open:this.state.preview!==null,title:this.state.fileName,size:"large",getContainer:document.getElementById("content-in"),rootStyle:{inset:"25px 0 0 0"},children:(0,u.jsx)("div",{style:{height:"100%",overflow:"auto"},children:(0,u.jsx)(Ka.ZP,{value:this.state.preview||"",theme:cr()?et.ub:et.tR,extensions:[(0,Xa.N)()],onContextMenu:function(l){l.stopPropagation()}})})})]})}}]),s}(j.Component),hr=ur,dr=function(){function o(e,s,n,t,a,r,i){var l=this;if(I()(this,o),this.frame_name=e,this.frame_id=s,this.group_name=n,this.group_id=t,this.split_id=a,this.start_id=r,this.objs=i,i[0].type==="UiText")this.toSplitC=function(){return ir(l.frame_name,l.frame_id,l.group_name,l.group_id,l.split_id,l.start_id,l.objs)};else{var c=7;i.length===1?c=1:i.length<=2?c=2:i.length<=5&&(c=5),this.toSplitC=function(){return rr(l.frame_name,l.frame_id,l.group_name,l.group_id,l.split_id,l.start_id,l.objs,c)}}this.toSplitH=function(){return tr(l.frame_name,l.group_name,l.split_id,l.objs)}}return C()(o,[{key:"check",value:function(){return this.objs.length!==1&&this.objs.length!==2&&this.objs.length!==5&&this.objs.length!==7?[{level:"warning",info:'Length of Frame "'.concat(this.frame_name,'" Group "').concat(this.group_name,'" Split "').concat(this.split_id,'" is not 1 or 2 or 5 or 7.')}]:[]}}]),o}(),st=dr,fr=function(){function o(e,s,n,t,a){I()(this,o),this.frame_name=e,this.frame_id=s,this.group_name=n,this.group_id=t,this.splits=[],this.errors=[];var r=0,i=new Set,l=A()(a),c;try{for(l.s();!(c=l.n()).done;){var h=c.value;/^[a-zA-Z_]+\w+$/.test(h.name)||this.errors.push({level:"error",info:'Name of Frame "'.concat(this.frame_name,'" Group "').concat(this.group_name,'" Object "').concat(h.name,'" does not compliant.')}),i.has(h.name)?this.errors.push({level:"error",info:'Name of Frame "'.concat(this.frame_name,'" Group "').concat(this.group_name,'" Object "').concat(h.name,'" is duplicate.')}):i.add(h.name),h.type==="UiText"&&(this.splits.push(new st(this.frame_name,this.frame_id,this.group_name,this.group_id,this.splits.length,r,[h])),r+=1)}}catch(g){l.e(g)}finally{l.f()}for(var p=a.filter(function(g){return g.type!=="UiText"}),d=Math.ceil(p.length/7),m=0;m<d;m++)this.splits.push(new st(this.frame_name,this.frame_id,this.group_name,this.group_id,this.splits.length,r,p.slice(m*7,(m+1)*7))),r+=7}return C()(o,[{key:"check",value:function(){var s=this.errors,n=A()(this.splits),t;try{for(n.s();!(t=n.n()).done;){var a=t.value;s=s.concat(a.check())}}catch(r){n.e(r)}finally{n.f()}return s}}]),o}(),vr=fr,pr=function(){function o(e,s,n){I()(this,o),this.name=e,this.id=s,this.groups=[];var t={};for(var a in n){var r=n[a];r.group in t?t[r.group].push(r):t[r.group]=[r]}for(var i in t)this.groups.push(new vr(this.name,this.id,i,this.groups.length,t[i]))}return C()(o,[{key:"check",value:function(){var s=[],n=A()(this.groups),t;try{for(n.s();!(t=n.n()).done;){var a=t.value;s=s.concat(a.check())}}catch(r){n.e(r)}finally{n.f()}return s}}]),o}(),xr=pr,mr=function(){function o(e){I()(this,o),this.frames=[];for(var s in e)this.frames.push(new xr(s,this.frames.length,e[s]))}return C()(o,[{key:"toUiH",value:function(){return er(this.frames)}},{key:"check",value:function(){var s=[],n=A()(this.frames),t;try{for(n.s();!(t=n.n()).done;){var a=t.value;s=s.concat(a.check())}}catch(r){n.e(r)}finally{n.f()}return s}}]),o}(),gr=mr,yr=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{show:!1,step:"check"}),M()(w()(n),"downloadRef",(0,j.createRef)()),M()(w()(n),"data",{}),M()(w()(n),"errors",[]),n}return C()(s,[{key:"gen",value:function(t){this.helper=new gr(t),this.data=t,this.code={ui:{h:this.helper.toUiH()}};var a=A()(this.helper.frames),r;try{for(a.s();!(r=a.n()).done;){var i=r.value,l=A()(i.groups),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,p=A()(h.splits),d;try{for(p.s();!(d=p.n()).done;){var m=d.value;this.code["ui_".concat(i.name,"_").concat(h.group_name,"_").concat(m.split_id)]={c:m.toSplitC(),h:m.toSplitH()}}}catch(g){p.e(g)}finally{p.f()}}}catch(g){l.e(g)}finally{l.f()}}}catch(g){a.e(g)}finally{a.f()}this.errors=this.helper.check(),this.setState({show:!0,step:"check"})}},{key:"onClose",value:function(){this.setState({show:!1})}},{key:"render",value:function(){var t=this,a=(0,u.jsx)(z.ZP,{type:"primary",onClick:function(){return t.setState({step:"generate"})},disabled:this.errors.filter(function(i){return i.level==="error"}).length>0,children:"Generate"}),r=(0,u.jsx)(z.ZP,{type:"primary",onClick:function(){var l;return(l=t.downloadRef)===null||l===void 0||(l=l.current)===null||l===void 0?void 0:l.downloadChecked()},children:"Download"});return(0,u.jsx)("div",{children:(0,u.jsx)(ve.Z,{title:"C Code Generator",placement:"right",onClose:function(){return t.onClose()},open:this.state.show,size:"large",getContainer:document.getElementById("content-in"),rootStyle:{inset:"25px 0 0 0"},footer:(0,u.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"flex-end",padding:5},children:this.state.step==="check"?a:r}),children:this.state.step==="check"?(0,u.jsx)(Qa,{errors:this.errors}):(0,u.jsx)(hr,{code:this.code,ref:this.downloadRef})})})}}]),s}(j.Component),br=yr,Mr=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];function lt(o){for(var e=255,s=0,n,t=o.byteLength;t--;)n=e^o[s],e=Mr[n],s++;return e}var kr=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];function ot(o){for(var e=65535,s,n=0,t=o.byteLength;t--;)s=o[n],e=e>>8^kr[(e^s)&255],n++;return e}var wr=function(){function o(){I()(this,o),M()(this,"messages",[]),M()(this,"enabled",!1)}return C()(o,[{key:"warn",value:function(s){this.enabled&&(this.messages.push({level:"warn",message:s,time:new Date}),console.warn(s)),this.messages.length>100&&(this.messages=this.messages.slice(-100))}},{key:"error",value:function(s){this.enabled&&(this.messages.push({level:"error",message:s,time:new Date}),console.error(s)),this.messages.length>100&&(this.messages=this.messages.slice(-100))}},{key:"clear",value:function(){this.messages=[]}},{key:"get",value:function(){return this.messages}}]),o}(),jr=new wr,L=jr,zr=[8,21,36,81,111,51],Sr=function(){function o(){I()(this,o),M()(this,"buffer",void 0),this.buffer=new Uint8Array(0)}return C()(o,[{key:"transform",value:function(s,n){for(this.buffer=Uint8Array.from([].concat(K()(this.buffer),K()(s)));this.buffer.length>7;){if(this.buffer[0]!==165){this.buffer=this.buffer.subarray(1);continue}if(this.buffer.length<7)break;var t=this.buffer[1]|this.buffer[2]<<8,a=this.buffer[3],r=this.buffer[4],i=this.buffer[5]|this.buffer[6]<<8,l=this.buffer.subarray(0,4);if(lt(l)!==r){this.buffer=this.buffer.subarray(1),L.warn("crc8 error, calc: 0x".concat(lt(l).toString(16),", msg: 0x").concat(r.toString(16)));continue}if(i!==769){this.buffer=this.buffer.subarray(1),L.warn("cmd_id 0x".concat(i.toString(16)," not match"));continue}if(!zr.includes(t)){this.buffer=this.buffer.subarray(1),L.warn("length error, length: ".concat(t));continue}if(this.buffer.length<6+t+2)break;var c=this.buffer.subarray(7,7+t),h=this.buffer[7+t]|this.buffer[8+t]<<8;if(ot(this.buffer.subarray(0,7+t))!==h){this.buffer=this.buffer.subarray(1),L.error("crc16 error, calc: 0x".concat(ot(this.buffer.subarray(0,7+t)).toString(16),", msg: 0x").concat(h.toString(16)));continue}n.enqueue(c),this.buffer=this.buffer.subarray(7+t+2)}}}]),o}(),ye=Sr,q=["UiLine","UiRect","UiRound","UiEllipse","UiArc","UiFloat","UiNumber","UiText"],ct=["main","yellow","green","orange","purple","pink","cyan","black","white"],ut=["null","add","update","remove"],ht={257:1,258:2,259:5,260:7},Ir=["null","removeLayer","removeAll"];function be(o,e){return o[e]|o[e+1]<<8}function Me(o,e){return o[e]|o[e+1]<<8|o[e+2]<<16|o[e+3]<<24}function dt(o){var e=0,s="".concat(o[e++],"-").concat(o[e++]),n=o[e++],t=Me(o,e);e+=4;var a=t&7,r=t>>3&7,i=t>>6&15,l=t>>10&15,c=t>>14&511,h=t>>23&511,p=Me(o,e);e+=4;var d=p&1023,m=p>>10&2047,g=p>>21&2047,x=Me(o,e),k=x&1023,O=x>>10&2047,F=x>>21&2047;return{group:s,id:n,operate_tpyel:a,figure_tpye:r,layer:i,color:l,_a:c,_b:h,width:d,start_x:m,start_y:g,_c:k,_d:O,_e:F,number:x}}function Cr(o){var e=be(o,0),s=be(o,2),n=be(o,4),t=[];if(e===256)t.push({type:Ir[o[6]],obj:{layer:o[7]}});else if(e===272){var a=dt(o.subarray(6,21)),r=String.fromCharCode.apply(String,K()(o.subarray(21,21+a._b)));t.push({type:ut[a.operate_tpyel],obj:{layer:a.layer,group:a.group,type:q[a.figure_tpye],id:a.id,name:"".concat(q[a.figure_tpye],"_").concat(a.id),color:ct[a.color],lineWidth:a.width,x:a.start_x,y:a.start_y,fontSize:a._a,text:r}})}else if(e in ht)for(var i=ht[e],l=0;l<i;l++){var c=dt(o.subarray(6+l*15,6+(l+1)*15)),h={layer:c.layer,group:c.group,type:q[c.figure_tpye],id:c.id,name:"".concat(q[c.figure_tpye],"_").concat(c.id),color:ct[c.color],lineWidth:c.width,x:c.start_x,y:c.start_y};switch(q[c.figure_tpye].slice(2)){case"Line":h.x2=c._d,h.y2=c._e;break;case"Rect":h.width=c._d-c.start_x,h.height=c._e-c.start_y;break;case"Round":h.r=c._c;break;case"Ellipse":h.rx=c._d,h.ry=c._e;break;case"Arc":h.startAngle=c._a,h.endAngle=c._b,h.rx=c._d,h.ry=c._e;break;case"Float":h.fontSize=c._a,h.float=c.number/1e3;break;case"Number":h.fontSize=c._a,h.number=c.number;break}t.push({type:ut[c.operate_tpyel],obj:h})}else console.log("unknown sub_id",e);return{sender:s,receiver:n,events:t}}var Ar=function(){function o(e,s){I()(this,o),M()(this,"options",{baudRate:115200,dataBits:8,stopBits:1,flowControl:"none",parity:"none"}),this.onEvent=e,this.onError=s,this.reader=null,this.transformer=new TransformStream(new ye),this.self=1}return C()(o,[{key:"connect",value:function(){var e=S()(b()().mark(function n(){return b()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if("serial"in navigator){a.next=3;break}return Z.error("Web Serial API not supported."),a.abrupt("return");case 3:return a.next=5,navigator.serial.requestPort();case 5:return this.port=a.sent,a.next=8,this.port.open(this.options);case 8:this.readableStreamClosed=this.port.readable.pipeTo(this.transformer.writable),this.reader=this.transformer.readable.getReader(),L.enabled=!0,L.clear(),this.readLoop();case 13:case"end":return a.stop()}},n,this)}));function s(){return e.apply(this,arguments)}return s}()},{key:"stop",value:function(){var e=S()(b()().mark(function n(){var t,a,r;return b()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=new TextEncoderStream,a=t.writable.getWriter(),r=t.readable.pipeTo(this.port.writable),this.reader.cancel(),l.next=6,this.readableStreamClosed.catch(function(){});case 6:return a.close(),l.next=9,r;case 9:return l.next=11,this.port.close();case 11:this.reader=null,this.transformer=new TransformStream(new ye),this.self=1,L.enabled=!1;case 15:case"end":return l.stop()}},n,this)}));function s(){return e.apply(this,arguments)}return s}()},{key:"readLoop",value:function(){var e=S()(b()().mark(function n(){var t,a,r,i;return b()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:c.prev=0;case 1:return c.next=4,this.reader.read();case 4:if(t=c.sent,a=t.value,r=t.done,!r){c.next=10;break}return this.reader.releaseLock(),c.abrupt("break",20);case 10:if(i=Cr(a),i.sender===this.self){c.next=14;break}return L.error("Sender ".concat(i.sender," not match self ").concat(this.self)),c.abrupt("continue",1);case 14:if(i.receiver===this.self+256){c.next=17;break}return L.error("Receiver ".concat(i.receiver," not match self ").concat(this.self)),c.abrupt("continue",1);case 17:this===null||this===void 0||this.onEvent(i),c.next=1;break;case 20:c.next=37;break;case 22:return c.prev=22,c.t0=c.catch(0),c.prev=24,c.next=27,this.stop();case 27:c.next=31;break;case 29:c.prev=29,c.t1=c.catch(24);case 31:this.reader=null,this.transformer=new TransformStream(new ye),this.self=1,L.enabled=!1,L.clear(),this.onError(c.t0);case 37:case"end":return c.stop()}},n,this,[[0,22],[24,29]])}));function s(){return e.apply(this,arguments)}return s}()},{key:"getLog",value:function(){return L.get()}}]),o}(),Tr=Ar,Dr=[{key:"File-new",label:"New Project"},{key:"File-open",label:"Open .rmui"},{key:"File-save",label:"Save as .rmui"},{type:"divider"},{key:"File-generate",label:"Generate Code",icon:(0,u.jsx)(ya.Z,{})}],ke=[{key:"Edit-undo",label:"Undo"},{key:"Edit-redo",label:"Redo"},{key:"Edit-reset",label:"Reset History"}],we=[{key:"Simulate-start",label:"Start"},{key:"Simulate-stop",label:"Stop"},{key:"Simulate-settings",label:"Settings"},{key:"Simulate-log",label:"Debug Log"}],Or=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{fullscreen:!1,frames:["default"],selectedFrame:"default",darkMode:!1,couldUndo:!1,couldRedo:!1,serialStart:!1}),M()(w()(n),"formRef",(0,j.createRef)()),M()(w()(n),"aboutRef",(0,j.createRef)()),M()(w()(n),"generatorRef",(0,j.createRef)()),M()(w()(n),"logDrawerRef",(0,j.createRef)()),M()(w()(n),"serialModalRef",(0,j.createRef)()),M()(w()(n),"tauri",V()),M()(w()(n),"serial",new Tr(function(i){return n.onSerialEvent(i)},function(i){return n.onSerialError(i)})),n}return C()(s,[{key:"onSerialEvent",value:function(t){var a=A()(t.events),r;try{for(a.s();!(r=a.n()).done;){var i=r.value;this.props.onObjectEvent(i.type,i.obj)}}catch(l){a.e(l)}finally{a.f()}}},{key:"onSerialError",value:function(t){this.props.setEditable(!0),this.setState({serialStart:!1}),Z.error(t.text)}},{key:"componentDidMount",value:function(){var n=S()(b()().mark(function a(){var r;return b()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.tauri){l.next=5;break}return l.next=3,re.G.isMaximized();case 3:r=l.sent,this.setState({fullscreen:r});case 5:case"end":return l.stop()}},a,this)}));function t(){return n.apply(this,arguments)}return t}()},{key:"setCouldDo",value:function(t){console.log(t),this.setState({couldUndo:t.couldPrevious,couldRedo:t.couldNext})}},{key:"fullScreen",value:function(){if(this.tauri)re.G.maximize();else{var t=document.documentElement;t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}this.setState({fullscreen:!0})}},{key:"exitFullscreen",value:function(){this.tauri?re.G.unmaximize():document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.setState({fullscreen:!1})}},{key:"setFrames",value:function(t){this.setState({frames:t.frames,selectedFrame:t.selected})}},{key:"setRobotId",value:function(t){this.serial.self=t}},{key:"onMenuClick",value:function(){var n=S()(b()().mark(function a(r){var i,l,c,h,p,d,m,g,x,k,O;return b()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(i=r.keyPath[r.keyPath.length-1],i.slice(0,6)!=="Insert"){y.next=7;break}l=r.key.slice(7),c={id:-1,name:"New".concat(l),layer:0,group:"Ungroup",type:"Ui".concat(l)},this.props.onObjectEvent("_add",c),y.next=100;break;case 7:if(i!=="Edit-reset"){y.next=11;break}this.props.onHistoryEvent("resetNow"),y.next=100;break;case 11:if(i!=="Edit-undo"){y.next=15;break}this.props.onHistoryEvent("previous"),y.next=100;break;case 15:if(i!=="Edit-redo"){y.next=19;break}this.props.onHistoryEvent("next"),y.next=100;break;case 19:if(i!=="File-new"){y.next=24;break}this.props.reset(),this.props.onHistoryEvent("reset"),y.next=100;break;case 24:if(i!=="File-save"){y.next=28;break}this.props.save(),y.next=100;break;case 28:if(i!=="File-open"){y.next=32;break}this.props.upload(),y.next=100;break;case 32:if(i!=="File-generate"){y.next=36;break}(h=this.generatorRef.current)===null||h===void 0||h.gen(this.props.getData()),y.next=100;break;case 36:if(i!=="FrameOp-add"){y.next=43;break}return y.next=39,this.formRef.current.open("New Frame",this.state.frames);case 39:p=y.sent,this.props.setFrame("add",p),y.next=100;break;case 43:if(i!=="FrameOp-remove"){y.next=47;break}this.props.setFrame("remove",this.state.selectedFrame),y.next=100;break;case 47:if(i!=="FrameOp-copy"){y.next=54;break}return y.next=50,this.formRef.current.open("Copy Frame To",this.state.frames);case 50:d=y.sent,this.props.setFrame("copy",d),y.next=100;break;case 54:if(i!=="FrameOp-rename"){y.next=61;break}return y.next=57,this.formRef.current.open("Rename Frame To",this.state.frames);case 57:m=y.sent,this.props.setFrame("rename",m),y.next=100;break;case 61:if(i!=="FrameOp-change"){y.next=66;break}g=r.key.slice(7),this.props.setFrame("change",g),y.next=100;break;case 66:if(i!=="Simulate-start"){y.next=79;break}return y.prev=67,this.props.setEditable(!1),y.next=71,this.serial.connect();case 71:this.setState({serialStart:!0}),y.next=77;break;case 74:y.prev=74,y.t0=y.catch(67),Z.error(y.t0.text);case 77:y.next=100;break;case 79:if(i!=="Simulate-stop"){y.next=92;break}return y.prev=80,y.next=83,this.serial.stop();case 83:this.props.setEditable(!0),this.setState({serialStart:!1}),y.next=90;break;case 87:y.prev=87,y.t1=y.catch(80),Z.error(y.t1.text);case 90:y.next=100;break;case 92:if(i!=="Simulate-settings"){y.next=99;break}return y.next=95,(x=this.serialModalRef.current)===null||x===void 0?void 0:x.getOptions(this.serial.options);case 95:k=y.sent,k&&(this.serial.options=k),y.next=100;break;case 99:i==="Simulate-log"&&((O=this.logDrawerRef.current)===null||O===void 0||O.show(this.serial.getLog()));case 100:case"end":return y.stop()}},a,this,[[67,74],[80,87]])}));function t(a){return n.apply(this,arguments)}return t}()},{key:"getFramesMenu",value:function(){var t=[{key:"FrameOp-add",label:"New Frame"},{key:"FrameOp-copy",label:"Copy This Frame"},{key:"FrameOp-rename",label:"Rename This Frame"},{key:"FrameOp-remove",label:"Remove This Frame"},{key:"FrameOp-change",label:"Change to",selectable:"true",children:[]}],a=A()(this.state.frames),r;try{for(a.s();!(r=a.n()).done;){var i=r.value;t[4].children.push({key:"Frames-".concat(i),label:i})}}catch(l){a.e(l)}finally{a.f()}return t}},{key:"render",value:function(){var t=this,a=(0,u.jsx)(z.ZP,{type:"text",onClick:function(){return t.fullScreen()},size:"small",children:(0,u.jsx)(ba.Z,{style:{color:"var(--ant-color-text)"}})}),r=(0,u.jsx)(z.ZP,{type:"text",onClick:function(){return t.exitFullscreen()},size:"small",children:(0,u.jsx)(Ma.Z,{style:{color:"var(--ant-color-text)"}})}),i=(0,u.jsx)(z.ZP,{type:"text",onClick:function(){return t.props.setDarkMode(!0)},size:"small",children:(0,u.jsx)($e.Z,{component:La})}),l=(0,u.jsx)(z.ZP,{type:"text",onClick:function(){return t.props.setDarkMode(!1)},size:"small",children:(0,u.jsx)($e.Z,{component:Ba})});return ke[0].disabled=!this.state.couldUndo,ke[1].disabled=!this.state.couldRedo,we[0].disabled=this.state.serialStart,we[1].disabled=!this.state.serialStart,(0,u.jsxs)("div",{style:{width:"100%",height:32,marginTop:-5},className:"solid-color","data-tauri-drag-region":!0,children:[(0,u.jsxs)(Ae.Z,{style:{width:"100vw",display:"flex",paddingTop:-5},justify:"flex-start",align:"center","data-tauri-drag-region":!0,children:[(0,u.jsx)("div",{style:{fontFamily:"YouSheBiaoTiHei",fontSize:20,paddingLeft:6,paddingRight:6,paddingTop:3,display:"flex",color:"var(--ant-color-text)",cursor:"default"},"data-tauri-drag-region":!0,children:"RoboMaster UI Designer"}),(0,u.jsx)(H.Z,{menu:{items:Dr,onClick:function(h){return t.onMenuClick(h)}},children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:"File"})}),(0,u.jsx)(H.Z,{menu:{items:[].concat(ke),onClick:function(h){return t.onMenuClick(h)}},children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:"Edit"})}),(0,u.jsx)(H.Z,{menu:{items:ta(),onClick:function(h){return t.onMenuClick(h)}},children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:"Insert"})}),(0,u.jsx)(H.Z,{menu:{items:this.getFramesMenu(),onClick:function(h){return t.onMenuClick(h)},selectedKeys:["Frames-".concat(this.state.selectedFrame)]},children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:"Frames"})}),(0,u.jsx)(H.Z,{menu:{items:[].concat(we),onClick:function(h){return t.onMenuClick(h)}},children:(0,u.jsxs)(z.ZP,{type:"text",size:"small",children:["Simulate\xA0",(0,u.jsx)(ga.Z,{color:this.state.serialStart?"green":"red"})]})}),(0,u.jsx)(z.ZP,{type:"text",size:"small",onClick:function(){var h;(h=t.aboutRef.current)===null||h===void 0||h.show()},children:"About"}),(0,u.jsxs)("div",{style:{marginRight:5,justifyContent:"flex-end",marginLeft:"auto",marginTop:2},"data-tauri-drag-region":!0,children:[(0,u.jsxs)("div",{style:{display:"inline",marginRight:15,fontSize:10,cursor:"default",color:"var(--ant-color-text)"},"data-tauri-drag-region":!0,children:["Created by\xA0",(0,u.jsx)("a",{href:"https://github.com/bismarckkk",target:"_blank",children:(0,u.jsx)(z.ZP,{type:"link",style:{padding:0},size:"small","data-tauri-drag-region":!0,children:"Bismarckkk"})})]}),this.props.darkMode?l:i,(0,u.jsx)("a",{href:"https://github.com/bismarckkk/RM-UI-Designer",target:"_blank",children:(0,u.jsx)(z.ZP,{type:"text",size:"small",children:(0,u.jsx)(ka.Z,{style:{color:"var(--ant-color-text)"}})})}),(0,u.jsx)(z.ZP,{type:"text",size:"small",onClick:function(){return re.G.minimize()},style:{display:this.tauri?"inline":"none"},children:(0,u.jsx)(wa.Z,{style:{color:"var(--ant-color-text)"}})}),this.state.fullscreen?r:a,(0,u.jsx)(z.ZP,{type:"text",size:"small",onClick:function(){return(0,He.J)()},style:{display:this.tauri?"inline":"none"},children:(0,u.jsx)(ja.Z,{style:{color:"var(--ant-color-text)"}})})]})]}),(0,u.jsx)(Ia,{ref:this.formRef}),(0,u.jsx)(Da,{ref:this.aboutRef}),(0,u.jsx)(br,{ref:this.generatorRef}),(0,u.jsx)($a,{ref:this.logDrawerRef}),(0,u.jsx)(Ha,{ref:this.serialModalRef})]})}}]),s}(j.Component),Er=Or;function Nr(o){return Ct(),(0,u.jsx)("div",{})}var Rr=Nr,Lr=v(18253),Ur=ze.Z.darkAlgorithm,ft=ze.Z.compactAlgorithm,Fr=function(o){E()(s,o);var e=N()(s);function s(){var n;I()(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a)),M()(w()(n),"state",{simulate:!1,darkMode:n.isBrowserDarkMode()}),M()(w()(n),"modal",null),M()(w()(n),"renderRef",j.createRef()),M()(w()(n),"menuRef",j.createRef()),n}return C()(s,[{key:"isBrowserDarkMode",value:function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(t){return!1}}},{key:"componentDidMount",value:function(){var t=this,a=0;window.addEventListener("drop",function(l){return l.preventDefault()},!1),window.addEventListener("dragover",function(l){return l.preventDefault()},!1),window.addEventListener("contextmenu",function(l){l.target.tagName.toLowerCase()!=="input"&&l.preventDefault()},!1);function r(l){!t.modal&&l<880&&l!==a&&(a=l,t.modal=ie.warning({title:"Display Aera too Small",content:"Cannot show all contents on this window. Please resize this window or rotate your phone.",footer:null})),t.modal&&l>=880&&(t.modal.destroy(),t.modal=null)}setTimeout(function(){return r(window.innerWidth)},500),window.addEventListener("resize",function(){r(window.innerWidth)},!1);var i=window.matchMedia("(prefers-color-scheme: dark)");i.addEventListener("change",function(l){t.setState({darkMode:l.matches})})}},{key:"setDarkMode",value:function(t){this.setState({darkMode:t})}},{key:"render",value:function(){var t=this;return(0,u.jsx)(bt.ZP,{locale:Lr.Z,theme:{cssVar:{key:"rmui"},hashed:!1,algorithm:this.state.darkMode?[Ur,ft]:ft},children:(0,u.jsxs)(Se.Z,{children:[(0,u.jsx)("div",{className:"rmui",children:(0,u.jsxs)("div",{className:"container background-color",style:{height:"100vh",paddingBottom:12,overflow:"hidden"},children:[(0,u.jsx)(Er,{save:function(){return t.renderRef.current.save()},onObjectEvent:function(r,i){return t.renderRef.current.onObjectEvent(r,i)},onHistoryEvent:function(r){return t.renderRef.current.onHistoryEvent(r)},reset:function(){return t.renderRef.current.reset()},setFrame:function(r,i){return t.renderRef.current.onFrameEvent(r,i)},upload:function(r){return t.renderRef.current.upload(r)},getData:function(){return t.renderRef.current.getData()},setEditable:function(r){return t.renderRef.current.setEditable(r)},setDarkMode:function(r){return t.setDarkMode(r)},ref:this.menuRef,darkMode:this.state.darkMode}),(0,u.jsx)(Mt.Z,{content:["RM Ui Designer","v1.1.4"],zIndex:0,style:{height:"100%"},gap:[30,30],children:(0,u.jsx)("div",{id:"content-in",style:{width:"100vw",height:"100%",zIndex:2,position:"relative"},children:(0,u.jsx)(la,{style:{width:"100vw",height:"100%"},editable:!0,ref:this.renderRef,onFrameChange:function(r){var i;return(i=t.menuRef.current)===null||i===void 0?void 0:i.setFrames(r)},setCouldDo:function(r){var i;(i=t.menuRef.current)===null||i===void 0||i.setCouldDo(r)},setRobotId:function(r){var i;(i=t.menuRef.current)===null||i===void 0||i.setRobotId(r)}})})})]})}),(0,u.jsx)(Rr,{}),(0,u.jsx)(ma,{})]})})}}]),s}(j.Component),Pr=Fr},99734:function(P,Y,v){P.exports=v.p+"static/about.6af660a8.md"},8938:function(P,Y,v){P.exports=v.p+"static/ui_interface.33202de4.c"},75112:function(P,Y,v){P.exports=v.p+"static/ui_interface.6e21894b.h"},33562:function(P,Y,v){P.exports=v.p+"static/ui_types.acde8fff.h"},25665:function(P,Y,v){P.exports=v.p+"static/background.d741a18b.png"}}]);
